Content-type: text/html

<HTML><HEAD><TITLE>RPM</TITLE>
</HEAD><BODY>
<H1>RPM</H1>
Section: Red Hat Linux (8)<BR>Updated: 09 June 2002<BR>Index</A>

<H2>NAME</H2>

rpm - RPM 软件包管理器

<H2>SYNOPSIS</H2>


<H3>查询和校验软件包：</H3>

<P>

<P>
<P>
<B>rpm</B> {<B>-q|--query</B>} [<B>select-options</B>] [<B>query-options</B>]
<P>
<P>
<P>
<B>rpm</B> {<B>-V|--verify</B>} [<B>select-options</B>] [<B>verify-options</B>]
<P>
<P>
<P>
<B>rpm</B> <B>--import</B> <B></B><I>PUBKEY</I><B></B><I> ...</I>
<P>
<P>
<P>
<B>rpm</B> {<B>-K|--checksig</B>} [<B>--nosignature</B>] [<B>--nodigest</B>]
<BR>&nbsp;&nbsp;&nbsp;&nbsp;<B></B><I>PACKAGE_FILE</I><B></B><I>&nbsp;...</I>
<P>

<H3>安装，升级和卸载软件包：</H3>

<P>

<P>
<P>
<B>rpm</B> {<B>-i|--install</B>} [<B>install-options</B>] <B></B><I>PACKAGE_FILE</I><B></B><I> ...</I>
<P>
<P>
<P>
<B>rpm</B> {<B>-U|--upgrade</B>} [<B>install-options</B>] <B></B><I>PACKAGE_FILE</I><B></B><I> ...</I>
<P>
<P>
<P>
<B>rpm</B> {<B>-F|--freshen</B>} [<B>install-options</B>] <B></B><I>PACKAGE_FILE</I><B></B><I> ...</I>
<P>
<P>
<P>
<B>rpm</B> {<B>-e|--erase</B>} [<B>--allmatches</B>] [<B>--nodeps</B>] [<B>--noscripts</B>]
<BR>&nbsp;&nbsp;&nbsp;&nbsp;[<B>--notriggers</B>]&nbsp;[<B>--repackage</B>]&nbsp;[<B>--test</B>]&nbsp;<B></B><I>PACKAGE_NAME</I><B></B><I>&nbsp;...</I>
<P>

<H3>其他：</H3>

<P>

<P>
<P>
<B>rpm</B> {<B>--initdb|--rebuilddb</B>}
<P>
<P>
<P>
<B>rpm</B> {<B>--addsign|--resign</B>} <B></B><I>PACKAGE_FILE</I><B></B><I> ...</I>
<P>
<P>
<P>
<B>rpm</B> {<B>--querytags|--showrc</B>}
<P>
<P>
<P>
<B>rpm</B> {<B>--setperms|--setugids</B>} <B></B><I>PACKAGE_NAME</I><B></B><I> ...</I>
<P>

<H3>选择选项</H3>

<P>

<P>
<P>
<BR>&nbsp;[<B></B><I>PACKAGE_NAME</I><B></B>]&nbsp;[<B>-a,--all</B>]&nbsp;[<B>-f,--file&nbsp;</B><I>FILE</I><B></B>]
<BR>&nbsp;[<B>-g,--group&nbsp;</B><I>GROUP</I><B></B>]&nbsp;{<B>-p,--package&nbsp;</B><I>PACKAGE_FILE</I><B></B>]
<BR>&nbsp;[<B>--fileid&nbsp;</B><I>MD5</I><B></B>]&nbsp;[<B>--hdrid&nbsp;</B><I>SHA1</I><B></B>]&nbsp;[<B>--pkgid&nbsp;</B><I>MD5</I><B></B>]&nbsp;[<B>--tid&nbsp;</B><I>TID</I><B></B>]
<BR>&nbsp;[<B>--querybynumber&nbsp;</B><I>HDRNUM</I><B></B>]&nbsp;[<B>--triggeredby&nbsp;</B><I>PACKAGE_NAME</I><B></B>]
<BR>&nbsp;[<B>--whatprovides&nbsp;</B><I>CAPABILITY</I><B></B>]&nbsp;[<B>--whatrequires&nbsp;</B><I>CAPABILITY</I><B></B>]
<P>

<H3>查询选项</H3>

<P>

<P>
<P>
<BR>&nbsp;[<B>--changelog</B>]&nbsp;[<B>-c,--configfiles</B>]&nbsp;[<B>-d,--docfiles</B>]&nbsp;[<B>--dump</B>]
<BR>&nbsp;[<B>--filesbypkg</B>]&nbsp;[<B>-i,--info</B>]&nbsp;[<B>--last</B>]&nbsp;[<B>-l,--list</B>]
<BR>&nbsp;[<B>--provides</B>]&nbsp;[<B>--qf,--queryformat&nbsp;</B><I>QUERYFMT</I><B></B>]
<BR>&nbsp;[<B>-R,--requires</B>]&nbsp;[<B>--scripts</B>]&nbsp;[<B>-s,--state</B>]
<BR>&nbsp;[<B>--triggers,--triggerscripts</B>]
<P>

<H3>校验选项</H3>

<P>

<P>
<P>
<BR>&nbsp;[<B>--nodeps</B>]&nbsp;[<B>--nofiles</B>]&nbsp;[<B>--noscripts</B>]
<BR>&nbsp;[<B>--nodigest</B>]&nbsp;[<B>--nosignature</B>]
<BR>&nbsp;[<B>--nolinkto</B>]&nbsp;[<B>--nomd5</B>]&nbsp;[<B>--nosize</B>]&nbsp;[<B>--nouser</B>]
<BR>&nbsp;[<B>--nogroup</B>]&nbsp;[<B>--nomtime</B>]&nbsp;[<B>--nomode</B>]&nbsp;[<B>--nordev</B>]
<P>

<H3>安装选项</H3>

<P>

<P>
<P>
<BR>&nbsp;[<B>--aid</B>]&nbsp;[<B>--allfiles</B>]&nbsp;[<B>--badreloc</B>]&nbsp;[<B>--excludepath&nbsp;</B><I>OLDPATH</I><B></B>]
<BR>&nbsp;[<B>--excludedocs</B>]&nbsp;[<B>--force</B>]&nbsp;[<B>-h,--hash</B>]
<BR>&nbsp;[<B>--ignoresize</B>]&nbsp;[<B>--ignorearch</B>]&nbsp;[<B>--ignoreos</B>]
<BR>&nbsp;[<B>--includedocs</B>]&nbsp;[<B>--justdb</B>]&nbsp;[<B>--nodeps</B>]
<BR>&nbsp;[<B>--nodigest</B>]&nbsp;[<B>--nosignature</B>]&nbsp;[<B>--nosuggest</B>]
<BR>&nbsp;[<B>--noorder</B>]&nbsp;[<B>--noscripts</B>]&nbsp;[<B>--notriggers</B>]
<BR>&nbsp;[<B>--oldpackage</B>]&nbsp;[<B>--percent</B>]&nbsp;[<B>--prefix&nbsp;</B><I>NEWPATH</I><B></B>]
<BR>&nbsp;[<B>--relocate&nbsp;</B><I>OLDPATH</I><B>=</B><I>NEWPATH</I><B></B>]
<BR>&nbsp;[<B>--repackage</B>]&nbsp;[<B>--replacefiles</B>]&nbsp;[<B>--replacepkgs</B>]
<BR>&nbsp;[<B>--test</B>]
<P>

<H2>DESCRIPTION</H2>

<P>

<B>rpm</B> 是一个强大的 <B>软件包管理器</B>，可以用来构建，安装，查询，校验，升级和卸载单独的软件打包。一个 <B>打包</B> 包括文件的归档，以及用来安装和卸载归档文件的元信息。元信息包括辅助脚本，文件属性以及打包的描述性信息。<B>打包</B> 有两种，二进制打包，用来封装要安装的软件；源代码打包，包含源代码以及为生成二进制打包，必要的文件。
<P>

必须选择下列模式之一：
<B>Query 查询</B>,
<B>Verify 校验</B>,
<B>Signature Check 检查签名</B>,
<B>Install/Upgrade/Freshen 安装/升级/更新</B>,
<B>Uninstall 卸载</B>,
<B>Initialize Database 初始化数据库</B>,
<B>Rebuild Database 重构数据库</B>,
<B>Resign 重签名</B>,
<B>Add Signature 添加签名</B>,
<B>Set Owners/Groups 设置属主</B>,
<B>Show Querytags 显示查询标记</B>, 以及
<B>Show Configuration 显示配置</B>.

<H3>一般选项</H3>

<P>

这些选项可以用在所有不同的模式中。
<DL COMPACT>
<DT><B>-?, --help</B><DD>
输出更长的帮助信息。
<DT><B>--version</B><DD>
输出一行信息，包括使用的 <B>rpm</B> 的版本号。
<DT><B>--quiet</B><DD>
输出尽可能少的信息 - 通常只有错误会显示。
<DT><B>-v</B><DD>
输出冗余信息 - 通常，常规的进度信息将显示。
<DT><B>-vv</B><DD>
输出大量丑陋的调试信息。
<DT><B>--rcfile </B><I>FILELIST</I><B></B><DD>
<I>FILELIST</I> 中冒号分隔的每个文件名都被 <B>rpm</B> 按顺序读取，从中获得配置信息。只有列表的第一个文件必须存在，波浪线将被替换为 <B>$HOME</B>。默认的 <I>FILELIST</I> 是 <I>/usr/lib/rpm/rpmrc</I>:<I>/usr/lib/rpm/redhat/rpmrc</I>:<I>/etc/rpmrc</I>:<I>~/.rpmrc</I>
<DT><B>--pipe </B><I>CMD</I><B></B><DD>
将 <B>rpm</B> 的输出通过管道送到命令 <I>CMD</I>。
<DT><B>--dbpath </B><I>DIRECTORY</I><B></B><DD>
使用 <I>DIRECTORY</I> 中的数据库，而不是默认的路径 <I>/var/lib/rpm</I>
<DT><B>--root </B><I>DIRECTORY</I><B></B><DD>
以 <I>DIRECTORY</I> 作为根文件系统，进行所有操作。这意味着将使用 <I>DIRECTORY</I> 中的数据库来进行依赖性检测，任何小程序 (也就是安装中的 <B>%post</B> 和构建中的 <B>%prep</B>) 都将在一个 chroot</A>(2) 到 <I>DIRECTORY</I> 之后执行。
</DL>

<H3>安装和升级选项</H3>

<P>

安装命令的一般形式是
<P>

<P>
<B>rpm</B> {<B>-i|--install</B>} [<B>install-options</B>] <B></B><I>PACKAGE_FILE</I><B></B><I> ...</I>
<P>
<P>

这样安装了一个新软件包。
<P>

升级命令的一般形式是
<P>

<P>
<B>rpm</B> {<B>-U|--upgrade</B>} [<B>install-options</B>] <B></B><I>PACKAGE_FILE</I><B></B><I> ...</I>
<P>
<P>

这样安装或升级已安装的软件包到新版本。它与安装类似，只是所有其他版本的打包在新软件包安装后都将移除。
<P>

<P>
<B>rpm</B> {<B>-F|--freshen</B>} [<B>install-options</B>] <B></B><I>PACKAGE_FILE</I><B></B><I> ...</I>
<P>
<P>

仅当系统中存在更早的版本时，这样会升级软件包。<I>PACKAGE_FILE</I> 必须指定为
<B>ftp</B> 或
<B>http</B> URL，这样软件包可以在安装之前去下载。参见 <B>FTP/HTTP OPTIONS</B> 中有关 <B>rpm</B> 的内嵌 <B>ftp</B> 和 <B>http</B> 客户端支持。
<P>

<DL COMPACT>
<DT><B>--aid</B><DD>
需要时将建议的软件包加入事务集。
<DT><B>--allfiles</B><DD>
安装或升级软件包中所有 missingok 文件，哪怕它们已经存在。
<DT><B>--badreloc</B><DD>
与 <B>--relocate</B> 搭配使用，允许所有文件的重定位，而不仅仅是在二进制打包中，重定位提示包含的那些 <I>OLDPATH</I>。
<DT><B>--excludepath </B><I>OLDPATH</I><B></B><DD>
不安装名称以 <I>OLDPATH</I> 开始的文件。
<DT><B>--excludedocs</B><DD>
不安装任何标记为文档的文件 (包括手册页和 texinfo)。
<DT><B>--force</B><DD>
与使用
<B>--replacepkgs</B>,
<B>--replacefiles</B>, 以及
<B>--oldpackage</B> 相同。
<DT><B>-h, --hash</B><DD>
在打包被解压时，输出 50 个 hash 符号 (#)，用来与 <B>-v|--verbose</B> 配合，得到漂亮一点的输出。
<DT><B>--ignoresize</B><DD>
安装前不检测已挂载文件系统的空闲空间。
<DT><B>--ignorearch</B><DD>
允许安装或升级，即使二进制打包的体系结构与主机不匹配。
<DT><B>--ignoreos</B><DD>
允许安装或升级，即使二进制打包的操作系统与主机不匹配。
<DT><B>--includedocs</B><DD>
安装文档文件。这是默认的行为。
<DT><B>--justdb</B><DD>
只更新数据库，不更新文件系统。
<DT><B>--nodigest</B><DD>
读取时不校验打包或头部校验。
<DT><B>--nosignature</B><DD>
读取时不校验打包或头部签名。
<DT><B>--nodeps</B><DD>
在安装或升级前，不进行依赖性检测。
<DT><B>--nosuggest</B><DD>
不建议提供了所需依赖关系的软件包。
<DT><B>--noorder</B><DD>
不为安装重排序。通常软件包列表会被重排序，以满足依赖性关系。
<DT><B>--noscripts</B><DD>
<DT><B>--nopre</B><DD>
<DT><B>--nopost</B><DD>
<DT><B>--nopreun</B><DD>
<DT><B>--nopostun</B><DD>
不执行对应的小程序。<B>--noscripts</B> 选项与
<P>
<B>--nopre</B>
<B>--nopost</B>
<B>--nopreun</B>
<B>--nopostun</B>
<P>
等价，将
<B>%pre</B>,
<B>%post</B>,
<B>%preun</B>, 和
<B>%postun</B>
小程序全部关闭。
<DT><B>--notriggers</B><DD>
<DT><B>--notriggerin</B><DD>
<DT><B>--notriggerun</B><DD>
<DT><B>--notriggerpostun</B><DD>
不执行任何对应的触发小程序。<B>--notriggers</B> 选项与
<P>
<B>--notriggerin</B>
<B>--notriggerun</B>
<B>--notriggerpostun</B>
<P>
等价，将
<B>%triggerin</B>,
<B>%triggerun</B>, 和
<B>%triggerpostun</B>
小程序全部关闭。
<DT><B>--oldpackage</B><DD>
允许用旧软件包替换一个新软件包。
<DT><B>--percent</B><DD>
打印从软件包中解压文件的百分比。这是为了使 <B>rpm</B> 在其他工具中运行时简单一些。
<DT><B>--prefix </B><I>NEWPATH</I><B></B><DD>
对于可重定位的包，将以软件包重定位提示的安装前缀开始的所有文件路径转换为以 <I>NEWPATH</I> 开始。
<DT><B>--relocate </B><I>OLDPATH</I><B>=</B><I>NEWPATH</I><B></B><DD>
对于克重定位的二进制打包，将软件包重定位提示中，以 <I>OLDPATH</I> 开始的文件路径转换为以 <I>NEWPATH</I> 开始。这一选项可以使用多次，如果软件包中多个 <I>OLDPATH</I> 要重定位的话。
<DT><B>--repackage</B><DD>
在卸载前重新打包文件。过去安装的打包将根据宏 <B>%_repackage_name_fmt</B> 命名，将创建于宏 <B>%_repackage_dir</B> 指定的目录中 (默认值是 <I>/var/spool/repackage</I>)。
<DT><B>--replacefiles</B><DD>
安装软件包，即使他们替换了其他已安装的软件包的文件。
<DT><B>--replacepkgs</B><DD>
安装软件包，即使其中有些软件包已经被安装到了系统中。
<DT><B>--test</B><DD>
不安装软件包，仅仅检测并报告可能的冲突。
</DL>

<H3>卸载选项</H3>

<P>

卸载命令的一般形式是
<P>

<P>
<B>rpm</B> {<B>-e|--erase</B>} [<B>--allmatches</B>] [<B>--nodeps</B>] [<B>--noscripts</B>] [<B>--notriggers</B>] [<B>--repackage</B>] [<B>--test</B>] <B></B><I>PACKAGE_NAME</I><B></B><I> ...</I>
<P>
<P>

同时还可以用下列选项：
<DL COMPACT>
<DT><B>--allmatches</B><DD>
删除匹配 <I>PACKAGE_NAME</I> 的软件包的所有版本。通常情况下，如果 <I>PACKAGE_NAME</I> 匹配多个软件包将导致错误。
<DT><B>--nodeps</B><DD>
在卸载前不检测依赖关系。
<DT><B>--noscripts</B><DD>
<DT><B>--nopreun</B><DD>
<DT><B>--nopostun</B><DD>
不执行相应的小程序。<B>--noscripts</B> 选项在卸载过程中等价于
<P>
<B>--nopreun</B>
<B>--nopostun</B>
<P>
将
<B>%preun</B>, 和
<B>%postun</B>
小程序的执行关闭。
<DT><B>--notriggers</B><DD>
<DT><B>--notriggerun</B><DD>
<DT><B>--notriggerpostun</B><DD>
不执行相应的触发小程序。<B>--notriggers</B> 选项等价于
<P>
<B>--notriggerun</B>
<B>--notriggerpostun</B>
<P>
将
<B>%triggerun</B>, 和
<B>%triggerpostun</B>
小程序的执行关闭。
<DT><B>--repackage</B><DD>
卸载前重新打包文件。过去安装的软件包将根据宏 <B>%_repackage_name_fmt</B> 命名，存放到宏 <B>%_repackage_dir</B> 定义的目录中 (默认值是 <I>/var/spool/repackage</I>)。
<DT><B>--test</B><DD>
不真正卸载任何东西，仅仅尝试它们。与 <B>-vv</B> 选项联合使用，在调试时很有用。
</DL>

<H3>查询选项</H3>

<P>

查询命令的一般形式是
<P>

<P>
<B>rpm</B> {<B>-q|--query</B>} [<B>select-options</B>] [<B>query-options</B>]
<P>
<P>

可以指定输出时软件包信息的格式。为此，使用选项
<P>
<BR>&nbsp;<B>--qf|--queryformat</B>&nbsp;<B></B><I>QUERYFMT</I><B></B>
<P>
附带 <I>QUERYFMT</I> 格式化字符串。查询命令是标准的 <B>printf</A>(3)</B> 格式的修改版本。格式包括静态字符串 (可能包括标准的 C 转义字符，新行符，跳格以及其他特殊字符) 以及 <B>printf</A>(3)</B> 类型标记。由于 <B>rpm</B> 已知输出类型，因此应当忽略类型标记，使用头部字段名来代替，包含在 <B>{}</B> 中。字段名是大小写不敏感的，起始的 <B>RPMTAG_</B> 部分可以被忽略。
<P>

可选的输出格式是用 <B>:</B><I>typetag</I><B></B> 表示。当前，支持的类型有：
<DL COMPACT>
<DT><B>:armor</B><DD>
<P>
将公钥以 ASCII 包装。 
<DT><B>:base64</B><DD>
以 base64 编码二进制数据。
<DT><B>:date</B><DD>
使用 strftime</A>(3) &quot;%c&quot; 格式。
<DT><B>:day</B><DD>
使用 strftime</A>(3) &quot;%a %b %d %Y&quot; 格式。
<DT><B>:depflags</B><DD>
格式化依赖性标志。
<DT><B>:fflags</B><DD>
格式化文件标志。
<DT><B>:hex</B><DD>
以十六进制格式化。
<DT><B>:octal</B><DD>
以八进制格式化。
<DT><B>:perms</B><DD>
格式化文件权限。
<DT><B>:shescape</B><DD>
转义单引号，用于脚本。
<DT><B>:triggertype</B><DD>
显示触发的后缀。
</DL>
<P>

例如，要只输出所查询的软件包的名称，可以使用 <B>%{NAME}</B> 作为格式化字符串。要分两列输出软件包名称和发行版信息，可以用 <B>%-30{NAME}%{DISTRIBUTION}</B>。如果执行时使用 <B>--querytags</B> 参数，<B>rpm</B> 将输出它已知的所有标记列表。
<P>

查询的选项有两个子集：软件包选择和信息选择。

<H3>软件包选择选项：</H3>

<P>

<DL COMPACT>
<DT><B></B><I>PACKAGE_NAME</I><B></B><DD>
查询名称为 <I>PACKAGE_NAME</I> 的已安装软件包。
<DT><B>-a, --all</B><DD>
查询所有已安装软件包。
<DT><B>-f, --file </B><I>FILE</I><B></B><DD>
查询包含 <I>FILE</I> 的软件包。
<DT><B>--fileid </B><I>MD5</I><B></B><DD>
查询包含给定文件描述字的软件包，例如，文件内容的 <I>MD5</I> 校验和。
<DT><B>-g, --group </B><I>GROUP</I><B></B><DD>
查询属主为 <I>GROUP</I> 的软件包。
<DT><B>--hdrid </B><I>SHA1</I><B></B><DD>
查询包含给定头部描述字的软件包，例如，不可变头部区域的 <I>SHA1</I> 校验和。
<DT><B>-p, --package </B><I>PACKAGE_FILE</I><B></B><DD>
查询 (未安装的) 软件包 <I>PACKAGE_FILE</I>。这个文件可以指定为一个 <B>ftp</B> 或 <B>http</B> 样式的 URL，这时软件包头部将被下载并查询。参见 <B>FTP/HTTP OPTIONS</B> 中有关 <B>rpm</B> 的内部 <B>ftp</B> 和 <B>http</B> 客户端支持信息。参数 <I>PACKAGE_FILE</I> 如果不是一个二进制文件，将被解释为一个 ASCII 软件包说明。其中可以有以 '#' 开始的注释，其他的每行都可以包含以空格分隔的匹配表达式，如果是远程的地址，也包括 URL。这些将被扩展为路径，替换 manifest 参数的位置，作为 <I>PACKAGE_FILE</I> 参数的附加查询内容。
<DT><B>--pkgid </B><I>MD5</I><B></B><DD>
查询含有给定软件包描述字的软件包，例如，包的头部以及有效内容的 <I>MD5</I> 校验和。
<DT><B>--querybynumber </B><I>HDRNUM</I><B></B><DD>
直接查询第 <I>HDRNUM</I> 个数据库入口；这只在调试时有用。
<DT><B>--specfile </B><I>SPECFILE</I><B></B><DD>
解释并查询 <I>SPECFILE</I>，就好像它是一个软件包。尽管并非所有信息都可获得，但这种查询允许 rpm 从 spec 文件中抽取信息，而不必写一个解释器。
<DT><B>--tid </B><I>TID</I><B></B><DD>
查询包含给定 <I>TID</I> 事务描述字的软件包。当前使用 unix 时间戳作为事务描述字。任何在一次事务中安装或卸载的软件包拥有相同的描述字。
<DT><B>--triggeredby </B><I>PACKAGE_NAME</I><B></B><DD>
查询被软件包 <I>PACKAGE_NAME</I> 触发的软件包。
<DT><B>--whatprovides </B><I>CAPABILITY</I><B></B><DD>
查询提供了 <I>CAPABILITY</I> 能力的软件包。
<DT><B>--whatrequires </B><I>CAPABILITY</I><B></B><DD>
查询所有需要 <I>CAPABILITY</I> 才能运作的软件包。
</DL>

<H3>软件包查询选项：</H3>

<P>

<DL COMPACT>
<DT><B>--changelog</B><DD>
显示软件包的修改信息。
<DT><B>-c, --configfiles</B><DD>
只显示配置文件 (暗含了 <B>-l</B>).
<DT><B>-d, --docfiles</B><DD>
只显示文档文件 (暗含了 <B>-l</B>).
<DT><B>--dump</B><DD>
转储文件信息：
<P>
<DL COMPACT><DT><DD>
<P>
<PRE>
path size mtime md5sum mode owner group isconfig isdoc rdev symlink
        
</PRE>

</DL>

<P>
这个选项必须与至少下列之一联合使用
<B>-l</B>,
<B>-c</B>,
<B>-d</B>.
<DT><B>--filesbypkg</B><DD>
列出所选每个软件包中的文件。
<DT><B>-i, --info</B><DD>
显示软件包信息，包括名称，版本，描述。如果指定了 <B>--queryformat</B> 就使用它。
<DT><B>--last</B><DD>
列出软件包时，以安装时间排序，最新的在上面。
<DT><B>-l, --list</B><DD>
列出软件包中的文件。
<DT><B>--provides</B><DD>
列出软件包提供的特性。
<DT><B>-R, --requires</B><DD>
列出软件包依赖的其他软件包。
<DT><B>--scripts</B><DD>
列出软件包自定义的小程序，他们是安装和卸载等等过程的一部分。
<DT><B>-s, --state</B><DD>
显示软件包中文件的状态 <I>states</I> (暗含了 <B>-l</B>)。每个文件的状态是
<I>normal</I>,
<I>not installed</I>, 或
<I>replaced</I> 其中之一。
<DT><B>--triggers, --triggerscripts</B><DD>
显示软件包中包含的触发脚本，如果有的话。
</DL>

<H3>校验选项</H3>

<P>

校验命令的一般形式是
<P>

<P>
<B>rpm</B> {<B>-V|--verify</B>} [<B>select-options</B>] [<B>verify-options</B>]
<P>
<P>

校验软件包，是将已安装的文件的信息，与从软件包中获取的保存在 rpm 数据库中的有关文件的元数据进行比较。校验比较的内容有每个文件的大小，MD5 校验和，许可，类型，属主。任何不对的地方都回显示出来。如果软件包中文件未安装，例如在安装过程中使用 &quot;<B>--excludedocs</B>&quot; 选项跳过的文档，将被跳过。
<P>

软件包选择选项与软件包查询是相同的 (包括以说明文件作为参数)。其他独有的选项包括：
<DL COMPACT>
<DT><B>--nodeps</B><DD>
不校验软件包的依赖关系。
<DT><B>--nodigest</B><DD>
读取时不校验软件包或头部校验。
<DT><B>--nofiles</B><DD>
不校验文件的任何属性。
<DT><B>--noscripts</B><DD>
不执行 <B>%verifyscript</B> 小程序，如果有的话。
<DT><B>--nosignature</B><DD>
读取时不校验软件包或头部签名。
<DT><B>--nolinkto</B><DD>
<DT><B>--nomd5</B><DD>
<DT><B>--nosize</B><DD>
<DT><B>--nouser</B><DD>
<DT><B>--nogroup</B><DD>
<DT><B>--nomtime</B><DD>
<DT><B>--nomode</B><DD>
<DT><B>--nordev</B><DD>
不校验相应的文件属性。
</DL>
<P>

输出是 8 个字符的字符串，可能的属性标记为：
<P>
<PRE>
<B>c</B> <B>%config</B> 配置文件
<B>d</B> <B>%doc</B> 文档
<B>g</B> <B>%ghost</B> 占位文档 (就是说，文件内容不包含在软件包有效内容里面)
<B>l</B> <B>%license</B> 许可文件
<B>r</B> <B>%readme</B> 说明文件
</PRE>

<P>
从头部开始，接下来是文件名，每 8 个字符表示将文件属性与数据库中记录的值进行一次比较的结果。一个单独的
&quot;<B>.</B>&quot; (句点) 表示测试通过了，而一个单独的
&quot;<B>?</B>&quot; (问号) 表示测试可能无法进行 (例如，文件许可禁止了读权限)。最后，加重的字母表示相应的 <B>--verify</B> 测试失败了。
<P>
<PRE>
<B>S</B> file <B>S</B>ize 大小不一致
<B>M</B> <B>M</B>ode 模式不一致 (包括许可和文件类型)
<B>5</B> MD<B>5</B> sum 校验和不一致
<B>D</B> <B>D</B>evice 主从设备号不匹配
<B>L</B> read<B>L</B>ink</A>(2) 路径不匹配
<B>U</B> <B>U</B>ser 属主不一致
<B>G</B> <B>G</B>roup 组属主不一致
<B>T</B> m<B>T</B>ime 时间不一致
</PRE>

<P>

<H3>数字签名和校验</H3>

<P>

数字签名命令的一般形式是
<P>

<P>
<P>
<B>rpm</B> <B>--import</B> <B></B><I>PUBKEY</I><B></B><I> ...</I>
<P>
<P>
<B>rpm</B> {<B>--checksig</B>} [<B>--nosignature</B>] [<B>--nodigest</B>]
<BR>&nbsp;&nbsp;&nbsp;&nbsp;<B></B><I>PACKAGE_FILE</I><B></B><I>&nbsp;...</I>
<P>
<P>

选项 <B>--checksig</B> 用来检测 PACKAGE_FILE 中所有的签名和摘要，保证打包的完整性和来源。注意在读取打包时总会检测签名，而 <B>--checksig</B> 在校验与某个打包关联的所有签名和摘要时有用。
<P>

没有公钥就无法校验数字签名。可以用 <B>--import</B> 来向 <B>rpm</B> 数据库添加 ASCII 文本化的公钥。每个导入的公钥都有一个头部，钥匙环的管理与软件包管理完全类似。例如，要显示所有已导入的公钥，使用：
<P>

<B>rpm -qa gpg-pubkey*</B>
<P>

已导入的公钥的细节，可以查询并显示。下面是有关 Redhat GPG/DSA 公钥的信息：
<P>

<B>rpm -qi gpg-pubkey-db42a60e</B>
<P>

最后，已导入的公钥可以像软件包一样被删除。下面是如何卸载 Redhat GPG/DSA 公钥：
<P>

<B>rpm -e gpg-pubkey-db42a60e</B>

<H3>签署软件包</H3>

<P>

<P>
<B>rpm</B> <B>--addsign|--resign</B> <B></B><I>PACKAGE_FILE</I><B></B><I> ...</I>
<P>
<P>

选项 <B>--addsign</B> 与 <B>--resign</B> 都可以为每个软件包 <I>PACKAGE_FILE</I> 生成并插入新的签名，替换任何已有的签名。存在两个选项，是由于历史的原因，现在它们的行为没有区别。

<H3>使用 GPG 来签署软件包</H3>

<P>

为使用 GPG 来签署软件包，必须配置 <B>rpm</B> 运行 GPG，并且要能找到包含合适密钥的钥匙环。默认情况下，<B>rpm</B> 使用与 GPG 相同的约定来查找钥匙环，也就是 <B>$GNUPGHOME</B> 环境变量。如果你的钥匙环不在 GPG 要求的位置，就必须配置宏 <B>%_gpg_path</B> 为要使用的 GPG 钥匙环的位置。
<P>

为了与老版本的 GPG, PGP 和 rpm 兼容，只应配置 V3 OpenPGP 签名的打包。可以使用 DSA 或者 RSA 校验算法，但是推荐用 DSA。
<P>

如果想签署自己创建的打包，还需要创建自己的公钥和私钥对 (参见 GPG 手册)。还需要配置 <B>rpm</B> 宏：
<DL COMPACT>
<DT><B>%_signature</B><DD>
签名类型。当前只支持 gpg 和 pgp。
<DT><B>%_gpg_name</B><DD>
用来签署打包的密钥的所有者 &quot;用户&quot; 的名称
</DL>
<P>

例如，要使用 GPG 来签署打包，用户是
<I>&quot;John Doe &lt;jdoe@foo.com</A>&gt;&quot;</I>，
钥匙环位置在 <I>/etc/rpm/.gpg</I>，
使用可执行文件 <I>/usr/bin/gpg</I>，可以将这一段
<P>

<PRE>
%_signature gpg
%_gpg_path /etc/rpm/.gpg
%_gpg_name John Doe &lt;jdoe@foo.com</A>&gt;
%_gpgbin /usr/bin/gpg
</PRE>

<P>

包含在宏配置文件中。对于系统范围的设置，使用 <I>/etc/rpm/macros</I>，对于个人设置，使用 <I>~/.rpmmacros</I>。

<H3>重建数据库选项</H3>

<P>

重建数据库的命令的一般形式是
<P>

<P>
<B>rpm</B> {<B>--initdb|--rebuilddb</B>} [<B>-v</B>] [<B>--dbpath </B><I>DIRECTORY</I><B></B>] [<B>--root </B><I>DIRECTORY</I><B></B>]
<P>
<P>

使用 <B>--initdb</B> 来创建新的数据库，使用 <B>--rebuilddb</B> 来重建数据库索引，根据已安装的软件包头部。

<H3>显示配置</H3>

<P>

命令
<P>

<B>rpm</B> <B>--showrc</B>
<P>

将显示 <B>rpm</B> 使用的，在
<I>rpmrc</I> 和
<I>macros</I>
配置文件中定义的选项的值。

<H3>FTP/HTTP 选项</H3>

<P>

<B>rpm</B> 可以作为一个 FTP 和/或 HTTP 客户端，可以查询或安装互联网上的软件包包。要安装、升级和查询的软件包文件可以以
<B>ftp</B> 或
<B>http</B>
样式的 URL 指定：  
<P>

ftp://USER:PASSWORD@HOST:PORT/path/to/package.rpm</A>
<P>

如果忽略了 <B>:PASSWORD</B> 选项，将提示密码，每个用户名/主机组合提示一次。如果忽略了用户名和密码，将使用匿名 <B>ftp</B>。在所有情况下，都会使用被动 <B>ftp</B> (PSAV)。
<P>

<B>rpm</B> 允许在使用 <B>ftp</B> URL 时使用下面的选项：
<DL COMPACT>
<DT><B>--ftpproxy </B><I>HOST</I><B></B><DD>
使用主机 <I>HOST</I> 作为所有 <B>ftp</B> 传输的代理服务器，允许用户通过代理系统防火墙访问 <B>ftp</B>。这个选项也可以用宏 <B>%_ftpproxy</B> 指定。
<DT><B>--ftpport </B><I>PORT</I><B></B><DD>
连接到 <B>ftp</B> 代理服务器的 TCP <I>PORT</I> 端口，而不是默认的端口。这个选项也可以用宏 <B>%_ftpport</B> 指定。
</DL>
<P>

<B>rpm</B> 允许在使用 <B>http</B> URL 时使用下面的选项：
<DL COMPACT>
<DT><B>--httpproxy </B><I>HOST</I><B></B><DD>
使用主机 <I>HOST</I> 作为所有 <B>http</B> 传输的代理服务器，允许用户通过代理系统防火墙访问 <B>http</B>。这个选项也可以用宏 <B>%_httpproxy</B> 指定。
<DT><B>--httpport </B><I>PORT</I><B></B><DD>
连接到 <B>http</B> 代理服务器的 TCP <I>PORT</I> 端口，而不是默认的端口。这个选项也可以用宏 <B>%_httpport</B> 指定。
</DL>

<H2>LEGACY ISSUES</H2>


<H3>执行 rpmbuild</H3>

<P>

rpm 的构建模式，现在由
<I>/usr/bin/rpmbuild</I>
命令完成。尽管使用下面的 popt 别名提供的兼容性已经够用，但是不够完美；因此通过 popt 别名提供的构建兼容性将从 rpm 中移除。安装 <B>rpmbuild</B> 软件包，参见 <B>rpmbuild</A></B>(8) 中，有关过去记录在 <B>rpm</A></B>(8) 中的，<B>rpm</B> 构建模式的文档。
<P>

将下面的这些添加到 <I>/etc/popt</I> 中，如果想使用 <B>rpm</B> 命令行运行 <B>rpmbuild</B>的话：
<P>

<PRE>
rpm     exec --bp               rpmb -bp
rpm     exec --bc               rpmb -bc
rpm     exec --bi               rpmb -bi
rpm     exec --bl               rpmb -bl
rpm     exec --ba               rpmb -ba
rpm     exec --bb               rpmb -bb
rpm     exec --bs               rpmb -bs 
rpm     exec --tp               rpmb -tp 
rpm     exec --tc               rpmb -tc 
rpm     exec --ti               rpmb -ti 
rpm     exec --tl               rpmb -tl 
rpm     exec --ta               rpmb -ta
rpm     exec --tb               rpmb -tb
rpm     exec --ts               rpmb -ts 
rpm     exec --rebuild          rpmb --rebuild
rpm     exec --recompile        rpmb --recompile
rpm     exec --clean            rpmb --clean
rpm     exec --rmsource         rpmb --rmsource
rpm     exec --rmspec           rpmb --rmspec
rpm     exec --target           rpmb --target
rpm     exec --short-circuit    rpmb --short-circuit
</PRE>


<H2>FILES</H2>


<H3>rpmrc 配置文件</H3>

<P>

<PRE>
<I>/usr/lib/rpm/rpmrc</I>
<I>/usr/lib/rpm/redhat/rpmrc</I>
<I>/etc/rpmrc</I>
<I>~/.rpmrc</I>
</PRE>


<H3>Macro 宏定义文件</H3>

<P>

<PRE>
<I>/usr/lib/rpm/macros</I>
<I>/usr/lib/rpm/redhat/macros</I>
<I>/etc/rpm/macros</I>
<I>~/.rpmmacros</I>
</PRE>


<H3>Database 数据库</H3>

<P>

<PRE>
<I>/var/lib/rpm/Basenames</I>
<I>/var/lib/rpm/Conflictname</I>
<I>/var/lib/rpm/Dirnames</I>
<I>/var/lib/rpm/Filemd5s</I>
<I>/var/lib/rpm/Group</I>
<I>/var/lib/rpm/Installtid</I>
<I>/var/lib/rpm/Name</I>
<I>/var/lib/rpm/Packages</I>
<I>/var/lib/rpm/Providename</I>
<I>/var/lib/rpm/Provideversion</I>
<I>/var/lib/rpm/Pubkeys</I>
<I>/var/lib/rpm/Removed</I>
<I>/var/lib/rpm/Requirename</I>
<I>/var/lib/rpm/Requireversion</I>
<I>/var/lib/rpm/Sha1header</I>
<I>/var/lib/rpm/Sigmd5</I>
<I>/var/lib/rpm/Triggername</I>
</PRE>


<H3>Temporary 临时文件</H3>

<P>

<I>/var/tmp/rpm*</I>

<H2>SEE ALSO</H2>

<P>
<PRE>
<B>popt</A></B>(3),
<B>rpm2cpio</A></B>(8),
<B>rpmbuild</A></B>(8),
</PRE>

<P>
<B>http://www.rpm.org/</A> &lt;URL:http://www.rpm.org/</A>&gt;
</B>

<H2>AUTHORS</H2>

<P>
<PRE>
Marc Ewing &lt;marc@redhat.com</A>&gt;
Jeff Johnson &lt;jbj@redhat.com</A>&gt;
Erik Troan &lt;ewt@redhat.com</A>&gt;
</PRE>

<P>

<H2>TRANSBY</H2>

<I>LinuxForum.Net CMPP 中文手册页计划 [url=http://cmpp.linuxforum.net]</A></I>

* Tue May 3 2005 Yuan Yijun &lt;bbbush@163.com</A>&gt; rpm-4.4.1-3
- 初始版本, 来自于 rpm 的手册页集合
<P>

<H2>[中文版维护人]</H2>

Yuan Yijun &quot;bbbush@163.com</A>&quot;

<H2>[中文版最新更新]</H2>

Tue May 3 2005

<H2>《中国linux论坛man手册页翻译计划》</H2>

<B>http://cmpp.linuxforum.net</A></B>

<P>

<HR>
<H2>Index</H2>
<DL>
<DT>NAME</A><DD>
<DT>SYNOPSIS</A><DD>
<DL>
<DT>查询和校验软件包：</A><DD>
<DT>安装，升级和卸载软件包：</A><DD>
<DT>其他：</A><DD>
<DT>选择选项</A><DD>
<DT>查询选项</A><DD>
<DT>校验选项</A><DD>
<DT>安装选项</A><DD>
</DL>
<DT>DESCRIPTION</A><DD>
<DL>
<DT>一般选项</A><DD>
<DT>安装和升级选项</A><DD>
<DT>卸载选项</A><DD>
<DT>查询选项</A><DD>
<DT>软件包选择选项：</A><DD>
<DT>软件包查询选项：</A><DD>
<DT>校验选项</A><DD>
<DT>数字签名和校验</A><DD>
<DT>签署软件包</A><DD>
<DT>使用 GPG 来签署软件包</A><DD>
<DT>重建数据库选项</A><DD>
<DT>显示配置</A><DD>
<DT>FTP/HTTP 选项</A><DD>
</DL>
<DT>LEGACY ISSUES</A><DD>
<DL>
<DT>执行 rpmbuild</A><DD>
</DL>
<DT>FILES</A><DD>
<DL>
<DT>rpmrc 配置文件</A><DD>
<DT>Macro 宏定义文件</A><DD>
<DT>Database 数据库</A><DD>
<DT>Temporary 临时文件</A><DD>
</DL>
<DT>SEE ALSO</A><DD>
<DT>AUTHORS</A><DD>
<DT>TRANSBY</A><DD>
<DT>[中文版维护人]</A><DD>
<DT>[中文版最新更新]</A><DD>
<DT>《中国linux论坛man手册页翻译计划》</A><DD>
</DL>
<HR>
This document was created by
man2html</A>,
using the manual pages.<BR>
Time: 07:53:07 GMT, May 08, 2005
</BODY>
</HTML>
