<HTML>
<HEAD>
<META http-equiv="content-type" content="text/html; charset=gb2312">
<META name="man2html Chinese version">
<TITLE>LISTEN</TITLE>
</HEAD>
<BODY>
<H1>LISTEN</H1>
Section: Linux Programmer's Manual (2)<BR>Updated: 23 July 1993<BR>Index</A>

<H2>NAME 名称</H2>

listen - listen for connections on a socket 在一个套接字上倾听连接

<H2>SYNOPSIS 概述</H2>

<B>#include &lt;sys/socket.h</A>&gt;</B>

<P>
<B>int listen(int </B><I>s</I><B>, int </B><I>backlog</I><B>);</B>


<H2>DESCRIPTION 描述</H2>

在接收连接之前,首先要使用
<B>socket</A></B>(2)

创建一个套接字,然后调用
<B>listen</B>

使其能够自动接收到来的连接并且为连接队列指定一个长度限制.
之后就可以使用
<B>accept</A></B>(2)

接收连接.
<B>listen</B>

调用仅适用于
<B>SOCK_STREAM</B>

或者
<B>SOCK_SEQPACKET</B>

类型的套接字.
<P>

参数
<I>backlog</I>

指定未完成连接队列的最大长度.如果一个连接请求到达时未完成连接
队列已满,那么客户端将接收到错误
<B>ECONNREFUSED.</B>

或者,如果下层协议支持重发,那么这个连接请求将被忽略,这样客户端
在重试的时候就有成功的机会.

<H2>NOTES 注意</H2>

在TCP套接字中
<I>backlog </I>

的含义在Linux 2.2中已经改变.
它指定了已经完成连接正等待应用程序接收的套接字队列的长度,而不是
未完成连接的数目.未完成连接套接字队列的最大长度可以使用
<B>tcp_max_syn_backlog</B>

sysctl设置
当打开syncookies时不存在逻辑上的最大长度,此设置将被忽略.参见
<B>tcp</A></B>(7)

以获取更多信息.
<P>

<H2>RETURN VALUE 返回值</H2>

函数执行成功时返回0.错误时返回-1,并置相应错误代码.
<I>errno</I>


<H2>ERRORS 错误</H2>

<DL COMPACT>
<DT><B>EBADF</B>

<DD>
参数
<I>s</I>

不是合法的描述符.
<DT><B>ENOTSOCK</B>

<DD>
参数
<I>s</I>

不是一个套接字.
<DT><B>EOPNOTSUPP</B>

<DD>
套接字类型不支持
<B>listen </B>

操作.
</DL>

<H2>CONFORMING TO 兼容于</H2>

Single Unix, 4.4BSD, POSIX 1003.1g.
<B>listen</B>

函数调用最初出现于4.2BSD. 

<H2>BUGS 勘误</H2>

如果套接字类型是 
<B>AF_INET</B>,

并且参数
<I>backlog</I>

大于常量 
<B>SOMAXCONN </B>

(Linux 2.0&amp;2.2中是128),它将被自动截断为
<B>SOMAXCONN</B>

的值. 
有的BSD系统(以及一些BSD扩展)将backlog值限制为5.

<H2>SEE ALSO 参见</H2>

<B>accept</A></B>(2),

<B>connect</A></B>(2),

<B>socket</A></B>(2)

<P>

<H2>[中文版维护人]</H2>

<B>byeyear &lt;love_my_love@263.net</A> &gt;</B>


<H2>[中文版最新更新]</H2>

<B>2002.01.27</B>


<H2>《中国linux论坛man手册页翻译计划》:</H2>

<B>http://cmpp.linuxforum.net</A></B>

<P>

<HR>
<H2>Index</H2>
<DL>
<DT>NAME 名称</A><DD>
<DT>SYNOPSIS 概述</A><DD>
<DT>DESCRIPTION 描述</A><DD>
<DT>NOTES 注意</A><DD>
<DT>RETURN VALUE 返回值</A><DD>
<DT>ERRORS 错误</A><DD>
<DT>CONFORMING TO 兼容于</A><DD>
<DT>BUGS 勘误</A><DD>
<DT>SEE ALSO 参见</A><DD>
<DT>[中文版维护人]</A><DD>
<DT>[中文版最新更新]</A><DD>
<DT>《中国linux论坛man手册页翻译计划》:</A><DD>
</DL>
<HR>
This document was created by
man2html</A>,
using the manual pages.<BR>
Time:  GMT, January 14, 2004
</BODY>
</HTML>
