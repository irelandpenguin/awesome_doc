<HEAD><TITLE>鸟哥的 Linux 私房菜 -- 利用网络升级系统</TITLE>
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<META content=VBird name=Author>
<META content="Mozilla/4.5 [zh-TW] (WinNT; I) [Netscape]" name=GENERATOR>
<META content="up2date 的]浴⑹褂梅椒ǎ以及 RPM 的方法！" name=Description><!-- saved from url=(0022)http://internet.e-mail -->
<STYLE>
   <!--
   body{background-image=url("58_files/VBirdLinux[1].jpg");background-ATTACHMENT=FIXED}
   -->
</STYLE>
</head>
<BODY style="CURSOR: auto" background="58_files/VBirdLinux[10].jpg" nosave="">
<CENTER>
<CENTER><B><FONT color=#3333ff size=+2><FONT face=SimSun>鸟哥的</FONT><FONT face="Times New Roman,Times"> Linux </FONT><FONT face=SimSun>与</FONT><FONT face="Times New Roman,Times"> ADSL </FONT><FONT face=SimSun>私房菜</FONT></FONT></B> <BR><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 nosave=""></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 nosave=""></A> <BR>
<HR width="100%">
</CENTER><FONT color=#3333ff size=+2><A href="http://linux.vbird.org/linux_server/0220upgrade.php" target=_self><FONT face="Times New Roman,Times">Linux </FONT><FONT face=SimSun>网络套件升级</FONT></A></FONT></CENTER>
<DIV align=right><FONT face=SimSun color=#3333ff size=-1>最近更新日期：2003/08/22</FONT></DIV><FONT face=SimSun color=#3333ff size=-2>　</FONT> 
<TABLE cols=1 width="100%" bgColor=#ffcccc border=1>
<TBODY>
<TR>
<TD><FONT color=#000099 size=-1>在现在的 Internet 上面，Cracker 实在是太多了！这些 Cracker 利用已知道的 Linux 上面的套件漏洞，来进行侦测、入侵您的主机，因此，除了未来架设防火墙之外，<B>最重要的 Linux 日常管理工作，莫过于套件的升级了</B>！不过，经由每日观察网络安全通报所告知的套件漏洞，以及等待各大 distribution 针对这些漏洞来提供 RPM 档案，以使 Client 来升级的过程中，实在是有点缓慢啊！因此，目前就有很多在线直接更新的机制出现了！有了这些在线直接更新 RPM 的手段与方法，我们系统管理员在管理主机系统上面，可就轻松的多！赶紧来看看吧！</FONT></TD></TR></TBODY></TABLE><FONT color=#000099 size=-2>　</FONT> <BR><FONT color=#000099><FONT size=+1><A href="#why_upgrad">为何我的 Linux 要升级</A></FONT>：</FONT> <BR><FONT color=#000099><FONT size=+1><A href="#up2date">以 up2date 进行 Linux 网络套件升级</A></FONT>：</FONT> <BR><FONT color=#000099><FONT size=+1>　　</FONT><A href="#up2date_install">安装</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　</FONT><A href="#up2date_register">注册</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　</FONT><A href="#up2date_used">使用</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　</FONT><A href="#up2date_final">结语</A></FONT> <BR><FONT color=#000099 size=+1><A href="#mandrake">Mandrake 的 urpmi 升级</A>；</FONT> <BR><FONT color=#000099>　　：<A href="#mandrake_package">urpmi 的套件结构</A></FONT> <BR><FONT color=#000099>　　：<A href="#mandrake_media">选择 RPM 档案的媒体</A>： <A href="#urpmi.addmedia">urpmi.addmedia</A>, <A href="#urpmi.removemedia">urpmi.removemedia</A></FONT> <BR><FONT color=#000099>　　：<A href="#mandrake_updatego">进行升级</A>： <A href="#urpmi.update">urpmi.update</A>, <A href="#urpmi">urpmi</A></FONT> <BR><FONT color=#000099>　　：<A href="#mandrake_every_date">每日自动升级</A></FONT> <BR><FONT color=#000099 size=+1><A href="#apt_client">APT 的使用</A></FONT> <BR><FONT color=#000099 size=+1><A href="#vbird_zzgetrpmfile">VBird 的自动更新程序</A></FONT> <BR><FONT color=#000099 size=+1><A href="#important">重点回顾</A></FONT> <BR><FONT color=#000099 size=+1><A href="#reference">参考资源</A></FONT> <BR><FONT color=#000099 size=+1><A href="#FAQ">课后练习</A></FONT> <BR>
<HR width="100%">
<A name=why_upgrad></A><FONT color=#000099 size=+1>为何我的 Linux 要升级？</FONT> 
<UL>网络上面常常听到：『<FONT color=#000066>大家好，我的 Linux 好像怪怪的，因为没有办法以 root 的身份登入了</FONT>！』呵呵！几乎不要怀疑的可以跟这位朋友说：『<FONT color=#000066>您的 Linux 主机被入侵了！</FONT>』『瞎米！』早上才刚刚安装完 Linux 系统，下午立刻被入侵，这是真的还是假的！？呵呵！当然『<FONT color=#000066>系金</FONT>A！』，没有错！由于这个网络世界越来越复杂化，因特网的组成份子也就越来越多样化了～里面不乏很多所谓的『网络闲人』，天天在侦测人家的系统漏洞，并藉以宣称自己是『高手！』。对于这些人的想法，实在是觉得很奇怪！算了！不管怎么说，我们还是得防备一下这些不速之客啊！ <BR>　 <BR>一般来说，这些不速之客到底是怎么入侵您的 Linux 主机的呢？排除一些高级黑客的入侵手法，通常，一些低级怪客 ( Cracker ) 最喜欢直接由网络上面取得所谓的入侵软件( 不要怀疑，这些入侵软件真的随手可得！)，然后直接以这种入侵软件来进行 Linux 主机的攻击的！不过，这些攻击软件到底是怎么来的？！基本上，由于 Linux 上面的套件太多了，总是有些套件可能在设计之初没有想到一些可能被利用的程序漏洞，所以，当这样的程序发布之后，如果漏洞被利用，则可能会产生系统的危害。某些人士就针对这样的系统漏洞来写成一些程序，这些程序就可以直接利用这些套件的漏洞来攻击 Linux 主机了！也就是说，利用套件的漏洞就能够取得您主机上面的 root 的权限或者一些功能。所以啦！<B><FONT color=#000066>安装完 Linux 系统后，第一件要做的事情就是赶紧去升级您的系统套件</FONT></B>！ <BR>　 <BR>事实上，套件的漏洞倒不是一定是会被利用来进行入侵，有的时候，某些套件的漏洞可能导致您 Linux 主机的运行不良或者是容易产生系统当机等等的问题呢！所以，一个好的 Linux 主机，他的套件最好是随时保持在较新的版本上面，这样还是比较好一点的啦！关于安全漏洞的通报您可以参考底下的网站： <BR>　 
<UL>
<LI><FONT color=#000066>台湾计算机危机处理小组(TWCERT)：<A href="http://www.cert.org.tw/" target=_blank>http://www.cert.org.tw/</A></FONT> 
<LI><FONT color=#000066>Mandrake 的官方说明：<A href="http://www.mandrakesecure.net/en/docs.php" target=_blank>http://www.mandrakesecure.net/en/docs.php</A></FONT> 
<LI><FONT color=#000066>Red Hat 的官方说明：<A href="http://www.redhat.com/apps/support/errata/" target=_blank>http://www.redhat.com/apps/support/errata/</A></FONT> </LI></UL>　 <BR>了解了需要套件升级的基本理由之后，接下来要了解的是：『<FONT color=#000066>那么我要如何升级我的套件啊</FONT>？！』说的好！先来理解一下您的 Linux 系统上面是使用哪一种方式来安装您的套件的呢？！一般来说，有底下这几种方式： <BR>　 
<UL>
<LI><FONT color=#000066>RPM：这个是最早由 Red Hat 公司发展的，后来成为 Linux 上面使用最为广泛的一种套件制作与安装的方式；</FONT> 
<LI><FONT color=#000066>Tarball：使用原始码在您的系统上面编译出可以执行的档案，以成功的安装该套件；</FONT> 
<LI><FONT color=#000066>dpkg：与 RPM 有点类似的方式，是 Debian 的套件管理员。</FONT> </LI></UL>　 <BR>我们不谈哪一种套件管理方式好，只是要了解的是，这几种方式是常见的套件安装方法。好了，既然有这些套件安装的方式，所以啦，如果您的套件要升级，就需要依据当初安装这个套件所使用的方法来加以考虑了！举个例子来说，如果您的邮件服务器套件 sendmail 是经由 RPM 来安装的，那么当您要将 sendmail 这个套件『<FONT color=#000066>直接</FONT>』升级时，就需要使用原始的 distribution 那家公司所释出的 Sendmail 的 RPM 档案来安装！那么我可以使用 Tarball 来升级 sendmail 吗？！当然可以！不过，那就需要花比较多的时间去一个步骤一个步骤的完成升级的手续了！ ( 因为还需要经过主机搜寻、编译、安装与设定等等过程) 。 <BR>　 <BR>不管怎说，反正如果是手动升级的话，那么您就必须要<FONT color=#000066>(1)先到网络上面下载最新的档案(2)根据各个不同的方法来进行安装手续(3)额外的设定档设定</FONT>。唉！真是麻烦。难道说，真的套件升级只能使用 RPM/Tarball/dpkg 这些手动的方式吗？！ <BR><FONT color=#000000>　</FONT> <BR><FONT color=#000000>我们都晓得在 Windows 底下有个 update 的选项，这个 update 的选项可以随时将您的 Windows 保持在最新套件的环境中。此外，在一些防毒软件的附属功能中，由于病毒随时在变种，所以防毒软件也提供了在线直接更新的功能 ( Live Update )。咦！那我的 Linux 可不可以利用这样的功能来自动升级我的 Linux 套件啊？！如果可以的话，那就真的是太好了！ ^_^ ！呵呵！果真是太好了！目前在 Internet 上面就有多种的 Linux 套件在线更新方式呢！例如：</FONT> <BR><FONT color=#000000>　</FONT> 
<UL>
<LI><FONT color=#000066>Red Hat 提供的 up2date 这个套件升级方式；</FONT> 
<LI><FONT color=#000066>Mandrake 提供的 urpmi 升级方式；</FONT> 
<LI><FONT color=#000066>APT 的套件升级方法。</FONT> </LI></UL><FONT color=#000000>　</FONT> <BR><FONT color=#000000>这些套件升级的方式都是在线直接更新的呢！不过要小心的是，</FONT><FONT color=#000066>这些套件更新的方法几乎都是针对各个 distribution 自家的系统平台喔！</FONT><FONT color=#000000>例如 up2date 这个功能就只能在 Red Hat 的 distribution 上面工作，而 APT 的方式则需要找到自己能够使用的 APT Server 才行！此外，这些方法几乎都是针对已经打包完成的 RPM 档案来升级的哩！而且 up2date, urpmi 与 APT 都已经克服了 RPM 的档案相依属性的问题了喔！真是不错！然而，这些方法都是针对 RPM ，因此， Tarball 的套件是无法经由 up2date, urpmi 或者 APT 来升级的呢！还是得自己来手动升级的啦！</FONT> <BR><FONT color=#000000>　</FONT> <BR><FONT color=#000000>底下我们就来谈一谈目前常见的几种在线直接升级的方法，以及鸟哥自己写的一支线上升级的 BASH script 喔！</FONT></UL>
<HR width="100%">
<A name=up2date></A><FONT color=#000099 size=+1>以 up2date 进行 Linux 网络套件升级</FONT> 
<UL>
<DT><FONT color=#000000>为了让自家的 Linux 操作系统可以更安全更无后顾之忧，而且为了让使用者更方便来进行系统的套件升级，Red Hat 首先推出的就是 up2date 这个好用的家伙了！ up2date 可以让使用者在进行过注册的程序之后，直接以在线升级的方式进行套件的升级，相当的方便好用。不过，奇怪了， Red Hat 本身就已经有套件漏洞与错误通报网站，也就是底下这个网站：</FONT> 
<DT><FONT color=#000000>　</FONT> 
<UL>
<DT><FONT color=#000000><A href="http://www.redhat.com/apps/support/errata/" target=_blank>http://www.redhat.com/apps/support/errata/</A></FONT> </DT></UL>
<DT><FONT color=#000000>　</FONT> 
<DT><FONT color=#000000>使用者可以直接以浏览器连接到此网站，然后下载所需要的套件，就可以立刻升级了！既然如此，为何还需要使用 up2date 呢？有两个基本的原因啦！首先，由于在过去的经验中，使用者在进行 Red Hat 的 RPM 升级时，最容易发生的升级问题就是：『</FONT><FONT color=#000066>套件的属性相依问题</FONT><FONT color=#000000>！』如果对于『<A href="http://linux.vbird.org/linux_basic/">鸟哥的 Linux 私房菜 -- 基础学习篇</A>』还有印象的话，那就应该还记得 <A href="http://linux.vbird.org/linux_basic/0520rpmtarball.php">RPM 与 Tarball 套件管理员</A>那一章节吧！？我们知道 RPM 是已经经过编译过的可执行档案( binary file )，因此，他只能够在适合自己的版本与相关档案都已经安装的环境中，才可以被正确且正常的安装完毕！不过，使用者常常会忽略掉一些基本的套件安装，因此导致常常无法顺利升级，总是要找好几个需要一起同时升级的套件，啊！真是麻烦啊！再来，如果是自己到网站上去下载，由于是手动的方式，总是觉得不方便，尤其是当系统管理员同时管理好几部主机时，很有可能会不小心遗忘了某几部主机啊！伤脑筋～所以，这个时候就有 up2date 的推出了！</FONT> 
<DT><FONT color=#000000>　</FONT> 
<DT><FONT color=#000000>up2date 的工作原理中：</FONT> 
<DT><FONT color=#000000>　</FONT> 
<UL>
<LI><FONT color=#000066>首先会针对您的系统上面的套件进行分析，然后透过 Red Hat 的 up2date 网站进行交叉比对分析，并同时将所有需要的相依属性的套件一起记录下来；</FONT> 
<LI><FONT color=#000066>之后将上面的记录中所有需要的套件，包括那些相依属性的套件通通下载到您的 Linux 系统上面；</FONT> 
<LI><FONT color=#000066>最后，就是直接在您的 Linux 上面进行升级的动作啦！ ^_^</FONT> </LI></UL><FONT color=#000000>　</FONT> <BR><FONT color=#000000>太好了！如此一来我们可以不必考虑套件的属性相依的问题，因为 up2date 已经帮我们克服了！因此，我们的系统就可以自动的给他升级了！而不需要系统管理员手动的升级呢！闲话就不多说了，谈一谈 up2date 的使用流程吧！基本上， up2date 实作的过程很简单，不过由于还需要进行 up2date 的网站注册动作，所以您必须：</FONT></DT></UL>
<UL>
<OL>
<LI><FONT color=#000066>下载并更新 up2date 与 rhn_register 套件(注：在 Red Hat 9 以后， rhn_register 这个套件的功能已经整合到 up2date 里面去了, 所以 Red Hat 9 以后的版本只要 up2date 这个套件而已。)；</FONT> 
<LI><FONT color=#000066>确定可以登入 Internet ，可能的话，并找寻可支持的近端 proxy ；</FONT> 
<LI><FONT color=#000066>执行 rhn_register 在线注册；</FONT> 
<LI><FONT color=#000066>执行 up2date 更新套件。</FONT> </LI></OL></UL>
<UL>
<DT><FONT color=#000000>这样就可以。不过有几件事情必须说明一下：</FONT> 
<DT><FONT color=#000000>　</FONT> 
<UL>
<LI><FONT color=#000066>up2date 是 Red Hat 公司为了自己的 Linux 系统所推出的，所以当然仅支持 Red Hat Linux 而已，如果您不是 Red Hat Linux 的 Linux 使用者，不要使用 up2date 喔！</FONT> 
<LI><FONT color=#000066>up2date 套件在 Red Hat 7.2 以后已经预设安装好在您的 Linux 系统上面了，但是旧版本的 Red Hat 本身并没有 up2date 的套件 ( 例如 Red Hat 6.1 )，所以如果您是 Red Hat 系统的旧用户，那么您必须先安装 up2date 套件；</FONT> 
<LI><FONT color=#000066>由于 up2date 套件使用之前必须先登入 Red Hat 公司的 up2date 网站，所以您必须先注册才行。 Red Hat 使用的注册程序，即为 rhn_register ！因此，整个流程就是先注册，然后就可以在线更新。</FONT> 
<LI><FONT color=#000066>附加一点，目前 Red Hat 已经针对不同的用户进行 up2date 的在线更新流量限制，所以如果像我们这一种免费的用户，有可能会比较难登入 up2date Server 去进行更新的动作呦！这点请特别留意！所以，如果您的 ISP 或者网络环境不利于联机到国外的话，请记得使用 Proxy 喔！</FONT> 
<LI><FONT color=#000066>此外的此外，由于 rpm 套件只有 root 可以来变更系统，所以</FONT><FONT color=#000000>『</FONT><FONT color=#000099>以下的指令都必须以 root 的身份来安装</FONT><FONT color=#000000>』</FONT> </LI></UL><FONT color=#000000>　</FONT> <BR><FONT color=#000000>底下我们就一步一步来进行 up2date 的使用吧！</FONT> <BR><FONT color=#000000>　</FONT> <BR>
<HR width="100%">
<A name=up2date_install></A><FONT color=#000099>安装或更新 up2date 与 rhn_register 套件：</FONT> <BR><FONT color=#000000>　</FONT> <BR><FONT color=#000000>理论上， Red Hat 所释出的各版本 Linux 系统均有提供 up2date 的服务，不过，由于 up2date 是最近这几年才提供的服务，大约是在 Red Hat 7.x 以后才出现的玩意儿，所以说，那个 Red Hat 6.x 以前的版本实在是太旧了点，如果您仍然使用的是 Red Hat 6.x 以前的版本，那么我想，为了克服一些套件的漏洞，您的系统里面应该已经大多使用了 Tarball 所安装的套件了！呵呵！因此，说实在的，没有什么动力还要去玩 up2date 呢(因为 up2date 仅针对 Red Hat 自家公司所推出的 RPM 套件来进行更新而已！)！所以，底下的文件部分，鸟哥仅提供 Red Hat 7.x 以后的版本中，本来就含有 up2date 的环境底下的实作方式。原则上， Red Hat Linux 安装完毕之后，就已经提供了 up2date 的功能！我这里以 Red Hat 9 进行介绍！</FONT> <BR><FONT color=#000000>　</FONT> <BR>如果您的 Red Hat 版本是在 8.0 以前的话，那么您的系统当中应该会需要 rhn_register 与 up2date 两个套件，不过，如果是在 Red Hat 9 这个版本当中，那么只需要 up2date 即可！因为 rhn_register 这个套件的功能已经被整合到 up2date 里面去了！一般来说，当您安装好 Red Hat Linux 的时候，应该 up2date 会自动的安装上去，这个套件是预设选项会安装的取如果万一不幸没有安装上去的话，这个时候，请拿出您的 Red Hat 原版光盘，mount 他，然后直接安装吧！嗄！原版光盘不见了～伤脑筋，不过不要紧，请到中山大学去瞧一瞧吧！： <BR>　 
<UL><A href="http://ftp.nsysu.edu.tw/Linux/RedHat/linux/" target=_blank>http://ftp.nsysu.edu.tw/Linux/RedHat/linux/</A></UL>　 <BR>使用 rpm 将 up2date 或/与 rhn_register 两个套件安装起来吧！安装完毕之后，应该可以看到 up2date 在您的系统当中喔！以我的 Red Hat 9 为例： <BR>　 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>rpm -qa | grep up2date</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>up2date-3.1.23-1</FONT></TD></TR></TBODY></TABLE>　 <BR><B><I><FONT color=#000066>注<A name=up2date_install_problems-1></A>：由于 Red Hat 在 2003/08 更新 up2date 套件时，出了点小问题，导致使用者无法直接连接上 Red Hat 的 up2date 网站，所以，请先手动至 Red Hat 官方网站( <A href="http://www.redhat.com/apps/support/errata/" target=_blank>http://www.redhat.com/apps/support/errata/</A> ) 进行 up2date 程序的下载，并以 rpm -Uvh update-xxx.rpm 来升级后，才能继续下列的动作喔！</FONT></I></B> <BR>　 <BR>
<HR width="100%">
<A name=up2date_register></A><FONT color=#000099>注册：</FONT> <BR>　 <BR>up2date 的注册方式有两种方法，一种是直接以浏览器来在线注册，另外一种则是以 up2date 的程序功能 ( rhn_register ) 来进行直接注册！底下分别谈一谈注册的方法吧！ <BR>　 
<UL>
<LI><FONT color=#000099>以浏览器来在线注册：</FONT> <BR>up2date 的在线注册网站在这里：<FONT color=#000000><A href="http://rhn.redhat.com/network" target=_blank>http://rhn.redhat.com/network</A></FONT> ，联机之后如下图所示： <BR>　 
<CENTER><IMG height=375 src="58_files/up2date-register-1[1].jpg" width=398 nosave=""> <BR>&nbsp;</CENTER>因为尚未建立过注册的数据，所以当然要选择上面箭头的部分『<B><FONT color=#000099>Create Account</FONT></B>』(建立账号)！ <BR>　 
<CENTER><IMG height=557 src="58_files/up2date-register-2[1].jpg" width=468 nosave=""> <BR>&nbsp;</CENTER>Red Hat 提供三种注册的账号给使用者选择，分别是个人式账号、公司账号与学术研究账号。因为我们是一般用户啊！所以我们这里以个人式账号来进行说明！给他按下『<B><FONT color=#000099>Create a new personal account</FONT></B>』之后，出现下面画面，并请在有红色星号的空白处填写正确喔！并且在最右下方的按钮处按下『<B><FONT color=#000099>Create Account</FONT></B>』。 <BR>　 
<CENTER><IMG height=441 src="58_files/up2date-register-3[1].jpg" width=660 nosave=""> <BR>&nbsp;</CENTER>最后完成的画面就如同下面图示所示，这样就已经完成了注册了！注意！因为我们没有提供我们的操作系统给注册网站知道，因此，他并没有显示出目前我们 Red Hat 主机的数据！所以，您应该将注册时填写的账号与密码记录下来，因为这个是未来主机要联机时所必须要填写的数据！ <BR>　 
<CENTER><IMG height=520 src="58_files/up2date-register-4[1].jpg" width=372 nosave=""></CENTER>　 
<LI><FONT color=#000099>使用主机提供的 rhn_register 功能注册：</FONT> <BR>虽然使用浏览器来注册是比较方便一些，不过毕竟由于没有提供我们 Red Hat Linux 主机的信息，结果导致还要在注册完毕之后去改写 up2date 的设定文件数据，有点小麻烦啊！因此，使用 Linux 上面的 rhn_register 来注册不失为一个好主意！在主机上面注册的方式，先登入主机，开启一个终端机 (console) ，依步骤输入底下的数据： <BR>　 
<OL>
<LI><FONT color=#000066>重建 RPM 数据库：</FONT> <BR>因为我们必须告诉 Red Hat 的注册网站关于目前我们 Linux 主机的 RPM 套件信息，这样一来， Red Hat 的网站才能依照我们的 RPM 数据给予我们 Linux 系统的升级！所以，可能的话，最好是先重建一下 Linux 的 RPM 数据库： 
<TABLE cols=1 width=550 border=1>
<TBODY>
<TR bgColor=#000000>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test roo]# </FONT><FONT color=#ffff00>rpm --rebuilddb</FONT></FONT></TD></TR></TBODY></TABLE>　 
<LI><FONT color=#000066>首次注册程序：</FONT> <BR>就使用 rhn_register 这一支程序吧！ 
<TABLE cols=1 width=550 border=1>
<TBODY>
<TR bgColor=#000000>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test roo]# </FONT><FONT color=#ffff00>rhn_register</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>0.&nbsp; debug&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>1.&nbsp; rhnuuid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6b1058dc-82ee-11d7-9acb-cd7c6dfdb7bc</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>2.&nbsp; isatty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Yes</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>3.&nbsp; showAvailablePacka No</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>4.&nbsp; depslist&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; []</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>5.&nbsp; retrieveOnly&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>6.&nbsp; enableRollbacks&nbsp;&nbsp;&nbsp; No</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>7.&nbsp; pkgSkipList&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ['kernel*']</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>8.&nbsp; storageDir&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /var/spool/up2date</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>9.&nbsp; adminAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ['root@localhost']</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>10. noBootLoader&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>11. serverURL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; https://xmlrpc.rhn.redhat.com/XMLRPC</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>12. fileSkipList&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; []</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>13. sslCACert&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /usr/share/rhn/RHNS-CA-CERT</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>14. noReplaceConfig&nbsp;&nbsp;&nbsp; Yes</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>15. noReboots&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; None</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>16. useNoSSLForPackage No</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>17. systemIdPath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /etc/sysconfig/rhn/systemid</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>18. enableProxyAuth&nbsp;&nbsp;&nbsp; No</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>19. retrieveSource&nbsp;&nbsp;&nbsp;&nbsp; No</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>20. versionOverride</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>21. headerFetchCount&nbsp;&nbsp; 10</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>22. networkRetries&nbsp;&nbsp;&nbsp;&nbsp; 5</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>23. enableProxy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>24. proxyPassword</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>25. noSSLServerURL&nbsp;&nbsp;&nbsp;&nbsp; http://xmlrpc.rhn.redhat.com/XMLRPC</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>26. keepAfterInstall&nbsp;&nbsp; No</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>27. proxyUser</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>28. removeSkipList&nbsp;&nbsp;&nbsp;&nbsp; ['kernel*']</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>29. useGPG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Yes</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>30. gpgKeyRing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /etc/sysconfig/rhn/up2date-keyring.gpg</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>31. httpProxy</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>32. headerCacheSize&nbsp;&nbsp;&nbsp; 40</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>33. forceInstall&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>34. noReboot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; No</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Enter number of item to edit &lt;return to exit, q to quit without saving&gt;:&nbsp;</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>这个时候可以按下 Enter 来离开！而且，这个画面只有在第一次才会出现！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>此外，不同的版本出现的画面不太相同！不过原理都一样的啦！需要特别留意的</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>是上面几个不同字体的部分！不过不要紧，可以先保持默认值，其它的</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>未来再手动来设定。</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Your GPG keyring does not contain the Red Hat, Inc. public key.</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Without it, you will be unable to verify that packages Update Agent&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>downloads are securely signed by Red Hat.</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Your Update Agent options specify that you want to use GPG.</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>To install the key, run the following as root:</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp; rpm --import /usr/share/rhn/RPM-GPG-KEY</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>这里在说明我们的注册程序没有 Red Hat 的 GPG 公钥(Public Key)，</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>所以需要手动来制作一份！直接输入上面的字眼即可！</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>rpm --import /usr/share/rhn/RPM-GPG-KEY</FONT></FONT></TD></TR></TBODY></TABLE>上面的动作进行完毕后，如果您有信息想要更改，例如上图的 31 httpProxy 这个项目，如果您了解您使用的网络的上层代理服务器(Proxy)的话，可以填写这个数据！在哪里填写呢？！在底下这个档案内喔！ <BR><B><FONT color=#000099>/etc/sysconfig/rhn/up2date</FONT></B> <BR>　 
<LI><FONT color=#000066>开始编写与传送注册数据：</FONT> <BR>好了！基本的资料做完之后，可以开始传送与编写您的注册数据！<B><FONT color=#000099>再执行 rhn_register 一次后</FONT></B>，会出现下面的画面喔！ <BR>　 <BR><IMG height=341 src="58_files/up2date-register-51[1].jpg" width=586 nosave=""> <BR>　 <BR>按下 <B><FONT color=#000099>Next</FONT></B> 之后，会出现如下的 Red Hat 公司的隐私声名，请详细看完之后，按下 <B><FONT color=#000099>Next</FONT></B> 吧！ <BR>　 <BR><IMG height=341 src="58_files/up2date-register-52[1].jpg" width=586 nosave=""> <BR>　 <BR>在出现了如下的注册画面后，呵呵！填写您的注册数据吧！是否跟刚刚上面浏览器的申请一模一样呢？！没错啦！确实一样喔！填写完毕后，请输入 <B><FONT color=#000099>Next</FONT></B> 吧！ <BR>　 <BR><IMG height=341 src="58_files/up2date-register-53[1].jpg" width=586 nosave=""> <BR>　 <BR>呵呵！接下来就是要将我们主机的<FONT color=#000099>(1)硬件数据与(2)操作系统的信息</FONT>给他上传给 Red Hat 的注册网站！如下所示，如果一切都没有问题的话，就给他 <B><FONT color=#000099>Next</FONT></B> 吧！(使用 Tab 按键)。 <BR>　 <BR><IMG height=341 src="58_files/up2date-register-54[1].jpg" width=586 nosave=""> <BR>　 <BR>好了！在建立好我们的主机套件信息后，呵呵！在底下的画面按下 <B><FONT color=#000099>Next</FONT></B> 吧！ <BR>　 <BR><IMG height=84 src="58_files/up2date-register-55[1].jpg" width=328 nosave=""> <BR><IMG height=341 src="58_files/up2date-register-56[1].jpg" width=586 nosave=""> <BR>　 <BR>终于将一些信息收集完毕，呵呵！要将资料传上 Red Hat ！还是按下 <B><FONT color=#000099>Next</FONT></B> 吧！ <BR>　 <BR><IMG height=341 src="58_files/up2date-register-57[1].jpg" width=586 nosave=""> <BR><IMG height=341 src="58_files/up2date-register-58[1].jpg" width=586 nosave=""> <BR><IMG height=341 src="58_files/up2date-register-59[1].jpg" width=586 nosave=""> <BR>看到上面的 Finish 就表示，哈哈！『挖出温啊！』(我出运了)恭喜您！注册完毕！准备使用 up2date 的强大功能吧！ ^_^</LI></OL></LI></UL></DT></UL>
<UL>
<HR width="100%">
<A name=up2date_used></A><FONT color=#000099>开始使用 up2date 功能：</FONT> <BR><FONT color=#000000>　</FONT> <BR><FONT color=#000000>只有在第一次使用 up2date 之前才需要注册，未来您的主机就可以直接使用 up2date 而不需要再次的注册喔！好了，来使用 up2date 的功能吧！您可以使用 man up2date 来了解 up2date 的所有功能，不过，这里只几个可能比较常用的：</FONT> <BR>　 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test /root]# </FONT><FONT color=#ffff00>up2date -l</FONT><FONT color=#ffffff>　　</FONT><FONT color=#ff6666>　　　&lt;==列出所有可以升级的套件</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test /root]#</FONT><FONT color=#ffff00> up2date --showall</FONT><FONT color=#ffffff>　</FONT><FONT color=#ff6666>&lt;==列出您的版本中，有没有可以升级的套件</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test /root]#</FONT><FONT color=#ffff00> up2date -i packages</FONT><FONT color=#ff6666>&lt;==直接升级 packages 那个套件！例如：</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test /root]# </FONT><FONT color=#ffff00>up2date -i gdb　</FONT><FONT color=#ff6666>&lt;==直接连到 Red Hat 主机升级 gdb 这个套件</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test /root]#</FONT><FONT color=#ffff00> up2date -i u　</FONT><FONT color=#ff6666>　&lt;==全部的套件升级！等于升级您的 Red Hat ！</FONT></FONT></TD></TR></TBODY></TABLE>　 <BR>举个常见的例子来进行 up2date 的更新动作好了： <BR>　 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffcc size=-1># 1. 先检查一下我的主机需要进行更新的套件有哪些？</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test /root]# </FONT><FONT color=#ffff00>up2date -l</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Fetching package list for channel: redhat-linux-i386-9...</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>########################################</FONT> 
<P><FONT face=SimSun color=#ffffff size=-1>Fetching Obsoletes list for channel: redhat-linux-i386-9...</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>########################################</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>Fetching rpm headers...</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>########################################</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Version&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Rel</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>----------------------------------------------------------</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>redhat-config-date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.5.15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unzip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 14</FONT> </P>
<P><FONT face=SimSun color=#ff6666 size=-1>注：因为我曾经更新过，所以这里显示出来的套件有点少喔！ ^_^</FONT> </P>
<P><FONT face=SimSun color=#ffffcc size=-1># 2. 针对 unzip 这个套件来更新一下：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test /root]# </FONT><FONT color=#ffff00>rpm -q unzip</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unzip-5.50-7</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test /root]# </FONT><FONT color=#ffff00>up2date -i unzip</FONT></FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>Fetching package list for channel: redhat-linux-i386-9...</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>########################################</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>Fetching Obsoletes list for channel: redhat-linux-i386-9...</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>########################################</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>Fetching rpm headers...</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>########################################</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>Testing package set / solving RPM inter-dependencies...</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>########################################</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unzip-5.50-14.i386.rpm:&nbsp;&nbsp;&nbsp;&nbsp; ###############&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 k/sec, 00:00:34 rem.</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unzip-5.50-14.i386.rpm:&nbsp;&nbsp;&nbsp;&nbsp; ########################## Done.</FONT></P></TD></TR></TBODY></TABLE>　 <BR>
<HR width="100%">
<A name=up2date_final></A><FONT color=#000099>结语<FONT size=+1>：</FONT></FONT> <BR><FONT color=#000099 size=+1>　</FONT> <BR><FONT color=#000000>其实我个人对于 up2date 的评价还不错！因为他解决了在 Red Hat 使用的 RPM 套件当中，属性相依的这个最麻烦也最讨厌的问题了！使得使用者与系统管理员可以轻松的无痛的进行系统套件的升级！不过，并不是每个人都适合使用 up2date 来进行套件的升级的啦！怎么说呢？</FONT> <BR><FONT color=#000000>　</FONT> 
<UL>
<LI><FONT color=#000066>网络问题</FONT><FONT color=#000000>：由于『知识服务无价！』所以，Red Hat 确实是有针对不同的使用者限制 up2date 的流量的！有付费的注册会员会有较大的使用频宽喔！当 Red Hat 注册主机流量不足时，当然，我们这些散兵游勇就不可能有频宽可以进行升级了！因此，呵呵！小流量的我们的主机，想使用 up2date 来升级，会花上很长的一段时间的！</FONT> </LI></UL><FONT color=#000000>　</FONT> 
<UL>
<LI><FONT color=#000066>套件安装问题</FONT><FONT color=#000000>：如果您喜欢自己使用 Tarball 进行自己的套件修补的话，那么 up2date 对您而言可能根本没有什么用处的！因为他只针对 Red Hat 自家出品的 RPM 档案进行升级而已喔！</FONT> </LI></UL><FONT color=#000000>　</FONT> <BR><FONT color=#000000>不过，无论如何，</FONT><FONT color=#000066>鸟哥还是相当建议您去进行注册的</FONT><FONT color=#000000>！为什么呢？因为网络上面的安全通报很多，我们可能没有什么时间去关心一下网络安全的问题！这个时候， up2date 的好处就来啦！因为每次 up2date 发现您的套件(</FONT><FONT color=#000066>在注册的时候不是有提供您系统上面的套件吗？！就是那个啦！</FONT><FONT color=#000000>)可能有漏洞，并且也已经推出修补的程序时，就会发送 email 到您的信箱去！该封 email 列有相当详细的问题解析与如何升级的方式，呵呵！光是这些信息，对于系统管理员的我们来说，就具有相当棒的好处啦！您说是吧！ ^_^</FONT> <BR><FONT color=#000000>　</FONT> <BR><FONT color=#000000>反正，能够以 Linux 上网之后，第一件事情，请您赶快进行 Linux 系统之套件的升级吧！以免有些漏洞造成您系统整体的问题！</FONT></UL>
<HR width="100%">
<A name=mandrake></A><FONT color=#000099 size=+1>Mandrake 的 urpmi 升级</FONT> 
<UL>相对于 Red Hat 的 up2date ， Mandrake 也自行推出了一个 urpmi 的套件，这个套件也可以用来进行网络升级喔！事实上， urpmi 是个很不错用的套件，相对于 up2date 一定需要到 Red Hat 的 up2date 上面去进行升级， <FONT color=#000066>urpmi 则可以自行选择提供 RPM 档案的服务器来源 ( 在 urpmi 里面称为媒体, media )</FONT>，而且与 up2date 相同的是， urpmi 也会自动的由远程服务器 ( 远程的媒体 ) 上面的套件去分析各个 RPM 档案之间的相依属性 (dependence ) 之后，然后再下载所需要的套件，并据以升级自己的套件！所以，我们只要： <BR>　 
<OL>
<LI><FONT color=#000066>选择最靠近我们主机的 FTP 网站，并以 urpmi.addmedia 指令将该网站(媒体)加入到 urpmi 分析的媒体当中；</FONT> 
<LI><FONT color=#000066>将上面登录的媒体当中，所有的套件信息写到我们的主机上面 (使用 urpmi.update 指令 )；</FONT> 
<LI><FONT color=#000066>利用 urpmi 指令来进行套件升级。</FONT> </LI></OL>　 <BR>全部的动作就是这么简单喔！ ^_^ <BR>　 <BR>
<HR width="100%">
<A name=mandrake_package></A><FONT color=#000099>urpmi 的套件结构</FONT> <BR><FONT color=#000000>　</FONT> <BR><FONT color=#000000>urpmi 相关的设定文件与执行指令有：</FONT> <BR><FONT color=#000000>　</FONT> 
<UL>
<LI><FONT face=SimSun><B><FONT color=#000066>/var/lib/urpmi/list.*</FONT></B><FONT color=#000000>：刚刚上面不是提到了媒体吗？这个媒体有可能是原版光盘、 FTP 服务器网站以及 WWW 网站等等。而这些媒体上面的信息都会被纪录到 urpmi 的纪录文件当中，那就是这个档案的功能啦！当我们选择了媒体，并且使用 urpmi.addmedia 之后，相关的 list.媒体名称 就会被建立，而当使用 urpmi.update 则该档案就会被更新！也就是说，每一个媒体都会具有一个信息纪录档案。举例来说，我的 Mandrake 9.0 有三块光盘，这三块光盘的信息就分别在：</FONT></FONT> 
<UL>
<LI><FONT face=SimSun color=#000066>list.Installation CD 1 (x86) (cdrom1)</FONT> 
<LI><FONT face=SimSun color=#000066>list.Installation CD 2 (x86) (cdrom2)</FONT> 
<LI><FONT face=SimSun color=#000066>list.International CD (x86) (cdrom3)</FONT> </LI></UL><FONT face=SimSun color=#000000>上面三个档案分别记录了三块光盘的内容，当我以 urpmi 要安装某个程序时， urpmi 就会到这这三个档案内去搜寻我要的套件，然后自己分析出相依属性的套件，我只要顺着屏幕的数据放入原版光盘即可！不再需要自己去搞定 RPM 的属性相依问题了。</FONT> <BR><FONT face=SimSun color=#000000>　</FONT> 
<LI><FONT face=SimSun><B><FONT color=#000066>/var/lib/urpmi/hdlist.*</FONT></B><FONT color=#000000> 与 </FONT><B><FONT color=#000066>/var/lib/urpmi/synthesis.*</FONT></B><FONT color=#000000>：与 list.* 类似的，主要的档案内容仍在于将媒体的信息记录下来，好让 urpmi 可以顺利的进行套件的属性相依分析与下载升级等动作！</FONT></FONT> <BR><FONT face=SimSun color=#000000>　</FONT> 
<LI><FONT face=SimSun><B><FONT color=#000066>/etc/urpmi/urpmi.cfg</FONT></B><FONT color=#000000>：这个档案记录了各个媒体的说明而已，例如预设的情况下，这个档案内有三块原版光盘的说明而已。</FONT></FONT> <BR><FONT face=SimSun color=#000000>　</FONT> 
<LI><FONT face=SimSun><B><FONT color=#000066>/etc/urpmi/skip.list</FONT></B><FONT color=#000000>：这个档案里面如果有列出某些套件名称(可以使用正规表示法来表示套件名称)，则该套件就不能以 urpmi 来自动升级了。这样可以避免一些比较危险的套件安装。预设的情况下这个档案里面不会有任何套件名称存在。</FONT></FONT> <BR><FONT face=SimSun color=#000000>　</FONT> 
<LI><FONT face=SimSun><B><FONT color=#000066>/etc/urpmi/inst.list</FONT></B><FONT color=#000000>：列出您需要安装，而不是升级的套件！</FONT></FONT> <BR><FONT face=SimSun color=#000000>　</FONT> 
<LI><FONT face=SimSun><B><FONT color=#000066>/usr/sbin/urpmi</FONT></B><FONT color=#000000>：这个就是安装的主程序啦！</FONT></FONT> <BR><FONT face=SimSun color=#000000>　</FONT> 
<LI><FONT face=SimSun><B><FONT color=#000066>/usr/sbin/urpme</FONT></B><FONT color=#000000>：这个就是移除的主程序啦！</FONT></FONT> <BR><FONT face=SimSun color=#000000>　</FONT> 
<LI><FONT face=SimSun><B><FONT color=#000066>/usr/sbin/urpmq</FONT></B><FONT color=#000000>：这个就是用来查询媒体里面包含的套件信息！</FONT></FONT> <BR><FONT face=SimSun color=#000000>　</FONT> 
<LI><FONT face=SimSun><B><FONT color=#000066>/usr/sbin/urpmi.addmedia</FONT></B><FONT color=#000000> 与 </FONT><B><FONT color=#000066>/usr/sbin/urpmi.update</FONT></B><FONT color=#000000> ：这两个指令的主要功能就是用来新增 RPM 放置的媒体 ( 不论是储存媒体还是网站 )，以及将媒体上面的信息更新到自己的 /var/lib/urpmi 目录下的档案当中！</FONT></FONT> </LI></UL><FONT face=SimSun color=#000000>　</FONT> <BR><FONT face=SimSun color=#000000>基本上，最常用到的就是 urpmi 咯，而不要忘记了刚开始使用 urpmi 的时候需要选择媒体，那么 urpmi.addmedia 也需要学会喔！</FONT> <BR><FONT color=#000000>　</FONT> <BR>
<HR width="100%">
<A name=mandrake_media></A><FONT color=#000099>选择 RPM 档案的媒体</FONT> <BR><FONT color=#000000>　</FONT> <BR>虽然在 /var/lib/urmpi/list.* 已经具有原版光盘的 RPM 档案信息存在了，但是老是抽换光盘总是觉得蛮讨厌的！所以在这里，我依然选择了一个 Internet 上面的 Mandrake 原版 RPM 档案的网站，另外，也选择了一个升级网站 (update 网站，或者是 patch 网站) ，好让我可以自由自在的经过 Internet 来安装或升级我的系统。考虑到我在南部，所以我选择了中山大学这个 FTP 网站，而这个网站关于 Mandrake 的路径为：(<I><FONT color=#000066>请注意，我以 Mandrake 9.0 为范例喔！如果您是 Mandrake 9.1 或者其它版本，请自行寻找对应的网站路径</FONT></I>！) <BR>　 
<UL>
<LI><FONT color=#000066>Mandrake 9.0 原版释出套件：</FONT> <BR><FONT color=#000066>套件放置的路径：<A href="ftp://ftp.nsysu.edu.tw/Linux/Mandrake/mandrake-old/9.0/i586/Mandrake/RPMS/" target=_blank>ftp://ftp.nsysu.edu.tw/Linux/Mandrake/mandrake-old/9.0/i586/Mandrake/RPMS/</A></FONT> <BR><FONT color=#000066>与这个套件有关的 hdlist 档案：<A href="ftp://ftp.nsysu.edu.tw/Linux/Mandrake/mandrake-old/9.0/i586/Mandrake/base/hdlist.cz" target=_blank>ftp://ftp.nsysu.edu.tw/Linux/Mandrake/mandrake-old/9.0/i586/Mandrake/base/hdlist.cz</A></FONT> <BR><FONT color=#000066>　</FONT> 
<LI><FONT color=#000066>Mandrake 9.0 升级的 RPM 档案</FONT> <BR><FONT color=#000066>路径：<A href="ftp://ftp.nsysu.edu.tw/Linux/Mandrake/mandrake/updates/9.0/RPMS/" target=_blank>ftp://ftp.nsysu.edu.tw/Linux/Mandrake/mandrake/updates/9.0/RPMS/</A></FONT> <BR><FONT color=#000066>与这个套件有关的 hdlist 档案：<A href="ftp://ftp.nsysu.edu.tw/Linux/Mandrake/mandrake/updates/9.0/base/hdlist.cz" target=_blank>ftp://ftp.nsysu.edu.tw/Linux/Mandrake/mandrake/updates/9.0/base/hdlist.cz</A></FONT></LI></UL>　 <BR>特别注意到上面，每个 Mandrake 释出的 RPM 都会附上一个 hdlist.cz 的档案来记录 RPM 的相关性，这个 hdlist.cz 档案相当的重要，我们在底下介绍 urpmi.addmedia 来新增媒体时时，<FONT color=#000066>就是以这个 hdlist.cz 做为我们分析 RPM 属性的依据来源！</FONT>通常这个档案放置的地点会是在每个 RPM 档案放置的路径上层的一个名为 base 的目录下，例如 /PATH/Mandrake/RPMS 放置了所有的 RPM 档案，而这些 RPM 档案的相关性则放置在 /PATH/Mandrake/base/hdlist.cz 里面啦！也就是说，他的相对路径其实通常是在 ../base/hdlist.cz 喔！ ^_^ <BR>　 <BR>而刚刚在 urpmi 的架构中，我们知道 /var/lib/urmpi/list.* 等等的档案是一个媒体为一个文件名，在这个地方，我们其实是选择了两个媒体喔(当然，您可以选择更多的媒体！)，好了，我这里将这两个媒体命名为(您可以自行设定媒体名称)： <BR>　 
<UL>
<LI><FONT color=#000066>原本的 RPM 档案路径：packages.ftp.nsysu</FONT> 
<LI><FONT color=#000066>升级的 RPM 档案路径：update.ftp.nsysu</FONT> </LI></UL>　 <BR>好了，让我们将上面这两个媒体信息给他复制到我们的 Mandrake 系统上吧！ <BR>　 
<TABLE cols=1 width=570 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><A name=urpmi.addmedia></A><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>urpmi.addmedia [name] [url] with [属性相关性档案]</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>参数说明：</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>[name]：为您要为这个媒体设定的一个容易记忆的名称</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　　　设定好之后，会将该名称写入 /etc/urpmi/urmpi.cfg 里面</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>[url] ：就是 ftp 服务器的完整路径！</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>[属性相关档案]：刚刚上面我们不是提到一个 hdlist.cz 吗？就是那个档案</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　　　　　　　相对于 [url] 的相对路径与文件名！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>范例：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>urpmi.addmedia package.ftp.nsysu&nbsp; \</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt; </FONT><FONT color=#ffff00>ftp://ftp.nsysu.edu.tw/Linux/Mandrake/mandrake-old/9.0/i586/Mandrake/RPMS \</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt; </FONT><FONT color=#ffff00>with ../base/hdlist.cz</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>urmpi.addmedia update.ftp.nsysu \</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt; </FONT><FONT color=#ffff00>ftp://ftp.nsysu.edu.tw/Linux/Mandrake/mandrake/updates/9.0/RPMS&nbsp; \</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt; </FONT><FONT color=#ffff00>with ../base/hdlist.cz</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 上面的动作进行完毕之后，会更动 /etc/urpmi/urmpi.cfg 以及</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># /var/lib/urpmi/ 目录下的内容喔！</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 察看一下 /etc/urpmi/urpmi.cfg 的内容可以发现：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>more /etc/urpmi/urpmi.cfg</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>package.ftp.nsysu&nbsp; {</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp; hdlist: hdlist.package.ftp.nsysu.cz</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp; with_hdlist: ../base/hdlist.cz</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp; list: list.package.ftp.nsysu</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>}</FONT> 
<P><FONT face=SimSun color=#ffffff size=-1>update.ftp.nsysu&nbsp; {</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp; hdlist: hdlist.update.ftp.nsysu.cz</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp; with_hdlist: ../base/hdlist.cz</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp; list: list.update.ftp.nsysu</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>}</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 看到了吧！两个媒体已经加入了我们的搜寻！</FONT></P></TD></TR></TBODY></TABLE>&nbsp;　 <BR>如果您想要将刚刚的媒体，或者是原版 CD 的信息移除的话，那么您就可以这样做： <BR>　 
<TABLE cols=1 width=570 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><A name=urpmi.removemedia></A><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>urpmi.removemedia [name]</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>参数说明：</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>[name]：为媒体的名称</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>范例：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>urpmi.removemedia package.ftp.nsysu</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>　</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 事实上，我蛮讨厌原版光盘还在 /etc/urpmi/urpmi.cfg 里面的，</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 所以我都会将他移除说！</FONT></TD></TR></TBODY></TABLE>&nbsp;　 <BR>
<HR width="100%">
<A name=mandrake_updatego></A><FONT color=#000099>进行升级： urpmi.update, urpmi</FONT> <BR>　 <BR>在进行升级之前，有没有想到一件事情，网络上面的 update 修补套件是一直在公告的，所以前一个小节提到的 /PATH/Mandrake/base/hdlist.cz 其实『<FONT color=#000066>是一直在更动的！</FONT>』，亦即每次 Mandrake 公司释出新版的修补套件后，就会同时更新 hdlist.cz ，然而我们的 /var/lib/urpmi/* 只有第一次增加媒体的时候才会主动建立！那么怎么更新套件的信息呢？因为一定要更新套件的信息啊，不然新释出的套件就不会被我们的 urpmi 捉到了！更新的步骤真是太简单了： <BR>　 
<TABLE cols=1 width=570 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><A name=urpmi.update></A><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>urpmi.update [name]</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>参数说明：</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>[name]：为媒体的名称</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>范例：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>urpmi.update update.ftp.nsysu</FONT></FONT></TD></TR></TBODY></TABLE>&nbsp;　 <BR>注意一下，因为原版释出的 RPM 档案并不会被更动，所以没有必要对 package.ftp.nsysu 进行 urpmi.update 的动作！但是 <FONT color=#000066>update.ftp.nsysu 这个媒体则『每次在进行升级前，都需要 urpmi.update 一次</FONT>』。好了，更新完毕之后，就来给他升级吧！ <BR>　 
<TABLE cols=1 width=570 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><A name=urpmi></A><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>urpmi [options] [套件名称]</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>参数说明：</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>[options]：主要的参数有：</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　--media 媒体名称：以哪一个媒体来进行搜寻 RPM 的动作？</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　--auto：自动进行升级的动作，而不会再询问使用者</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　--auto-select：自动将属性相依的档案安装起来；</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>[套件名称]：就是要进行升级的套件！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>范例：</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1># 将 tcpdump 升级一下！</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>urpmi --media update.ftp.nsysu tcpdump</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1># 自动将所有的套件都给他升级一下：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> urpmi --media update.ftp.nsysu --auto --auto-select</FONT></FONT></TD></TR></TBODY></TABLE>&nbsp;　 <BR>
<HR width="100%">
<A name=mandrake_every_date></A><FONT color=#000099>每日自动升级</FONT> <BR>　 <BR>如果说要让系统每日进行升级的话，那么您可以使用 cron 这个 daemon 的辅助啊！如果先以手动方式确定 urpmi.update 与 urpmi 执行都没有问题，就可以这样做： <BR>　 
<TABLE cols=1 width=570 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>vi /etc/crontab</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 在这个档案当中新增一行：</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>30 5 * * * root /usr/sbin/urpmi.update update.ftp.nsysu &gt; /dev/null ; /usr/sbin/urpmi --media update.ftp.nsysu --auto --auto-select &gt; /dev/null</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 特别注意，上面是同一行啊！</FONT></TD></TR></TBODY></TABLE>　 <BR>透过这样的一个手段后，您的 Mandrake 可以很便利的进行自我升级呢！很不赖吧！ ^_^</UL>
<HR width="100%">
<A name=apt_client></A><FONT color=#000099 size=+1>APT 的使用</FONT> 
<OL>除了 up2date 与 urpmi 之外，其实我们也可以透过 APT 来进行套件的升级喔。事实上， APT 主机的动作与 urpmi 有点类似的，我们要以 <A href="http://linux.vbird.org/linux_server/0450apt.php">APT 服务器</A>提供的功能来自我套件升级时，同样的需要透过 Server 与我们 Linux 主机的套件比对之后，才能够进行套件的安装与升级！我以我的 Red Hat 9 作为范例，要以 APT 网络升级套件时，我们应该这么做： <BR>　 
<OL>
<LI><B><FONT color=#000066>先寻找适合我们 Linux 系统的 apt 套件，并且安装：</FONT></B> <BR>如果是 Red Hat 系统，可以使用底下的网站提供的 RPM 档案来安装喔： <BR><A href="http://apt.freshrpms.net/" target=_blank>http://apt.freshrpms.net/</A> <BR>以我的 Red Hat 9 为例，要安装的动作为： 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>rpm -ivh \</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt;</FONT><FONT color=#ffff00> http://ftp.freshrpms.net/pub/freshrpms/redhat/9/apt/apt-0.5.5cnc6-fr1.i386.rpm</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> rpm --import \</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt;</FONT><FONT color=#ffff00> ftp://linux.sinica.edu.tw/redhat/redhat-9/en/os/i386/RPM-GPG-KEY</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> rpm --import http://ftp.freshrpms.net/pub/freshrpms/RPM-GPG-KEY</FONT></FONT></TD></TR></TBODY></TABLE>这样就可以直接网络上安装该套件了！一般来说，我们在安装了 RPM 之后，为了要信任来源网站，所以要将该网站提供的 Public Key 读进我们的 linux 系统当中，那就是上面为何需要 import 的原因了！ <BR>　 
<LI><B><FONT color=#000066>寻找合适的更新主机：sources.list</FONT></B> <BR>既然 APT 是去到 APT Server 来下载我们 Client 端所需要的套件，所以当然就要寻找我们所需要的 APT 主机啦！如果您是以上面的 APT 套件来安装您的 APT 的话，那么预设的 APT 主机设定在 <FONT face=SimSun color=#000066>/etc/apt/sources.list</FONT> 里面，内容有点像这样： 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>vi /etc/apt/sources.list</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1># Red Hat Linux 9</FONT> <BR><B><FONT face=SimSun color=#ffffff size=-1>rpm http://ayo.freshrpms.net redhat/9/i386 os updates freshrpms</FONT></B> <BR><FONT face=SimSun color=#ffffff size=-1>#rpm-src http://ayo.freshrpms.net redhat/9/i386 os updates freshrpms</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 里面料的格式为：</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1># rpm &lt;APT服务器地址&gt; &lt;相对于服务器的路径&gt; &lt;目录一&gt; &lt;目录二&gt; &lt;目录三&gt; ...</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 以上面的例子来说，事实上 RPM 放置的目录在：</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># http://ayo.freshrpms.net/redhat/9/i386/RPMS.os</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># http://ayo.freshrpms.net/redhat/9/i386/RPMS.updates</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># http://ayo.freshrpms.net/redhat/9/i386/RPMS.freshrpms</FONT></TD></TR></TBODY></TABLE>我们使用预设的路径即可！当然，您可以自行去 Internet 上面搜寻最靠近我们的 APT 服务器，这样可以让我们的 RPM 下载速度比较快啦！ <BR>　 
<LI><B><FONT color=#000066>更新 Client 与 APT Server 的对应清单：</FONT></B> <BR>在每次更新之前，请务必将您的主机上面的 RPM 属性清单与 APT 服务器上面同步更新，这样才能下载到最新的套件啊！更新的方式很简单： 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>apt-get update</FONT></FONT></TD></TR></TBODY></TABLE>　 
<LI><B><FONT color=#000066>开始更新与每日更新：</FONT></B> <BR>要安装与更新来自 APT 主机的 RPM 档案真的很简单，只要一个指令 apt-get 即可！工作的方法如下： 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>apt-get &lt;options&gt; &lt;更新项目&gt; &lt;套件名称&gt;</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>参数说明：</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>options：关于参数有底下几个较常见的：</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　-q 不要输出讯息，安静一点比较好吗？！ ^_^</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　-y 如果 apt-get 在工作过程中需要使用者响应，这个参数可以直接回答 yes&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>更新项目：更新的动作有底下几个：</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　update：就是刚刚我们上个动作说的，要更新 Client 与 Server 的清单对应</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　install：安装某个套件，后面接套件名称</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　dist-upgrade：自动升级我们系统上面已经安装的所有 RPM 套件喔</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　clean：将下载自 APT 主机的的 RPM 档案删除哩！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>范例：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> apt-get install tcpdump&nbsp;</FONT><FONT color=#ff6666> # 安装 tcpdump 这个套件</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>apt-get -y dist-upgrade&nbsp; </FONT><FONT color=#ff6666># 升级我们系统上面的所有 RPM 套件</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> apt-get clean&nbsp;</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1># 至于每日更新的话，可以写入 /etc/crontab 喔</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> vi /etc/crontab</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>40 5 * * * root apt-get update; apt-get -y dist-upgrade ; apt-get clean</FONT></TD></TR></TBODY></TABLE>&nbsp;</LI></OL>呵呵！这么简单的方法就可以自动的更新我们的 Linux ！当然啦，我这里是以 Red Hat 系统为范例，如果您的系统并非为 Red Hat ，那么您就得要自行到 Internet 上面去搜寻您的 distributions 的 APT Server 咯！至于如果您想要自行架设 APT 主机的话，请参考后续章节的 <A href="http://linux.vbird.org/linux_server/0450apt.php">APT 服务器架设</A>。</OL>
<HR width="100%">
<A name=vbird_zzgetrpmfile></A><FONT color=#000099 size=+1>VBird 的自动更新程序</FONT> 
<UL>套件的升级真的很重要，而透过在线直接升级则是一个很不错的方式，例如前面介绍的 up2date, urpmi 与 APT 等方法。不过，您是否思考过，既然每一个 Linux distribution 在发现漏洞之后都会释出相关的套件修补版本，并且公告在 Internet 上面，而台湾地区很多好的站台都会将这些资料保留下来，以方便台湾地区的 Linux 爱好者可以很快速的进行下载与升级的动作！而由于各大 Linux distribution 在释出他们修改过的套件时，均同时会将相关的属性相依的套件问题一起解决，所以啦！<FONT color=#000066>只要将同时间释出的套件下载下来，并且同时予以升级，一般来说，都不会有属性相依的困扰呢</FONT>！ <BR>　 <BR>根据这样的考虑，让 VBird 思考了一件事情，既然我们可以用手动的方式来将国内 FTP 网站的 RPM 档案捉下来，然后在 Linux 上面进行套件更新，那么是否我们可以透过 scripts 来帮我们分析新释出的档案，并且依据这些数据来进行在线的自动更新呢？！ <BR>　 <BR>呵呵！在经过一段时间的改写之后，终于使用 <A href="http://linux.vbird.org/linux_server/0140networkcommand.php#lynx">lynx</A> 以及 <A href="http://linux.vbird.org/linux_server/0140networkcommand.php#wget">wget</A> 完成了一个可以自动更新 Linux 系统的 script 了！我是利用<A href="http://ftp.nsysu.edu.tw/" target=_blank>中山大学的 FTP 网站</A>来进行 RPM 档案的下载与分析的！而由于这个程序是使用 FTP 网站的数据，并且利用比对的方式来找出自己所需要的套件，所以呢，基本上程序应该是能够符合使用 RPM 安装的 Linux 系统的，目前我在 Red Hat 以及 Mandrake 系统上面测试过这个程序，都没有问题！理论上， Open Linux 以及其它使用 RPM 方式来安装套件的 Linux 系统应该都可以使用这支程序才是！ <BR>　 <BR>这支程序主要的工作流程图是这样的： <BR>　 <BR><IMG height=629 src="58_files/zzgetrpm[1].jpg" width=483 nosave=""> <BR>　 
<OL>
<LI><FONT color=#000066>由国内 FTP 网站上面，搜寻符合自己系统相关的 RPM 套件；</FONT> 
<LI><FONT color=#000066>以上面的步骤所取得的 RPM 档案信息中，比对与自己目前已经下载过的 RPM 档案，如果没有新增的档案，那么程序就会停止；</FONT> 
<LI><FONT color=#000066>如果 FTP 上面的新增档案，其实是我们主机所需要的 RPM 升级套件之一，那么就将 FTP 网站上面新增的档案下载下来；</FONT> 
<LI><FONT color=#000066>将上面的步骤中所自动产生的 bash scripts 执行他，使我们的 Linux 自动的去下载新的套件到目前所在的目录中；</FONT> 
<LI><FONT color=#000066>可以设定忽略某些套件的下载与安装，利用 ignore 这个参数！</FONT> 
<LI><FONT color=#000066>可以设定是否需要系统自动的帮您升级系统内的 RPM 套件！</FONT> 
<LI><FONT color=#000066>升级成功后， RPM 档案可视情况自动删除！</FONT> </LI></OL>　 <BR>您可以在底下的网页找到下载这支程序的地方： 
<BLOCKQUOTE><A href="http://linux.vbird.org/download/#zzgetrpm">http://linux.vbird.org/download/#zzgetrpm</A></BLOCKQUOTE>整个程序的安装方法也是很简单的！ <BR>　 
<OL>
<LI>先查到您的 Linux 的 distribution 的 FTP 网站的网址，建议可以到中山大学的 FTP 网站 ( <A href="ftp://ftp.nsysu.edu.tw/Linux/" target=_blank>ftp://ftp.nsysu.edu.tw/Linux/</A> ) 上面寻找相关的网址！请注意，必须使用 ftp://website 的网址！不要使用 http://website 的网址，因为 lynx 判断会失误喔！以我为例，我的 Red Hat 9 就使用底下的网址啦： <BR><A href="ftp://ftp.nsysu.edu.tw/Linux/RedHat/updates/9/en/os/i386/" target=_blank>ftp://ftp.nsysu.edu.tw/Linux/RedHat/updates/9/en/os/i386/</A> <BR>在程序当中我列出了 Red Hat 7.1~9 以及 Mandrake 9.0~9.1 的网址列，您可以直接将属于您的 OS 该行前面的 # 拿掉即可！注意， url 仅能有一个喔！ <BR>　 
<LI>建立一个目录，注意，该目录最好能够有 500 MB 以上的空间！以我为例，我都会额外规划出一个 partition 进行备份与升级的工作，这个 partition 通常命名为 /mybackup ，而我的升级目录就可以建立成为： <BR><FONT face=SimSun color=#000066>mkdir -p /mybackup/update9</FONT> <BR>　 
<LI>将 zzgetrpm.sh 放置到该目录下，并且更改属性成为可以执行喔！ <BR><FONT face=SimSun color=#000066>cp /your/full/path/zzgetrpm.sh /mybackup/update9</FONT> <BR><FONT face=SimSun color=#000066>chmod 755 /mybackup/update9/zzgetrpm.sh</FONT> <BR><FONT face=SimSun color=#000066>　</FONT> 
<LI>将 zzgetrpm.sh 里面的几个变量更改成为您的环境，例如： <BR><FONT face=SimSun color=#000066>basedir=/mybackup/update9</FONT> <BR><FONT face=SimSun color=#000066>url=ftp://ftp.nsysu.edu.tw/Linux/RedHat/updates/9/en/os/i386/</FONT> <BR><FONT face=SimSun color=#000066>　</FONT> 
<LI>选择是否需要自动更新，亦即 autoupdate 那个变量的设定值！预设的情况下是需要自动更新的呢！ <BR>　 
<LI>尝试执行看看有没有错误讯息： <BR><FONT face=SimSun color=#000066>/mybackup/update9/zzgetrpm.sh</FONT> <BR><FONT face=SimSun color=#000000>如果执行完毕并且没有发生任何错误时，那么就可以将</FONT>这个程序写入 /etc/crontab 当中了！最好是每天执行一次就好了！每次有自动更新之后，程序会主动的寄出一封信给 email 变量后面的邮件主机喔！在 /etc/crontab 里面可以这样写： <BR><B><FONT face=SimSun color=#000066>30 5 * * * root /mybackup/update9/zzgetrpm.sh &gt; /dev/null</FONT></B> <BR>&nbsp;</LI></OL>有了这支程序，呵呵！鸟哥的日字过的可是挺开心的！ ^_^</UL>
<HR width="100%">
<A name=important></A><FONT color=#000099 size=+1>重点回顾</FONT> 
<UL>
<LI>将 Linux 系统上面的套件随时保持在较新的版本，较能够避免被 Cracker 入侵的问题； 
<LI>套件的升级可以透过手动以 RPM 或 Tarball 来升级，也可以透过 Red Hat 的 up2date 以及 Mandrake 的 urpmi 来升级，亦可以透过 apt 服务器来升级； 
<LI>up2date 为 Red Hat 公司释出的网络升级程序，需要透过登录到 Red Hat up2date 主网站注册后，就可以进行 RPM 套件的升级； 
<LI>urpmi 为 Mandrake 公司发展出来的在线升级程序，可以自行选择媒体来进行套件升级； 
<LI>APT 也是一种透过网络提供的辅助来进行套件升级的方法。 </LI></UL>
<HR width="100%">
<A name=reference></A><FONT color=#000099 size=+1>参考资源</FONT> 
<UL>
<LI><FONT color=#000000>台湾计算机危机处理小组(TWCERT)：<A href="http://www.cert.org.tw/" target=_blank>http://www.cert.org.tw/</A></FONT> 
<LI><FONT color=#000000>Mandrake 的官方说明：<A href="http://www.mandrakesecure.net/en/docs.php" target=_blank>http://www.mandrakesecure.net/en/docs.php</A></FONT> 
<LI><FONT color=#000000>Red Hat 的官方说明：<A href="http://www.redhat.com/apps/support/errata/" target=_blank>http://www.redhat.com/apps/support/errata/</A></FONT> 
<LI>Red Hat 的 up2date 升级网站：<FONT color=#000000><A href="http://rhn.redhat.com/network" target=_blank>http://rhn.redhat.com/network</A></FONT> 
<LI><FONT color=#000000>Mandrake 的 urpmi 套件：<A href="http://cvs.mandrakesoft.com/cgi-bin/cvsweb.cgi/soft/urpmi" target=_blank>http://cvs.mandrakesoft.com/cgi-bin/cvsweb.cgi/soft/urpmi</A></FONT> 
<LI><FONT color=#000000>APT 官方网站：<A href="http://apt.freshrpms.net/" target=_blank>http://apt.freshrpms.net/</A></FONT> 
<LI><FONT color=#000000>Rondo 的 APT 实做：<A href="http://163.19.59.1/~linux/student_samba/apt/apt_server.html" target=_blank>http://163.19.59.1/~linux/student_samba/apt/apt_server.html</A></FONT> 
<LI><FONT color=#000000>APT Server：<A href="http://install.opennms.org/apt/" target=_blank>http://install.opennms.org/apt/</A></FONT> </LI></UL>
<HR width="100%">
<A name=FAQ></A><FONT color=#000099 size=+1>课后练习</FONT> 
<UL>
<LI>请依照您的 Linux 系统进行适合的网络套件升级程序(一个步骤一个步骤写下来)，并说明为何您需要选择这样的网络升级程序？ </LI></UL>
<CENTER><FONT color=#3333ff size=+1><A href="http://linux.vbird.org/linux_server/0220upgrade.php" target=_self><FONT face="Times New Roman,Times">Linux </FONT><FONT face=SimSun>网络套件升级</FONT></A></FONT></CENTER>
<HR width="100%">
<FONT face=SimSun color=#000066 size=-1>2002/08/02：第一次完成日期！</FONT> <BR><FONT face=SimSun color=#000066 size=-1>2003/06/29：加入自己写的自动更新 RPM 的<A href="#vbird_zzgetrpmfile"> bash scripts </A>功能！</FONT> <BR><FONT face=SimSun color=#000066 size=-1>2003/07/01：<A href="#up2date">重新编写一些内容介绍</A>，此外，由于 Red Hat 6.x 有点老旧了，已经将 up2date 关于 Red Hat 6.x 以前的数据消除了！</FONT> <BR><FONT face=SimSun color=#000066 size=-1>2003/08/22：加入 <A href="#mandrake">Mandrake 的 urpmi</A> 以及 APT Client 的设定方法</FONT> <BR>
<HR width="100%">
<BR><FONT face=SimSun color=#3333ff size=-1>2002/08/02 以来统计人数</FONT> <BR><IMG height=15 src="58_files/Count[11].gif" width=60 align=middle nosave="">
<HR width="100%">
 
<CENTER><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 nosave=""></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 nosave=""></A> <BR><FONT color=#000066 size=-1>Designed by <A href="mailto:vbird@tsai.adsldns.org">VBird</A> during 2001-2004.&nbsp; Aerosol Lab.</FONT></CENTER></BODY>