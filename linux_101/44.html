<HEAD><TITLE>鸟哥的 Linux 私房菜 -- 连上 Internet 的方法与步骤</TITLE>
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<META content=VBird name=Author>
<META content="Mozilla/4.5 [zh-TW] (WinNT; I) [Netscape]" name=GENERATOR>
<META content="W路卡的安b，cB接上 Internet 的方法介B" name=Description><!-- saved from url=(0022)http://internet.e-mail -->
<STYLE>
   <!--
   body{background-image=url("44_files/VBirdLinux[1].jpg");background-ATTACHMENT=FIXED}
   -->
</STYLE>
</head>
<BODY style="CURSOR: auto" background="44_files/VBirdLinux[11].jpg" nosave="">
<CENTER>
<CENTER><B><FONT color=#3333ff size=+2><FONT face=SimSun>鸟哥的</FONT><FONT face="Times New Roman,Times"> Linux </FONT><FONT face=SimSun>与</FONT><FONT face="Times New Roman,Times"> ADSL </FONT><FONT face=SimSun>私房菜</FONT></FONT></B> <BR><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 nosave=""></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 nosave=""></A> <BR>
<HR width="100%">
</CENTER><FONT color=#3333ff size=+2><A href="http://linux.vbird.org/linux_server/0130internet_connect.php" target=_self><FONT face=SimSun>连上</FONT><FONT face="Times New Roman,Times"> Internet</FONT></A></FONT></CENTER>
<DIV align=right><FONT face=SimSun color=#3333ff size=-1>最近更新日期：2003/09/19</FONT></DIV><FONT face=SimSun color=#3333ff size=-2>　</FONT> 
<TABLE cols=1 width="100%" bgColor=#ffcccc border=1>
<TBODY>
<TR>
<TD><FONT color=#000099 size=-1>呼呼！终于要来到修改 Linux 网络参数的章节了！在前面的 <A href="http://linux.vbird.org/linux_server/0110network_basic.php">网络基础</A> 章节内我们知道了主机要连上 Internet 需要一些正确的网络参数设定，这些设定在 Windows 系统上面的修改则在 <A href="http://linux.vbird.org/linux_server/0120intranet.php">局域网络的架构</A> 里面进行了说明。在这一章当中，我们则主要以固定 IP 的设定方式来修改 Linux 的网络参数，同时，也会介绍如何使用 ADSL 的拨接方式来上网，此外，因为 Cable modem 使用者也不在少数，所以我们也说明一下 Cable modem 在 Linux 下的设定方式喔！</FONT></TD></TR></TBODY></TABLE><FONT color=#000099 size=-2>　</FONT> <BR><FONT color=#000099><FONT size=+1><A href="#config_files">Linux 网络相关设定档案</A></FONT>：</FONT> <BR><FONT color=#000099><FONT size=+1><A href="#NIC">安装网络卡</A></FONT>：</FONT> <BR><FONT color=#000099>　　：<A href="#NIC_compile">手动安装网络卡驱动程序</A>：<A href="#NIC_compile_dmesg">dmesg</A>,</FONT> <BR><FONT color=#000099>　　：<A href="#NIC_test">使用 Private IP 测试网络卡之运作</A>：<A href="#NIC_test_ifconfig">手动设定</A>, <A href="#NIC_test_file">档案设定</A></FONT> <BR><FONT color=#000099 size=+1><A href="#connect">连上 Internet 的方法</A>：</FONT> <BR><FONT color=#000099>　　：<A href="#connect_fix_IP">固定 IP 上网方式</A>：非拨接上网之方式</FONT> <BR><FONT color=#000099>　　：<A href="#connect_cable">Cable Modem 上网方式</A></FONT> <BR><FONT color=#000099>　　：<A href="#connect_adsl">ADSL 拨接上网方式</A></FONT> <BR><FONT color=#000099>　　：<A href="#connect_rp-pppoe">拨接程序 rp-pppoe 讯息错误处理</A></FONT> <BR><FONT color=#000099><A href="#hosts">设定内部保留 IP 与 DNS IP</A>：</FONT> <BR><FONT color=#000099>　　：<A href="#etc_hosts">/etc/hosts</A>,</FONT> <BR><FONT color=#000099>　　：<A href="#etc_resolv.conf">/etc/resolv.conf</A>,</FONT> <BR><FONT color=#000099><FONT size=+1><A href="#problems">无法联机的自我检查几大问题详解</A></FONT>：</FONT> <BR><FONT color=#000099><FONT size=+1><A href="#ex">课后练习</A></FONT>：</FONT> <BR><FONT color=#000099 size=+1><A href="#reference">参考数据</A></FONT> <BR>
<HR width="100%">
<A name=config_files></A><FONT color=#000099 size=+1>Linux 网络相关设定档案</FONT> 
<UL>要开始玩 Linux 网络之前，<FONT color=#000066>请新手务必了解 Linux 网络相关设定档案放置的目录与文件名</FONT>！这真的很重要！因为在 Linux 底下修改 IP 只要动到一个档案即可，修改主机名称也只要一个档案，所以只要将这些文件名称记起来，呵呵！未来在进行网络的测试与修订时，真的会事半功倍～完全不需要什么 linuxconf, webmin 等工具的帮助，真的很简单啦！底下赶紧来说一说与 Linux 网络最相关的几个档案档名与他的用途！ <BR>　 
<UL>
<LI><FONT face=SimSun color=#000099>/etc/sysconfig/network：</FONT> <BR><FONT face=SimSun>这个档案主要的功能在于『<FONT color=#000066>主机名称( HOSTNAME )的修改，启动 Network 与否</FONT>』！在某些版本的 Linux 上面，只要修改过这个档案，可能需要重新启动 Linux ( reboot ) 才能让设定生效。</FONT> <BR><FONT face=SimSun>　</FONT> 
<LI><FONT face=SimSun color=#000099>/etc/sysconfig/network-scrips/ifcfg-ethn：</FONT> <BR><FONT face=SimSun>这个档案的内容即是设定网络卡的参数档案啦！里面可以设定『<FONT color=#000066>network, IP, netmask, broadcast, gateway, 开机时的 IP 取得方式( DHCP, static ), 是否在开机的时候启动</FONT>』等等。至于 ifcfg-ethn 那个 n 是数字啦！如果是第一块网络卡，则文件名称为 <FONT color=#000066>ifcfg-eth0</FONT> ，第二块网络卡为 <FONT color=#000066>ifcfg-eth1</FONT> 以此类推。</FONT> <BR><FONT face=SimSun>　</FONT> 
<LI><FONT face=SimSun color=#000099>/etc/modules.conf：</FONT> <BR><FONT face=SimSun>如果硬件要能动作，当然要核心有支持才行！同时，我们也可以利用外挂的核心模块(可以将他想成是驱动程序)来驱动硬件，而开机时用来设定加载核心模块的档案就是 modules.conf 啦。所以说，这个档案只在核心找不到网络卡的芯片组时才会动用到！</FONT> <BR><FONT face=SimSun>　</FONT> 
<LI><FONT face=SimSun color=#000099>/etc/resolv.conf：</FONT> <BR><FONT face=SimSun>我们在 <A href="http://linux.vbird.org/linux_server/0110network_basic.php">网络基础</A> 里面稍微提到的 DNS 功能是什么？对啦！进行主机名称与 IP 的对应！而 resolv.conf 就是设定 DNS ( 名称解析服务器 ) 的档案，常常有人提到『咦！我已经可以 ping 到外部计算机的公共 IP 了，为何输入网址却无法联机？』通常发生的错误就是这个档案里面的设定不正确啦！请注意！通常这个档案可以输入中华电信的 DNS ( 168.95.1.1 )！</FONT> <BR><FONT face=SimSun>　</FONT> 
<LI><FONT face=SimSun color=#000099>/etc/hosts：</FONT> <BR><FONT face=SimSun>这个档案可以记录计算机的 IP 对应主机的名称或者主机的别名！特别留意的是，在局域网络内有些服务需要反查 Client 的身份，此时就会动用到主机名称对应 IP 的数据。但是因为局域网络内使用私有保留 IP ，当然无法进行 Hostname 对应 IP 的行为，这个时候该服务就会呆呆的等待 30~60 秒～如果可以避过这个反查，或者是直接告诉主机 Hostname 与 IP 的对应，那么就可以节省这个反查的时间了！所以，如此一来省去反查的时间，就可以改善 LAN 内的联机速度了！这个 hosts 就是用来设定 Hostname 对应 IP 的啦！更多的信息请查阅后续服务器章节 DNS 主机的介绍。</FONT> <BR><FONT face=SimSun>　</FONT></LI></UL>与 Linux 的网络设定有关的大概就是这几个档案啦！只要知道这些档案的放置地点，那么差不多网络的设定就不会有太大的问题了！</UL>
<HR width="100%">
<A name=NIC></A><FONT color=#000099 size=+1>安装网络卡：</FONT> 
<OL>网络卡是个硬件啊，所以要驱动他的话，核心就需要有支持该网络卡的芯片组才行。一般来说，目前新版的 Linux 预设可以支持的网络卡芯片组数量已经很完备了，包括大厂的 3COM, Intel 以及初阶的 RealTek, D-Link 等网络卡芯片都已经被支持，所以使用者可以很轻易的设定好他们的网络卡。不过，如果万一不幸核心没有支持该网络卡的话，那么您可以透过 (1)<A href="http://linux.vbird.org/linux_basic/0540kernel.php">重新编译核心</A>或者是 (2)<FONT color=#000066>编译网络卡驱动模块 ( Modules )</FONT>，并且加载该模块，好让核心可以支持网络卡这块硬件啦！但是，重编核心或编译网络卡核心模块都不是简单的工作，所以万一您的网络卡真的不被预设的 Linux 网络芯片所支持，那么鸟哥真的建议直接换一块被 Linux 支持的网络卡吧，例如很便宜的螃蟹卡！免得花了太多时间在硬件确认上面，划不来的！ ^_^ 如果您是照鸟哥推荐的，使用 RLT 8139 芯片 ( RealTek 8139 ) 的网络卡 ( 就是螃蟹卡 ) ，那您应该在安装 Linux 的时候就已经捉到网络卡了，那真是恭喜您啦！因为您的网络卡应该已经可以正常的工作！那如果在安装的时候并没有捉到网络卡呢？该如何是好？那也不用担心，因为您也可以事后才安装网络卡的驱动程序呀！不过，因为 Linux 并不像 Windows 是那样的随插即用，所以需要动一些手术的！ <BR>　 <BR>如果很不幸的，您使用的是比较罕见的一些网络卡，或者是 Linux 核心支持度不太够的网卡，以致于在安装 Linux 时，并无法捉到这张卡，那也不用担心，我们可以使用较为简单的核心模块编译来支持这张网卡。底下我们以 D-Link 530 这一张曾被称为 Linux 恶魔卡的网络卡来进行模块的编译，如果您使用的是其它厂牌的网络卡，其实编译过程与底下的流程是类似的喔！ <BR>　 <BR>
<HR width="100%">
<A name=NIC_compile></A><FONT color=#000099>手动安装网络卡驱动程序</FONT> <BR><FONT color=#000000>　</FONT> <BR>如前面所说的，我们的 Linux 预设核心里面，已经建立了很多的网络卡驱动程序模块了！所以！编译网络卡模块之前的首要工作就是先确认一下您的网络卡的芯片组是否有被支持呢？如果有支持的话『<FONT color=#000066>那么自然不需要编译模块了咯</FONT>』！<FONT color=#000066> D-Link 530</FONT> 这块网络卡的芯片组就是有名的 <FONT color=#000066>via-rhine</FONT> ( 有的时候也写成是 <FONT color=#000066>viarhine</FONT> )，先来找一找有没有这块网卡的模块吧。核心预设的网络卡模块路径在底下可以发现： <BR>　 
<TABLE cols=1 width=550 border=1>
<TBODY>
<TR>
<TD bgColor=#000000><FONT face=SimSun color=#ffffcc size=-1>1. 先察看一下核心版本，因为不同的版本模块放置的路径不同。</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test /root]#</FONT><FONT color=#ffff00> uname -r</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>2.4.20-18.9</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>上面是以 Red Hat 9 为范例， 他的核心是 2.4 版喔。</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>2. 核心模块的路径：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test /root]# </FONT><FONT color=#ffff00>cd /lib/modules/`uname -r`/kernel/drivers/net</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>上面是 2.4 版的路径</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test /root]# </FONT><FONT color=#ffff00>cd /lib/modules/`uname -r`/net</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>上面是 2.2 版的路径，请依照您的实际核心来查询。</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test net]#</FONT><FONT color=#ffff00> ls -l via*</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>-rw-r--r--&nbsp;&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 17892 Sep&nbsp; 7&nbsp; 2001 via-rhine.o</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>太好了！被支援到呢！</FONT></TD></TR></TBODY></TABLE>　 <BR><FONT color=#000000>如果幸运的话，那么您的网络卡就已经被支持，可以跳过编译的过程，直接进行模块的加载吧！万一您连自己的网络卡到底有没有被 Linux 捉到都不知道，那么可以使用底下的方法来测试：</FONT> <BR>　<A name=NIC_compile_dmesg></A> 
<TABLE cols=1 width=550 border=1>
<TBODY>
<TR>
<TD bgColor=#000000><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test /root]#</FONT><FONT color=#ffff00> dmesg | grep eth</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>divert: allocating divert_blk for eth0</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>eth0: RealTek RTL8139 Fast Ethernet at 0xc4844000, 00:50:fc:20:f1:4c, IRQ 10</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>eth0:&nbsp; Identified 8139 chip type 'RTL-8139C'</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>eth0: Setting 100mbps full-duplex based on auto-negotiated partner ability 45e1.</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>divert: allocating divert_blk for eth1</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>eth1: Digital DC21041 Tulip rev 33 at 0xc4852000, 21041 mode, 00:80:C8:5A:87:10, IRQ 9.</FONT></TD></TR></TBODY></TABLE>　 <BR><FONT color=#000000>看到上面的信息了吗？因为我有两张网络卡，一张是螃蟹卡 ( eth0 ) 另一张则是很旧很旧的 10 Mbps 的网络卡，Linux 预设就捉到了！所以我也就不需要重新编译核心模块！不过，万一捉不到呢？亦即上面没有显示出 eth0 或者 eth1 等信息，那就表示 Linux 无法找到该硬件，呵呵！底下就得来编译！</FONT> <BR><FONT color=#000000>　</FONT> 
<OL>
<LI><FONT color=#000099>下载网络卡驱动程序模块：</FONT> <BR>万一不幸的，您的网络卡的驱动模块恰好不在 Linux 的预设支持当中，例如买到了杂牌的卡或是特别想要的卡 ( 例如 D-Link 530 TX ) ，那您就必须要注意这些卡的包装上面是否有提及『支持 Linux 』字样！如果有支持的话就可以买了，因为一定会有驱动程序附在上面的磁盘中的，以鸟哥的 FNW-9702-T 为例，他就有附上一块驱动程序片，里头有一个 linux 目录，里面就是安装驱动程序的原始码啦！如果找不到驱动程序的话，您可以到下面的网站去找找看有没有您需要的驱动程序源文件，当然！最好还是到您买的那张网络卡的公司去下载完整的驱动程序码！例如上面提到的 D-Link 530TX的驱动程序原始码，在底下的友讯网站就有提供下载！ 
<UL>
<LI><FONT face=SimSun color=#000066>Linux Network Drivers：<A href="http://www.scyld.com/network/index.html" target=_blank>http://www.scyld.com/network/index.html</A></FONT> 
<LI><FONT color=#000066>友讯网络卡：<A href="http://tsd.dlink.com.tw/info.nsf/download/LAN+Adapters?openview" target=_blank>http://tsd.dlink.com.tw/info.nsf/download/LAN+Adapters?openview</A></FONT> </LI></UL><FONT color=#000000>　</FONT> 
<LI><FONT color=#000099>确定所需套件存在：</FONT> <BR><FONT color=#000000>在开始编译核心模块之前，因为驱动程序需要配合核心来编译，所以会使用到 kernel source 或者是 kernel header 的数据，此外，也需要编译器 ( compiler ) 的帮助，因此，先确定您的 Linux 系统当中已经有底下的套件存在 ( <I>注：每一个版本的 Linux 套件名称都不相同，我这里是以 Red Hat 9 来做说明，如果您的 Linux 不是 Red Hat 9 ，不要紧，只要看到 kernel 字样有出现，应该就没有问题！</I> )</FONT> 
<UL>
<LI><FONT face=SimSun color=#000066>kernel-source-2.4.20-18.9</FONT> 
<LI><FONT face=SimSun color=#000066>kernel-2.4.20-18.9</FONT> 
<LI><FONT face=SimSun color=#000066>gcc-3.2.2-5</FONT> 
<LI><FONT face=SimSun color=#000066>make-3.79.1-17</FONT> </LI></UL><FONT color=#000000>而由于很多的核心模块预设都是由 /usr/src/linux 这个 kernel source 的目录来取得所需要的信息，偏偏目前很多的 Linux 版本都是使用 /usr/src/linux-2.4 这个目录来连结，所以很多时候您会发现找不到档案的错误讯息，因此，</FONT>您<FONT color=#000000>可以使用这样的方式来进行连结目录的制作：</FONT> 
<TABLE cols=1 width=550 border=1>
<TBODY>
<TR>
<TD bgColor=#000000><FONT face=SimSun color=#ffffcc size=-1>假设核心的 Open source 目录为 /usr/src/linux-2.4.20-18.9</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> cd /usr/src</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test src]# </FONT><FONT color=#ffff00>ln -s linux-2.4.20-18.9 linux</FONT></FONT></TD></TR></TBODY></TABLE>另外，如果没有安装上述的某些套件时，请拿出您的原版光盘，然后以 rpm 将他安装上您的 linux 系统吧！ ^_^ <BR><FONT color=#000000>　</FONT> 
<LI><FONT color=#000099>编译下载的模块</FONT><FONT color=#000000>：</FONT> <BR><FONT color=#000000>上述的工作确认过后，并且由<A href="http://tsd.dlink.com.tw/info.nsf/download/LAN+Adapters?openview" target=_blank>友讯网站</A>下载了驱动程序后 ( </FONT><I><FONT color=#000066>注：我下载的是完整的驱动程序片，也就是 DEF-530TX Shipping Driver 那个驱动程序，不过该档案 530tx.zip 是给 windows 用的，所以还需要在 Windows 底下解压缩后，才会得到 dlkfet-4.24.tar.gz 这个档案龋</FONT></I><FONT color=#000000> ) 就可以准备来进行模块的编译了。</FONT> 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffcc size=-1>1. 将刚刚取得的 dlkfet-4.24.tar.gz 放置到 /tmp 底下</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>cp dlkfet-4.24.tar.gz /tmp</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> cd /tmp</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test tmp]# </FONT><FONT color=#ffff00>tar -zxvf dlkfet-4.24.tar.gz</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test tmp]#</FONT><FONT color=#ffff00> cd dlkfet-4.24</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>2. 开始编译：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test dlkfet-4.24]# </FONT><FONT color=#ffff00>make</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>到此为止，会产生一个档案模块，称为： rhinefet.o</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test dlkfet-4.24]# </FONT><FONT color=#ffff00>cp rhinefet.o&nbsp; \</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt; </FONT><FONT color=#ffff00>/lib/modules/`uname -r`/kernel/drivers/net</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test dlkfet-4.24]# </FONT><FONT color=#ffff00>depmod -a</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>特别留意，上面的路径为 2.4.xx 版本的核心！并且将该模块写入属性相依档案。</FONT></TD></TR></TBODY></TABLE>当然，如果您是使用其它的网络卡，那么所得到的网络卡驱动程序自然就会成为 filename.o 啦！同样将他移动到模块放置的目录后，执行 depmod -a 即可。(<I>注：如果您的模块原始码文件名为 driver.c ，并且没有 Makefile 的辅助，那么使用『<FONT face=SimSun color=#000066>gcc -DMODULE -D__KERNEL__ -O6 -c driver.c</FONT>』来编译出 driver.o 也是可以的作法！</I>) <BR><FONT color=#000000>　</FONT> 
<LI><FONT color=#000099>模块测试：</FONT> <BR><FONT color=#000000>核心模块编译完成之后，当然就得需要测试看看能不能正常的运作了。测试的方法很简单，因为我们已经进行了 <A href="http://linux.vbird.org/linux_basic/0540kernel.php#depmod">depmod</A> -a 了，所以可以直接以 <A href="http://linux.vbird.org/linux_basic/0540kernel.php#modprobe">modprobe </A>来进行模块的加载：</FONT> 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffcc size=-1>1. 加载模块的测试：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>modprobe rhinefet</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>请注意，不要写完整的档名， .o 不需要写，那个 rhinefet 就是</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>刚刚编译出来的 rhinefet.o 咯！</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> lsmod</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Module&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Size&nbsp; Used by&nbsp;&nbsp;&nbsp; Tainted: P</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>rhinefet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 14208&nbsp;&nbsp; 2</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>....(略)....</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>2. 设定开机时加载模块</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>vi /etc/modules.conf</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 加入底下这一行</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>alias eth0 rhinefet</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>3. 也可以重新开机是看看能否正常的启动模块：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffffcc> </FONT><FONT color=#ffff00>sync; sync; reboot</FONT></FONT></TD></TR></TBODY></TABLE>如果可以出现上述的画面，那么表示模块可以被正确的加载，同时，如果模块已经正确的加载了，那么就可以直接写入开机设定档 /etc/modules.conf 了。注意一下，在上面的例子当中，我们使用的是 rhinefet 这个模块，如果您的模块名称并非这个名称，请依照您的实际状态来修改，不要在 /etc/modules.conf 照抄我的设定啊！不然.....不要怪我～ <BR><FONT color=#000000>　</FONT></LI></OL><FONT color=#000000>基本上，这样就已经编译成功，并且也将该模块挂上系统了，接下来就是需要测试一下这个网络卡是否能够正确的来运作啦！</FONT> <BR><FONT color=#000000>　</FONT> <BR>
<HR width="100%">
<A name=NIC_test></A><FONT color=#000099>使用 Private IP 测试网络卡之运作：手动设定, 档案设定</FONT> <BR>　 <BR>要测试网络卡是否能够工作，就是给网络卡一个私有 IP 来测试即可！而测试的方法又很简单，可以直接以手动下达指令的方式来启动网络卡，也可以使用设定文件来设定好网络参数。底下我们以 192.168.1.2 这个私有 IP ，加上 255.255.255.0 这个 C Class 的 netmask 来测试看看，此外，也以 eth0 为预设的 Gatewaydev ( 通讯闸装置 )： <BR>　 
<OL>
<HR width="100%">
<A name=NIC_test_ifconfig></A><FONT color=#000099>手动设定</FONT>： <BR>　 <BR><A href="http://linux.vbird.org/linux_server/0140networkcommand.php#ifconfig">ifconfig</A> 的详细说明我们在下一章再来详谈，这里先谈一谈他的简易用法： <BR>　 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffffcc> </FONT><FONT color=#ffff00>ifconfig eth0 192.168.1.2</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>ifconfig</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Link encap:Ethernet&nbsp; HWaddr 00:10:DC:F1:D8:C5</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inet addr:192.168.1.2&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UP BROADCAST MULTICAST&nbsp; MTU:1500&nbsp; Metric:1</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; collisions:0 txqueuelen:100</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RX bytes:0 (0.0 b)&nbsp; TX bytes:0 (0.0 b)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Interrupt:17 Base address:0xd400 Memory:fb060000-fb060038</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>lo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Link encap:Local Loopback</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RX packets:41739 errors:0 dropped:0 overruns:0 frame:0</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TX packets:41739 errors:0 dropped:0 overruns:0 carrier:0</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; collisions:0 txqueuelen:0</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RX bytes:4252360 (4.0 Mb)&nbsp; TX bytes:4252360 (4.0 Mb)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> ping 192.168.1.2 -c 3</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>PING 192.168.1.2 (192.168.1.2) 56(84) bytes of data.</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>64 bytes from 192.168.1.2: icmp_seq=1 ttl=64 time=0.106 ms</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>64 bytes from 192.168.1.2: icmp_seq=2 ttl=64 time=0.016 ms</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>64 bytes from 192.168.1.2: icmp_seq=3 ttl=64 time=0.013 ms</FONT> 
<P><FONT face=SimSun color=#ffffff size=-1>--- 192.168.1.2 ping statistics ---</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>3 packets transmitted, 3 received, 0% packet loss, time 1998ms</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>rtt min/avg/max/mdev = 0.013/0.045/0.106/0.043 ms</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>ifconfig eth0 down</FONT></FONT></P></TD></TR></TBODY></TABLE>　 <BR>使用 ifconfig 后面加上网络卡代号，并且加上 IP ，就可以设定好网络卡的相关网络参数了！不过，要注意的是那个网络接口有个 lo 的咚咚存在是吧！没错啦！在<A href="http://linux.vbird.org/linux_server/0110network_basic.php">网络基础</A>里面谈到的 loopback 就是这个接口！他的预设 IP 就是 127.0.0.1 咯。再来使用 ping 来测试该网络卡是否能够正常的响应，呵呵！这样就算测试成功了。再来先将网络卡关掉，然后底下再以档案模式的方法来测试一下网络卡！另外， ifconfig 也可以直接修改 IP ，例如上面的案例中，如果在网络卡启动的状态下，想要将 IP 改为 192.168.1.200 ，则下达『<FONT face=SimSun color=#000066>ifconfig eth0 192.168.1.200</FONT> 』即可！ <BR>　 <BR>
<HR width="100%">
<A name=NIC_test_file></A><FONT color=#000099>档案设定</FONT>： <BR>　 <BR>在档案的设定里面，我们会动用到的档案其实只有<FONT color=#000066> /etc/sysconfig/network-scripts/ifcfg-eth0</FONT> ，不过，底下我们连同<FONT color=#000066>通讯闸(Gateway)</FONT>也一同设定妥当，同时更改主机名称，所以还会动用到 /etc/sysconfig/network 这个档案哩！修改一下先： <BR>&nbsp;</OL>
<UL>
<OL>
<LI><FONT face=SimSun color=#000099>设定 /etc/sysconfig/network 档案：</FONT> <BR><FONT face=SimSun>这个档案可以设定主机名称与预设的通讯闸，不过，在某些版本当中，这个档案无法设定 Gateway 呢，所以，不建议在这个档案里面设定 Gateway。主机名称的修改就是在这个档案咯：</FONT> 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>vi /etc/sysconfig/network</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>NETWORKING=yes　　　　　　</FONT><FONT color=#ff6666>　&lt;==是否启动网络，当然是啦！</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>HOSTNAME=test.domain.name　 </FONT><FONT color=#ff6666>&lt;==主机名称，要确定呦！可以随时修改啦！</FONT></FONT></TD></TR></TBODY></TABLE>　 
<LI><FONT face=SimSun color=#000099>设定网络卡参数 /etc/sysconfig/network-scripts/ifcfg-eth0 档案：</FONT> <BR><FONT face=SimSun>这个档案的设定也可以设定的很简单的啦！马上设定看看：</FONT> 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>vi /etc/sysconfig/network-scripts/ifcfg-eth0</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>DEVICE=eth0　　　　　　</FONT><FONT color=#ff6666>　　&lt;==设定装置的名称，这个</FONT><FONT color=#ffff00>要跟文件名称对应</FONT><FONT color=#ff6666>！</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>ONBOOT=yes　　　　　　　　</FONT><FONT color=#ff6666>&lt;==是否在开机的的时候启动网络卡</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>BOOTPROTO=static　　　　　 </FONT><FONT color=#ff6666>&lt;==启动的时候的 IP 取得的协定，这里是固定的，</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　　　　　　　　　　　　　　　如果是 Cable 的话，要改成 dhcp 才行。</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>IPADDR=192.168.1.2　　　　</FONT><FONT color=#ff6666> &lt;==这个就是 IP ！</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>NETMASK=255.255.255.0　　</FONT><FONT color=#ff6666>　&lt;==这个就是子屏蔽网络！</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>NETWORK=192.168.1.0　　　</FONT><FONT color=#ff6666>　&lt;==这个就是该网段的第一个 IP 咯</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>BROADCAST=192.168.1.255　</FONT><FONT color=#ff6666>　&lt;==这个就是最后一个同网段的广播地址！</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>GATEWAY=192.168.1.2　　　　</FONT><FONT color=#ff6666>&lt;==这个就是这块网络卡的通讯闸！</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>#GATEWAYDEV=eth0　　　　　</FONT><FONT color=#ff6666>　&lt;==也可以这么写！</FONT></FONT></TD></TR></TBODY></TABLE>这个档案就是在设定这个网络卡的主要网络参数啦！包括他的网域、IP、子屏蔽网络、软件广播地址及通讯闸等等。要特别留意的是， <FONT color=#000066>GATEWAY 设定的是整个 Linux 系统的 Default Gateway 而不是这块网络卡的 Gateway 喔</FONT>！这个概念得先厘清。因此，如果您有多张网络卡在 linux 系统上面时，也就是您有 ifcfg-eth0, ifcfg-eth1.... 等多个档案，<FONT color=#000066>只要在其中一个档案设定 GATEWAY 即可</FONT>！不要每个档案都设定啊！如果每个档案都设定 gateway 时，在某些版本的 Linux 上面可能会发生问题。但是如果您不是使用固定的 IP 作为 Gateway ，而是使用网络装置作为 Gateway (通常 Router 最常有这样的设定)，那也可以使用 <FONT color=#000066>GATEWAYDEV</FONT> 来设定通讯闸装置呢！相关的网络参数说明请参考 <A href="http://linux.vbird.org/linux_server/0110network_basic.php">网络基础</A> 。 <BR>　 
<LI><FONT face=SimSun color=#000099>启动与关闭网络卡：</FONT> <BR><FONT face=SimSun color=#000000>启用网络卡设定档案的指令是 ifup 与 ifdown：</FONT> 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>/etc/rc.d/init.d/network restart </FONT><FONT color=#ff6666>&lt;==重新启动网络接口</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>ifup 　eth0　</FONT><FONT color=#ff6666>　&lt;==启动 eth0 网络卡&nbsp;</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>ifdown eth0　　</FONT><FONT color=#ff6666>&lt;==关闭 eth0 网络卡</FONT></FONT></TD></TR></TBODY></TABLE>ifup 是启动而 ifdown 是关闭的意思！后面接的是网络卡的代号。 <BR>　 
<LI><FONT face=SimSun color=#000099>检查是否启动了：</FONT> <BR><FONT face=SimSun>检查网络卡是否启动了！就使用 ifconfig 即可：</FONT> 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> ifconfig eth0</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Link encap:Ethernet&nbsp; HWaddr 00:50:FC:22:9C:57</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inet addr:192.168.1.2&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RX packets:5692910 errors:0 dropped:0 overruns:0 frame:0</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TX packets:5914804 errors:0 dropped:0 overruns:0 carrier:0</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; collisions:848 txqueuelen:100</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RX bytes:522002571 (497.8 Mb)&nbsp; TX bytes:2498073183 (2382.3 Mb)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Interrupt:10 Base address:0x6100</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>ping -c 3 192.168.1.2</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>PING 192.168.1.2 (192.168.1.2) from 192.168.1.2 : 56(84) bytes of data.</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>64 bytes from 192.168.1.2: icmp_seq=0 ttl=255 time=318 usec</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>64 bytes from 192.168.1.2: icmp_seq=1 ttl=255 time=213 usec</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>64 bytes from 192.168.1.2: icmp_seq=2 ttl=255 time=217 usec</FONT> 
<P><FONT face=SimSun color=#ffffff size=-1>--- 192.168.1.2 ping statistics ---</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>3 packets transmitted, 3 packets received, 0% packet loss</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>round-trip min/avg/max/mdev = 0.213/0.249/0.318/0.050 ms</FONT></P></TD></TR></TBODY></TABLE>&nbsp;</LI></OL></UL>上述的两种方法中，请特别留意的是，手动以 <A href="http://linux.vbird.org/linux_server/0140networkcommand.php#ifconfig">ifconfig</A> 这个指令来修改 IP 或者是网络卡参数是可行的，您可以在任何时刻手动的修改。不过，如果原先以 <A href="http://linux.vbird.org/linux_server/0140networkcommand.php#ifup">ifup</A> eth0 的方式来启动网络卡之后，再以 ifconfig 来进行 IP 的修改，那么网络的的启动与关闭就得使用 ifconfig 了，不能够使用 ifdown eth0 来关闭了！否则会显示找不到该网络卡的错误讯息喔！反正大原则就是：<FONT color=#000066>先以档案的型态 ifcfg-eth0 来设定好您的网络参数，而如果想要暂时更动网络参数的话，那么就使用 ifconfig 来进行修改，如此一来，未来重新开机之后，还是会以 ifcfg-eth0 的设定为准</FONT>！</OL>
<HR width="100%">
<A name=connect></A><FONT color=#000099 size=+1>连上 Internet 的方法：</FONT> 
<UL>在<A href="http://linux.vbird.org/linux_server/0120intranet.php">局域网络的简易设定</A>里面，我们知道了连上 Internet 的方法有好多种，不过在现今的台湾，主要的联机方法其实是以学术网络、ADSL 固接与拨接、Cable modem 等方式为主，所以底下我们仅针对这三种方式来加以介绍，至于传统的 56 Kbps 拨接则因为速度较慢且使用度越来越低，所以在这里就不多做介绍了。 <BR>　 <BR>
<HR width="100%">
<A name=connect_fix_IP></A><FONT color=#000099><FONT size=+1>固定 IP 上网方式</FONT>： 非拨接上网之方式</FONT> <BR>　 <BR>以固定 IP 来上网的情况大致可以分为两种： <BR>　 
<UL>
<LI><FONT color=#000066>一种是类似学术网络或者是固定制的 ADSL 这些情况，您有『公共 IP』，并且也取得了『公共 IP 的 GATEWAY』了！而您的其它的所有的网络参数也都取得的情况！</FONT> </LI></UL><FONT color=#000066>　</FONT> 
<UL>
<LI><FONT color=#000066>另一种则是保留 IP 的情况，例如在 <A href="http://linux.vbird.org/linux_server/0120intranet.php">局域网络架构</A> 那个章节的 <A href="http://linux.vbird.org/linux_server/0120intranet.php#fig_3">图三</A> 当中，我们的 PC3 是 Linux ，而这个 Linux 的 IP 就是 保留 IP ，并且透过 Linux server 的 NAT 作为 GATEWAY 的情况！( 不知道 NAT 吗？！没关系，以后就知道啦！ )</FONT> </LI></UL>　 <BR>这样清楚了吗？<FONT color=#000066>反正就是要上网的时候，需要取得网络的所有参数就对了</FONT>！底下我们来介绍一下使用固定私有 IP ，并且透过 NAT 主机的私有 IP 接口连上 Internet 的情况： <BR>　 
<UL>
<LI><FONT color=#000099>网络参数的取得：</FONT> <BR>在确定所有的网络参数之前，请先确定您的 <A href="#NIC">网络卡</A> 没有问题之后，再来则是网络联机的问题了！请先确认您的 <A href="http://linux.vbird.org/linux_server/0120intranet.php">网络硬件联机</A> 没有问题喔 ( 这是大前提！ )。这里先说说如果以固定制( 或者是校园网络系统 )的情况之下，您已经知道了您的 IP 与 gateway 的 address 的话，该如何设定以连接 Internet 呢？『<FONT color=#000066>请特别注意，这是给已经知道您的 IP 与 Gateway 的情况下使用的方法，若是使用 ADSL 拨接系统上网的话，这个方法并不适用！</FONT>』，也就是说，如果您的网络联机是类似 GIGA 之类的拨接后才给予一个固定 IP 的话，那么就不能使用这个方法！我们假设我们的网络参数为底下的模样： <BR>　 
<UL>
<LI><FONT face=SimSun color=#000066>IP 为：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.1.13</FONT> 
<LI><FONT face=SimSun color=#000066>Netmask 为：&nbsp;&nbsp; 255.255.255.0</FONT> 
<LI><FONT face=SimSun color=#000066>Network 为：&nbsp;&nbsp; 192.168.1.0</FONT> 
<LI><FONT face=SimSun color=#000066>Broadcast 为： 192.168.1.255</FONT> 
<LI><FONT face=SimSun color=#000066>Gateway 为：&nbsp;&nbsp; 192.168.1.2</FONT> 
<LI><FONT face=SimSun color=#000066>主机名称为：&nbsp;&nbsp; redhat9.vbird.net</FONT> 
<LI><FONT face=SimSun color=#000066>DNS 设定为：&nbsp;&nbsp; 168.95.1.1</FONT> </LI></UL>　 <BR><FONT face=SimSun color=#000000>而连上 Internet 的方法只有几个步骤：</FONT> <BR><FONT face=SimSun color=#000000>　</FONT> <BR><FONT face=SimSun color=#000066>(1)设定主机名称与预设通讯闸；</FONT> <BR><FONT face=SimSun color=#000066>(2)设定网络参数( IP, netmask, broadcast, Network 等等 )；</FONT> <BR><FONT color=#000066><FONT face=SimSun>(3)设定 DNS 服务器的 IP ( </FONT>您<FONT face=SimSun>的 ISP 给的 )；</FONT></FONT> <BR><FONT face=SimSun color=#000066>(4)重新启动网络设备。</FONT> <BR><FONT face=SimSun color=#000000>　</FONT> <BR><FONT face=SimSun color=#000000>这样就够了！您当然可以使用手动指令设定上面的参数，不过需要 ifconfig, route 等等指令的下达，有点讨厌就是了！所以这里我们以档案设定的方式来设定网络参数喔！</FONT> <BR><FONT face=SimSun color=#000000>　</FONT> 
<OL>
<LI><FONT face=SimSun color=#000099>/etc/sysconfig/network ( 设定主机名称与 default gateway )</FONT> 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>vi /etc/sysconfig/network</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>NETWORKING=yes</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>HOSTNAME=redhat9.vbird.net</FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>　</FONT> 
<LI><FONT face=SimSun color=#000099>/etc/sysconfig/network-scripts/ifcfg-eth0 ( 设定网络卡参数 )</FONT> 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> vi /etc/sysconfig/network-scripts/ifcfg-eth0</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>DEVICE=eth0</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>ONBOOT=yes</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>BOOTPROTO=static</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>IPADDR=192.168.1.13</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>NETMASK=255.255.255.0</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>NETWORK=192.168.1.0</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>BROADCAST=192.168.1.255</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>GATEWAY=192.168.1.2</FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>　</FONT> 
<LI><FONT face=SimSun color=#000099>/etc/resolv.conf ( 设定 DNS 主机的 IP )</FONT> 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>vi /etc/resolv.conf</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>nameserver 168.95.1.1</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>nameserver 139.175.10.20</FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>我们以中华电信与 SeedNet 在南部的 DNS 主机之 IP 作为设定的方式！请注意一下，如果您不知道</FONT>您<FONT face=SimSun>的最接近的 DNS 主机的 IP ，那么直接输入 nameserver 168.95.1.1 这个中华电信的 DNS 主机即可！</FONT> <BR><FONT face=SimSun>　</FONT> 
<LI><FONT face=SimSun color=#000099>重新启动网络设定：</FONT> <BR><FONT face=SimSun><FONT color=#000000>因为我们更动过 /etc/sysconfig/network 这个档案，所以最好以『network restart』来启动较好，</FONT><FONT color=#000066>有时候甚至需要 reboot 才能让主机名称生效呢</FONT><FONT color=#000000>！不过，如果仅是要测试网络卡的话，使用 ifup 即可！</FONT></FONT> 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> /etc/rc.d/init.d/network restart</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>ifdown eth0</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> ifup&nbsp;&nbsp; eth0</FONT></FONT></TD></TR></TBODY></TABLE>到这一步骤就算成功啦！使用 ping 试看看能否成功喔！ <BR><FONT face=SimSun color=#000000>　</FONT></LI></OL></LI></UL><FONT face=SimSun color=#000000>使用固定 IP 的上网方式设定其实较为简便，这些步骤要记熟啊！因为未来会常常做这方面的操作喔！</FONT> <BR><FONT face=SimSun color=#000000>　</FONT> <BR>
<HR width="100%">
<A name=connect_cable></A><FONT color=#000099 size=+1>Cable Modem 上网方式</FONT> <BR><FONT face=SimSun color=#000000>　</FONT> <BR>在 Linux 上设定以 Cable 魔电( Modem )来上网是最简单的事了！因为他是透过所谓的 DHCP 协议来直接分配 IP 与相关的网络参数给 Linux 的，所以，我们几乎所有的网络参数都不需要设定呢！只要设定启动网络卡时候，选择的启动协议为 dhcp 就可以了！不过，如果主机端没有给我们 DNS 的 IP 与主机名称的时候，还是需要设定的啦！ ^_^ <BR>　 
<OL>
<LI><FONT face=SimSun color=#000099>/etc/sysconfig/network ( 设定主机名称与 default gateway )</FONT> 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>vi /etc/sysconfig/network</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>NETWORKING=yes</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>HOSTNAME=redhat9.vbird.net</FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>　</FONT> 
<LI><FONT face=SimSun color=#000099>/etc/sysconfig/network-scripts/ifcfg-eth0 ( 设定网络卡参数 )</FONT> 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> vi /etc/sysconfig/network-scripts/ifcfg-eth0</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>DEVICE=eth0</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>ONBOOT=yes</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>BOOTPROTO=dhcp　</FONT><FONT color=#ff6666>　&lt;==这一行设定正确即可！下面的四个网络参数没有用！</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　　　　　　　　　　需要留意的是，在 Openlinux 里面，这里的设定</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ff6666>　　　　　　　　　　为 </FONT><FONT color=#ffffcc>DYNAMIC=dhcp</FONT><FONT color=#ff6666> 喔！</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>IPADDR=192.168.1.13</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>NETMASK=255.255.255.0</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>NETWORK=192.168.1.0</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>BROADCAST=192.168.1.255</FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>　</FONT> 
<LI><FONT face=SimSun color=#000099>/etc/resolv.conf ( 设定 DNS 主机的 IP )</FONT> 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> vi /etc/resolv.conf</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>nameserver 168.95.1.1</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>nameserver 139.175.10.20</FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>这个设定<FONT color=#000066>有时候会被主动的改变</FONT>，这是因为来自于 dhcp 主机的设定所致！所以，如果被改变时，请不要讶异！详细的 DHCP 说明请参考后面章节的 <A href="http://linux.vbird.org/linux_server/0340dhcp.php">DHCP 服务器设定</A>喔！</FONT> <BR><FONT face=SimSun>　</FONT> 
<LI><FONT face=SimSun color=#000099>重新启动网络设定：</FONT> 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> /etc/rc.d/init.d/network restart</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>ifdown eth0</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>ifup&nbsp;&nbsp; eth0</FONT></FONT></TD></TR></TBODY></TABLE>当然，直接 reboot 也是可以啦！</LI></OL>　 <BR>设定 Cable modem 就是这么简单喔！ <BR>　 <BR>
<HR width="100%">
<A name=connect_adsl></A><FONT color=#000099 size=+1>ADSL 拨接上网方式</FONT> <BR>　 <BR>好了，终于提到最热门的 ADSL 拨接制的上网方式！嗯！来谈一谈怎么在 Linux 上拨接上网吧！在 Linux 系统中，要以 ADSL 连上 Internet 是一件很简单的事情，使用 <A href="http://www.roaringpenguin.com/pppoe/" target=_blank>rp-pppoe ( http://www.roaringpenguin.com/pppoe/ )</A> 软件就可以进行拨接了！安装也很方便喔！再来要注意的是，在目前的 Linux 版本当中，由于强调桌上型计算机的便利性，所以很多版本的 Linux 都取消了文字接口下的 ADSL 拨接指令，例如 Red Hat 新版的 Linux 。所以在预设的状态下，我们仅能以图形接口启动 ADSL ，这真的很讨厌，因为我们的主机就是不想要启用 X Window 的啊！怎么办？没关系，我们可以透过重新安装 rp-pppoe 就行啦！我们提过在 Linux 的安装方式主要有 <A href="http://linux.vbird.org/linux_basic/0520rpmtarball.php">RPM 与 Tarball</A> 两种方式，目前鸟哥已经成功的在 Red Hat 7.2 上面安装 <A href="http://linux.vbird.org/download/index.php#rp-pppoe">rp-pppoe-2.6-5.src.rpm</A> 这个版本的 rp-pppoe ！然而由于很多时候 RPM 有相依属性的问题，因此我们也尝试以 Tarball 来安装一下 rp-pppoe 吧！( 注：如果依旧无法以 RPM 安装 rp-pppoe 时，请直接以 Tarball 来安装吧！ ) <BR>　 <BR>此外，需要特别留意的是，原本 Linux 主机上面就会有 eth0 这个网络卡接口，不过在使用 rp-pppoe 拨接之后，会多产生了一个对外的接口，称为 ppp0 的这个网络联机接口，因此，您将具有三个网络接口喔！分别是： <BR>　 
<OL>
<LI><FONT color=#000066>内部循环测试用的lo接口；</FONT> 
<LI><FONT color=#000066>网络卡 eth0 这个接口；</FONT> 
<LI><FONT color=#000066>拨接之后产生的经由 ISP 对外连接的 ppp0 接口。</FONT> </LI></OL>　 <BR>而由于这三个接口的 IP 网段都不相同，因此，请『<FONT color=#000066>特别留意通讯闸的设定</FONT>！』一般而言，在 ADSL 拨接的状态下，前面提到的几个档案的设定内容中，『<FONT color=#000066>都不要设定GATEWAY及GATEWAYDEV这两个参数</FONT>』，因为 rp-pppoe 会自动由 ISP 取得这方面的数据，如果您设定了GATEWAY，反而会造成系统无法联机出去的状态喔！ <BR>　 <BR>因为拨接之后会产生两个实体接口，分别为 eth0 与 ppp0 ，所以底下我们将针对两个接口进行设定。在 eth0 的设定中，我们选择 192.168.1.0/255.255.255.0 并且 IP 为 192.168.1.2 ，至于 ppp0 则完全由 rp-pppoe 所产生。 <BR>　 <BR>设定与安装的步骤简单说明如下： <BR>　 
<OL>
<LI><FONT face=SimSun color=#000099>重新设定网络参数档案；</FONT> 
<LI><FONT face=SimSun color=#000099>查看是否安装了 rp-pppoe，移除 rp-pppoe；</FONT> 
<LI><FONT face=SimSun color=#000099>安装 rp-pppoe ：</FONT> 
<UL>
<LI><FONT face=SimSun color=#000099>用 rpm 安装；</FONT> 
<LI><FONT face=SimSun color=#000099>用 Tarball 安装；</FONT> </LI></UL>
<LI><FONT face=SimSun color=#000099>设定 rp-pppoe ：</FONT> 
<LI><FONT face=SimSun color=#000099>ADSL 拨接连线</FONT> </LI></OL>　 <BR>好了！开始一步一步来进行安装与设定及联机的步骤吧！ <BR>　 
<OL>
<LI><B><FONT face=SimSun color=#000099>重新设定网络参数档案：</FONT></B> <BR><FONT face=SimSun><FONT color=#000000>由于我们是使用拨接的方式来连上 Internet 的，所以 </FONT><FONT color=#000066>default gateway</FONT><FONT color=#000000> 是由 rp-pppoe 拨接之后 ISP 直接传送数据到我们 Linux 主机上的，因此，在您的 Linux 系统当中，千万不要设定 GATEWAY 或者是 GATEWAYDEV 喔！( 这个情况我们会在 <A href="http://linux.vbird.org/linux_server/0230router.php">Linux Router</A> 的设定当中说明 )！</FONT></FONT> 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffff99 size=-1>1. 取消预设通讯闸</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>vi /etc/sysconfig/network-scripts/ifcfg-eth0</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>DEVICE=eth0</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>ONBOOT=yes　　　</FONT><FONT color=#ff6666>　&lt;==若您需要 eth0 帮您建立内部私有网域时，这里可以写成 yes</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　　　　　　　　　　但若不需要内部网络时，这一行请直接写成 no ，反正拨接</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　　　　　　　　　　之后网络卡会自动被启动！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>BOOTPROTO=static</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>IPADDR=192.168.1.2</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>NETMASK=255.255.255.0</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>NETWORK=192.168.1.0</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>BROADCAST=192.168.1.255</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> /etc/rc.d/init.d/network restart</FONT></FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>　</FONT> 
<LI><B><FONT face=SimSun color=#000099>移除原本的 rp-pppoe 套件：</FONT></B> <BR><FONT face=SimSun>如同前面说的，新版的 rp-pppoe 很多都仅支持图形接口的拨接程序，所以我们这里直接将 rp-pppoe 移除 (或者根本不要使用预设的 rp-pppoe 套件)，然后再重新安装官方网站的 rp-pppoe 套件说：</FONT> 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>rpm -qa | grep rp-pppoe</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>rp-pppoe-3.5-2　　　</FONT><FONT color=#ff6666>　&lt;==看来是已经安装了！只好移除！</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>rpm -e rp-pppoe</FONT></FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>　</FONT> 
<LI><B><FONT face=SimSun color=#000099>安装 rp-pppoe ：</FONT></B> <BR><FONT face=SimSun>安装 rp-pppoe 的方式有两种，可以使用 rpm 与 tarball 的方式来分别安装，不过，只要选择一种来安装就可以啦！</FONT> <BR><FONT face=SimSun>　</FONT> 
<UL>
<LI><FONT face=SimSun color=#000099>RPM 安装 rp-pppoe：</FONT> <BR><FONT face=SimSun>如果您下载的是 SRPM 的档案的话，那么就需要先经过编译才行。详细的编译及安装步骤如下表所示：( <I>请注意，编译的过程也需要 gcc 之类的 compiler ，如果没有在 Install 的时候选择时，在编译个过程中可能会有出现错误，请自行由 Linux 原版光盘安装吧！</I> )</FONT> <BR><FONT face=SimSun>　</FONT> 
<OL>
<LI><FONT face=SimSun color=#000099>下载 rp-pppoe ：</FONT> <BR><FONT face=SimSun>rp-pppoe 的下载网站在：『<A href="http://www.roaringpenguin.com/pppoe/#download" target=_blank>http://www.roaringpenguin.com/pppoe/#download</A>』，底下我是以rp-pppoe-3.5-1.src.rpm 这个档案进行介绍的。如果</FONT>您<FONT face=SimSun>的主机尚未开放任何的服务时，</FONT>您<FONT face=SimSun>可以使用软盘来下载 rp-pppoe ，因为 rp-pppoe 的档案很小啦！还不到 200 KB 呢！所以软盘就可以！如何使用软盘呢？</FONT> 
<UL>
<LI><FONT face=SimSun color=#000066>先使用软盘将下载下来的 rp-pppoe copy 到软盘上；</FONT> 
<LI><FONT face=SimSun color=#000066>将软盘放置于 Linux 主机的软盘槽中；</FONT> 
<LI><FONT face=SimSun color=#000066>在 Linux 底下使用 df 这个指令，看看有没有类似底下的这一行：</FONT> <BR><B><FONT face=SimSun color=#000066>/dev/fd0　　　　　1423　　　0　　1423　0%　/mnt/floppy</FONT></B> <BR><FONT face=SimSun color=#000066>如果有的话，请使用『 umount /mnt/floppy 』，如果无，则跳到下一步；</FONT> 
<LI><FONT face=SimSun color=#000066>使用『 ls -l /mnt 』看看有没有 floppy 这个目录：</FONT> <BR><FONT face=SimSun color=#000066>如果有则下一步，若无则『 mkdir /mnt/floppy 』；</FONT> 
<LI><FONT face=SimSun color=#000066>使用『 mount -t vfat /dev/fd0 /mnt/floppy 』将软盘挂上去！</FONT> 
<LI><FONT face=SimSun color=#000066>使用『 cp /mnt/floppy/rp* /root 』将档案 copy 到 /root 这个目录下；</FONT> 
<LI><FONT face=SimSun color=#000066>使用『 cd /root 』将目录转到 root 底下。</FONT> </LI></UL><FONT face=SimSun>　</FONT> 
<LI><FONT face=SimSun color=#000099>编译及安装 rp-pppoe ：</FONT> 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffcc size=-1>1. 编译 SRPM：&nbsp;</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>rpm --rebuild rp-pppoe-3.5-1.src.rpm</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>rpmbuild --rebuild rp-pppoe-3.5-1.src.rpm</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 注：在 Red Hat 7.3 以前， rpm 的指令使用 rpm ，但是在 Red Hat 8&nbsp;</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 以后， SRPM 的重制指令已经独立至 rpmbuild ！所以请选择</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 适合您的 Linux 版本喔！</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>.........</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Wrote: /usr/src/redhat/RPMS/i386/rp-pppoe-3.5-1.i386.rpm</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>.........</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>在编译时，最后的结果(如果没有错误)会显示上面那个样子！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>也就是说，您的编译完成的档案就放在上面！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>2. 安装 rp-pppoe :</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>cd /usr/src/redhat/RPMS/i386&nbsp;</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test i386]#</FONT><FONT color=#ffff00> rpm -ivh rp-pppoe-3.5-1.i386.rpm&nbsp;</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Preparing...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ########################################### [100%]</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp; 1:rp-pppoe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ########################################### [100%]</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test i386]# </FONT><FONT color=#ffff00>rpm -q rp-pppoe</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>rp-pppoe-3.5-1</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>这样就安装完毕了！简单吧！如果不相信，可以查询看看！&nbsp;</FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>安装完毕之后，会在 /usr/sbin 当中多了 adsl-start, adsl-stop, adsl-setup, adsl-status 等档案，至于设定档则在 /etc/ppp 当中！如果</FONT>您<FONT face=SimSun>要详细的看每一个指令的用法，可以使用 man adsl-setup ....等指令名称来观察！我们这里仅提供设定的方法及执行的方法！</FONT> <BR><FONT face=SimSun>　</FONT></LI></OL>
<LI><FONT face=SimSun color=#000099>Tarball 安装 rp-pppoe ：</FONT> <BR><FONT face=SimSun>嗯！由于 RPM 可能会有相依属性的问题！因此，如果</FONT>您<FONT face=SimSun>的系统上面无法安装 rp-pppoe 的话，那么就直接以 Tarball 的方式来安装 rp-pppoe 吧！目前 (2003/08/18) 最新的 rp-pppoe 套件为 <A href="http://linux.vbird.org/download/index.php#rp-pppoe">rp-pppoe-3.5.tar.gz</A> 这个档案：</FONT> 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffcc size=-1>1. 解压缩！</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> mv rp-pppoe-3.5.tar.gz /usr/local/src</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>cd /usr/local/src</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test src]# </FONT><FONT color=#ffff00>tar -zxvf rp-pppoe-3.5.tar.gz</FONT></FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>2. 侦测系统与编译执行文件：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test src]# </FONT><FONT color=#ffff00>cd rp-pppoe-3.5/src</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test src]# </FONT><FONT color=#ffff00>./configure --prefix=/usr/local</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test src]# </FONT><FONT color=#ffff00>make; make install</FONT></FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>安装方面很简易吧！这样就妥当！准备来给他设定一下吧！</FONT> <BR><FONT face=SimSun>　</FONT></LI></UL>
<LI><B><FONT face=SimSun color=#000099>设定 rp-pppoe ：</FONT></B> <BR><FONT face=SimSun>rp-pppoe 的设定非常简单，只要透过 /usr/sbin/adsl-setup ( 若为 Tarball 安装的话，那么就在 /usr/local/sbin /adsl-setup  ) 这个程序来设定就 OK 了！</FONT> 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>/usr/sbin/adsl-setup&nbsp;</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt;&gt;&gt; Enter your PPPoE user name (default bxxxnxnx@sympatico.ca): </FONT><FONT color=#ffff00>T0123456</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>这个时候请输入您在 ADSL 的账号，不同的 ISP 有不同的设定方式呦！请特别注意！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>a. 如果是 seednet 的话，应该有点像这样==&gt; T0123456&nbsp;</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>b. 如果是 Hinet 的话，应该有点像这样====&gt; yourname@hinet.com.tw(连同 host 也要写)</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&gt;&gt;&gt; Enter the Ethernet interface connected to the ADSL modem&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>For Solaris, this is likely to be something like /dev/hme0.&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>For Linux, it will be ethn, where 'n' is a number.&nbsp;</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>(default eth0): </FONT><FONT color=#ffff00>eth0</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>因为我们使用 eth0 联机的呀！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt;&gt;&gt; Enter the demand value (default no):</FONT><FONT color=#ffff00> &lt;=按下 Enter 即可</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>这里按 enter 不用设定就好了！&nbsp;</FONT> 
<P><FONT face=SimSun size=-1><FONT color=#ffffff>&gt;&gt;&gt; Enter the DNS information here:</FONT><FONT color=#ffff00> 168.95.1.1</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt;&gt;&gt; Enter the secondary DNS server address here:</FONT><FONT color=#ffff00> 139.175.10.20</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>这里要您输入惯用的 DNS 主机：</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>若使用 hinet 的话，可以打入 168.95.1.1</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>若使用 seednet 的时候，可以打入 139.175.10.20&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt;&gt;&gt; Please enter your PPPoE password:&nbsp;</FONT><FONT color=#ffff00> &lt;==输入您的密码</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt;&gt;&gt; Please re-enter your PPPoE password:&nbsp;</FONT><FONT color=#ffff00> &lt;==再输入一次</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>这里就输入您的 ADSL 密码啦，要输入两次喔！&nbsp;</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>The firewall choices are:&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>0 - NONE: This script will not set any firewall rules.&nbsp; You are responsible&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ensuring the security of your machine.&nbsp; You are STRONGLY&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; recommended to use some kind of firewall rules.&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>1 - STANDALONE: Appropriate for a basic stand-alone web-surfing workstation&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>2 - MASQUERADE: Appropriate for a machine acting as an Internet gateway&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for a LAN&nbsp;</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt;&gt;&gt; Choose a type of firewall (0-2): </FONT><FONT color=#ffff00>0&nbsp;</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>这里要您选择防火墙的形式，通常我是不设火墙的，&nbsp;</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>所以直接选 0 就对了！ 注意：选了防火墙有的时候反而会造成无法联机成功！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>反正未来我们会手动设定防火墙，所以这里不设定没有关系！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Start this connection at boot time</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Do you want to start this connection at boot time?</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Please enter no or yes.</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>yes</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>如果想要一开机就自动启动 ADSL 联机的话，这里可以填入 yes啦！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Ethernet Interface: eth0&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>User name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T0123456&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Activate-on-demand: No&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Primary DNS:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 168.95.1.1</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Secondary DNS:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 139.175.10.20&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Firewalling:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NONE&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt;&gt;&gt; Accept these settings and adjust configuration files (y/n)?</FONT><FONT color=#ffff00>y&nbsp;</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>接下来将您的设定作一个整合结果输出，如果没有问题的话，</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>输入 y 之后就完成设定啦！&nbsp;</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>基本上，设定完成之后以下的档案会被自动改变，</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>有影响的是 resolv.conf 这个档案，您可以手动改变这个档案喔！</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Adjusting /etc/ppp/pppoe.conf&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Adjusting /etc/resolv.conf&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp; (But first backing it up to /etc/resolv.conf-bak)&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Adjusting /etc/ppp/pap-secrets and /etc/ppp/chap-secrets&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp; (But first backing it up to /etc/ppp/pap-secrets-bak)&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp; (But first backing it up to /etc/ppp/chap-secrets-bak)</FONT></P></TD></TR></TBODY></TABLE><FONT face=SimSun>哈哈！这样设定就成功啦！很简单吧！唯一需要注意的是在上面的 <FONT color=#000066>username</FONT> 那个地方，千万注意<FONT color=#000066>，因为 hinet 与 seednet 的设定是不一样的</FONT>！千万小心呢！否则会无法连上线呦！此外，由于我们在未来还会有 firewall 的建置，所以这里不太需要使用到防火墙啦！就先关闭他吧 ( 选 0 ) ！否则也可能无法连上 Internet 呦！(注：上面那个 T0123567 以及密码都是向 ISP 申请的，不是自己随便设定的喔！不要搞错了！)另外，注意一下，我们上面使用 adsl-setup 的设定，其实最主要是修改两个档案，分别是 /etc/ppp/pppoe.conf 这个主要设定档，以及 /etc/ppp/chap-secrets 这个密码储存文件！仔细去察看一下 chap-secrets 这个档案的内容，您就可以知道您的密码是否输入错误了！ ^_^</FONT> <BR><FONT face=SimSun>　</FONT> 
<LI><B><FONT face=SimSun color=#000099>连上 Internet 啦！</FONT></B> <BR><FONT face=SimSun>怎么拨接呢？简单的很，直接下达 adsl-start 即可！</FONT> 
<TABLE cols=1 width=400 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> adsl-start</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>....Connect!</FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>这样就是显示连上 Internet 啦！通常比较容易出问题的地方在于硬件的联机情况，请先确认所有的硬件联机没有问题喔！通常，如果</FONT>您<FONT face=SimSun>使用小乌龟 ( ATU-R ) 时，请使用跳线连接网络卡与 ATU-R。另外一个容易出错的地方在于输入的账号与密码，账号与密码都是</FONT>您<FONT face=SimSun>的 ISP 给</FONT>您<FONT face=SimSun>的，并且注意大小写(可以到 /etc/ppp/chap-secrets 察看一下是否设定错误？)。</FONT> <BR><FONT face=SimSun>　</FONT> 
<LI><B><FONT color=#000099><FONT face=SimSun>查看</FONT>您<FONT face=SimSun>的 IP 啦！</FONT></FONT></B> <BR><FONT face=SimSun>那如何知道</FONT>您<FONT face=SimSun>的 IP 呢？呵呵！就使用 ifconfig 呀！</FONT> 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>ifconfig ppp0</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>ppp0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Link encap:Point-to-Point Protocol&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inet addr:211.74.249.38&nbsp; P-t-P:172.16.11.8&nbsp; Mask:255.255.255.255&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UP POINTOPOINT RUNNING NOARP MULTICAST&nbsp; MTU:1492&nbsp; Metric:1&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RX packets:8356088 errors:0 dropped:0 overruns:0 frame:0&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TX packets:8532063 errors:0 dropped:0 overruns:0 carrier:0&nbsp;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; collisions:0 txqueuelen:10</FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>在上表中显示，ppp0 ( 就是 ADSL 的 ISP 给</FONT>您<FONT face=SimSun>的公共 IP ) 的网址是 211.74.249.38。</FONT> <BR><FONT face=SimSun>　</FONT> 
<LI><B><FONT face=SimSun color=#000099>自动侦测 ppp0 的拨接状态：</FONT></B> <BR><FONT face=SimSun>基本上，目前的 rp-pppoe 已经都设定好了断线后会自动拨接的模式了，因此我们大可不用太担心，不过，如果</FONT>您<FONT face=SimSun>还是很担心会断线后无法自动拨接出去，那么可以在 /etc/crontab 加入这一行：</FONT> 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> vi /etc/crontab</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>.......</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>01-59/3 * * * * root /usr/sbin/adsl-start&nbsp; &gt; /dev/null 2&gt;&amp;1</FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>在上面的式子当中，如果</FONT>您<FONT face=SimSun>看不懂的话，那就表示『</FONT>您<FONT face=SimSun><FONT color=#000066>需要再将 <A href="http://linux.vbird.org/linux_basic/0320bash.php">BASH Shell</A> 学一学了</FONT>』！ ^_^</FONT> <BR><FONT face=SimSun>　</FONT></LI></OL>
<HR width="100%">
<A name=connect_rp-pppoe></A><FONT color=#000099>拨接程序 rp-pppoe 讯息错误处理</FONT> <BR>　 <BR>或许您会发现使用 rp-pppoe 拨接之后，您的 <FONT color=#000066>/var/log/messages</FONT> 老是出现这样的讯息： <BR>　 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> more /var/log/messages</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>May 10 18:02:22 testing pppoe[8527]: Bogus PPPoE length field (50)</FONT></TD></TR></TBODY></TABLE><FONT face=SimSun>　</FONT> <BR>这是什么问题啊？在 RP-PPPOE 的官方讨论区上面提过，这个问题是由于 ISP 提供的讯息长度超过 rp-pppoe 预设的检查长度才会发生的一个警告讯息，事实上这个讯息并不重要，不用理会他也没有关系，不会影响到 Internet 的运作。但是，这样的讯息在 /var/log/messages 里面每一分钟就出现一次，实在很讨厌！怎么办，可以将他拿掉吗？！当然可以！您可以下载新的 Tarball 来重新编译过！步骤是这样的： <BR>　 
<OL>
<LI>到下面的网站去下载新的 Tarball (我这里以 3.5 为例！) <BR><FONT color=#000066><A href="http://www.roaringpenguin.com/pppoe/#download" target=_blank>http://www.roaringpenguin.com/pppoe/#download</A></FONT> 
<LI>在 /usr/local/src底下解开该档案，则会造成 /usr/local/src/rp-pppoe-3.5 这个目录 
<LI>到 /usr/local/src/rp-pppoe-3.5/src 底下去，修改这四个档案： 
<UL>
<LI><FONT color=#000066>discovery.c</FONT> 
<LI><FONT color=#000066>pppoe.c</FONT> 
<LI><FONT color=#000066>pppoe-server.c</FONT> 
<LI><FONT color=#000066>relay.c</FONT> </LI></UL>找到这四个档案的内容如下代码： 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffff size=-1>&nbsp; /* Check length */</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp; if (ntohs(packet.length) + HDR_SIZE &gt; len) {</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; syslog(LOG_ERR, "Bogus PPPoE length field (%u)",</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (unsigned int) ntohs(packet.length));</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp; }</FONT></TD></TR></TBODY></TABLE>将他修改成为： 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp; /* Check length */</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp; if (ntohs(packet.length) + HDR_SIZE &gt; len) {</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* syslog(LOG_ERR, "Bogus PPPoE length field (%u)",</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (unsigned int) ntohs(packet.length)); */</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp; }</FONT></TD></TR></TBODY></TABLE>请注意，上面每个档案都有多个同样的字符串，请依序一个一个都修改掉才行！还没完喔！再到 pppoe.c 找到底下的字眼： 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp; if (plen + HDR_SIZE &gt; len) {</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; syslog(LOG_ERR, "Bogus length field in session packet %d (%d)",</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (int) plen, (int) len);</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp; }</FONT></TD></TR></TBODY></TABLE>请将他改成： 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp; if (plen + HDR_SIZE &gt; len) {</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* syslog(LOG_ERR, "Bogus length field in session packet %d (%d)",</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (int) plen, (int) len); */</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp;&nbsp; }</FONT></TD></TR></TBODY></TABLE>
<LI>然后就可以开始这样做： 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffff size=-1>cd /usr/local/src/rp-pppoe-3.5/src</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>./configure</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>make</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>make install</FONT></TD></TR></TBODY></TABLE>
<LI>如果一切都可以成功的进行，那么就可以： 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffff size=-1>adsl-stop</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>adsl-start</FONT></TD></TR></TBODY></TABLE>&nbsp;</LI></OL>这个简单的步骤应该可以将您的问题讯息克服了吧！ ^_^</UL>
<HR width="100%">
<A name=hosts></A><FONT color=#000099>设定内部保留 IP 与 DNS IP： /etc/hosts, /etc/resolv.conf,</FONT> 
<UL>在新闻群组或者是BBS上面最常听到的就是这个问题啦： <BR>　 
<UL>
<LI><FONT color=#000066>咦！我的ADSL已经拨接上了，使用telnet IP也可以正确的连上BBS，但是为什么就是无法使用『telnet 网址』的方式连上Internet呢？</FONT> </LI></UL><FONT color=#000066>　</FONT> 
<UL>
<LI><FONT color=#000066>我在我的虚拟网域内有几部计算机，这几部计算机明明都是在同一个网域之内，而且系统</FONT></LI></UL></UL></BODY>