<HEAD><TITLE>鳥哥的 Linux 私房菜 -- up2date 升級 RPM</TITLE>
<META http-equiv=Content-Type content="text/html; charset=big5">
<META content="Mozilla/4.5 [zh-TW] (WinNT; I) [Netscape]" name=GENERATOR>
<META content="strart 101" name="Microsoft Theme">
<META content="tl, default" name="Microsoft Border">
<META content=VBird name=Author>
<STYLE>
      <!--
      body{background-image=url("102_files/VBirdLinux[1].jpg");background-attachment=fixed}
      -->
   </STYLE>
</head>
<BODY background="102_files/VBirdLinux[1].jpg" nosave>
<CENTER><B><FONT color=#3333ff><FONT size=+2><FONT face=標楷體>鳥哥的</FONT><FONT face="Times New Roman,Times"> Linux </FONT><FONT face=標楷體>與</FONT><FONT face="Times New Roman,Times"> ADSL </FONT><FONT face=標楷體>私房菜</FONT></FONT></FONT></B> <BR><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 NOSAVE></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 NOSAVE></A> <BR>
<HR width="100%">
</CENTER><FONT color=#3333ff><FONT size=+2><FONT face=標楷體>以 </FONT><FONT face="Times New Roman Baltic">up2date</FONT><FONT face=標楷體> 使用實例</FONT></FONT></FONT> 
<DIV align=right><FONT face=新細明體><FONT color=#3333ff><FONT size=-1>最近更新日期：2002/01/01</FONT></FONT></FONT></DIV>
<HR width="100%">

<UL><FONT color=#000099>前言</FONT><FONT color=#000000>：</FONT></UL>
<UL>
<DT><FONT color=#000000>我們都曉得在 Windows 底下有個 update 的選項，在一些防毒軟體的附屬功能中，由於病毒隨時在變種，所以病毒碼也要常常線上更新（Live Update），那麼你曉不曉得 Red Hat Linux 也有線上更新的功能呢？呵呵！答案是有的，那就是 </FONT><FONT color=#3333ff>up2date</FONT><FONT color=#000000> 這個套件了！這個東西很好用的，你只要註冊好了之後，就可以使用 Red Hat 提供的線上更新資訊來更新你的 Red Hat 囉！不過，有一點必須要曉得，由於線上更新主要為更新 rpm 的版本，所以你可要千萬小心，『</FONT><FONT color=#3333ff>更新的套件為 rpm 的版本， tarball 的版本是無法藉由 up2date 來更新的</FONT><FONT color=#000000>』。此外，為了怕有些資訊在你的系統操作過程中遺失了，那麼就必須要先以 rpm --rebuilddb 建議資料庫囉。</FONT> </DT></UL>
<UL>
<LI><FONT color=#000099>如何實作：</FONT> </LI></UL>
<UL>
<DT><FONT color=#000000>其實實作的過程很簡單，只要：</FONT> </DT></UL>
<UL>
<OL>
<LI><FONT color=#000000>下載並更新 up2date 與 rhn_register 套件；</FONT> 
<LI><FONT color=#000000>確定可以登入 Internet ，可能的話，並找尋可支援的近端 proxy ；</FONT> 
<LI><FONT color=#000000>執行 rhn_register 線上註冊；</FONT> 
<LI><FONT color=#000000>執行 up2date 更新套件。</FONT> </LI></OL></UL>
<UL>
<DT><FONT color=#000000>這樣就可以囉。不過有一點必須說明一下，由於 up2date 推出的時間不長，所以舊版本的 Red Hat 本身並沒有 up2date 的功能（例如 Red Hat 6.1），所以你必須先安裝 up2date 套件。但是，由於 up2date 套件使用之前必須先登入 Red Hat 總公司，所以你必須先註冊才行。 Red Hat 就提供一個註冊程式，即為 rhn_register ！因此，整個流程就是先註冊，然後就可以線上更新囉。此外的此外，由於 rpm 套件只有 root 可以來變更系統，所以『</FONT><FONT color=#3333ff>以下的指令都必須以 root 的身份來安裝</FONT><FONT color=#000000>』</FONT> </DT></UL>
<UL>
<UL>
<LI><FONT color=#000099>下載並更新 up2date 與 rhn_register 套件：</FONT> <BR><FONT color=#000000>各版本（Red Hat 6.2 - Red Hat 7.2）詳細的 up2date 與 rhn_register 在 <A href="http://www.redhat.com/support/errata/RHBA-2001-119.html" target=_blank>Red Hat 網頁</A> 上，你可以直接去下載，如果是 Red Hat 6.1 怎辦？呵呵，你可以在這裡 <A href="http://linux.vbird.org/download/">下載 Red Hat 6.1 的 up2date 套件</A>。另外，這裡也有<A href="http://linux.vbird.org/download/"> Red Hat 7.1 的套件</A>。安裝的過程如下：</FONT> 
<P><FONT color=#3333ff>Red Hat 6.1：</FONT> 
<OL>
<LI><FONT color=#000000>將 up2date_6.1.tar.gz 解壓縮，會產生 up2date_6.1 裡面有 i386 及 srpm 兩個目錄；</FONT> 
<LI><FONT color=#000000>你可以直接將 i386 裡面的 *.i386.rpm 全部安裝，順序依序為：</FONT> 
<UL>
<LI><FONT color=#000000>python-popt...</FONT> 
<LI><FONT color=#000000>openssl-0.95.......</FONT> 
<LI><FONT color=#000000>python-1.5.2......</FONT> 
<LI><FONT color=#000000>python-xmlrpc..</FONT> 
<LI><FONT color=#000000>usermode-1.37...</FONT> 
<LI><FONT color=#000000>pam-0.72...</FONT> 
<LI><FONT color=#000000>pygnome-libglade</FONT> 
<LI><FONT color=#000000>rhn_register...</FONT> 
<LI><FONT color=#000000>gnupg...</FONT> 
<LI><FONT color=#000000>up2date...</FONT> </LI></UL><FONT color=#000000>注意喔，由於有些套件有屬性相依的疑問，所以必須依序安裝才可以。此外，若你之前已經安裝過該套件（使用『 rpm -q 套件名稱 』來查詢），則以『 rpm -Uvh 套件名稱』來升級，否則需要用『 rpm -ivh 套件名稱』來安裝。由於擔心有版本不合的疑問，所以我也將 SRPM 附上，你可以使用 rpm --rebuild 來重新編譯一次！</FONT></LI></OL></LI></UL></UL>
<UL>
<UL><FONT color=#3333ff>Red Hat 7.1：</FONT> 
<OL>
<LI><FONT color=#000000>將 up2date_7.1.tar.gz 解壓縮；</FONT> 
<LI><FONT color=#000000>將裡頭的四個 SRPM 檔案以 rpm --rebuild * 來重新編譯打包一次；</FONT> 
<LI><FONT color=#000000>到 /usr/src/redhat/RPMS/i386 這個目錄底下，將剛剛編譯完成的六個檔案安裝起來：</FONT> 
<UL>
<LI><FONT color=#000000>python-popt</FONT> 
<LI><FONT color=#000000>python-xmlrpc</FONT> 
<LI><FONT color=#000000>rhn_register-2.7.2-7.x.8.i386.rpm</FONT> 
<LI><FONT color=#000000>rhn_register-gnome-2.7.2-7.x.8.i386.rpm</FONT> 
<LI><FONT color=#000000>up2date-2.7.11-7.x.1.i386.rpm</FONT> 
<LI><FONT color=#000000>up2date-gnome-2.7.11-7.x.1.i386.rpm</FONT> </LI></UL><FONT color=#000000>這樣就算安裝完畢了！</FONT></LI></OL></UL></UL>
<UL>
<UL>
<LI><FONT color=#000099>註冊：</FONT> <BR><FONT color=#000000>註冊可以使用 <A href="http://rhn.redhat.com/network" target=_blank>http://rhn.redhat.com/network</A> 這個網址的功能來註冊，或者直接以底下的方式來註冊：</FONT></LI></UL></UL>
<UL>
<UL>
<UL>
<LI><FONT color=#000000>先重建一下你的 rpm 套件資料庫：</FONT> <BR><FONT face=細明體><FONT color=#3333ff>rpm --rebuilddb</FONT></FONT></LI></UL></UL></UL>
<UL>
<UL>
<UL>
<LI><FONT color=#000000>執行 rhn_register：</FONT> <BR>&nbsp; 
<TABLE cols=1 width="80%" bgColor=#000000>
<TBODY>
<TR>
<TD><FONT face=細明體><FONT size=-1><FONT color=#ffffff>[root@tsai /root]# </FONT><FONT color=#ffff00>rhn_register</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>This is the first time you have ran rhn_register.</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>If you need special network configuration, such as a web proxy,</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>please enter that info here.</FONT></FONT></FONT> 
<P><FONT face=細明體><FONT color=#ffffff><FONT size=-1>0.&nbsp; enableProxyAuth&nbsp;&nbsp;&nbsp; No</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>1.&nbsp; httpProxy</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>2.&nbsp; proxyUser</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>3.&nbsp; proxyPassword</FONT></FONT></FONT> 
<P><FONT face=細明體><FONT size=-1><FONT color=#ffffff>Enter number of item to edit &lt;return to exit, q to quit without saving&gt;: </FONT><FONT color=#ffff00>1 &lt;==我有 proxy</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Attribute Name: httpProxy</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Comment: HTTP proxy in host:port format, e.g. squid.redhat.com:3128</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Current value:</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>&nbsp;&nbsp;&nbsp; &lt;return for default, enter two spaces and return to clear&gt;</FONT></FONT></FONT> <BR><FONT face=細明體><FONT size=-1><FONT color=#ffffff>New Value:</FONT><FONT color=#ffff00> proxy.ncku.edu.tw:3128</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>This is the first time you have ran rhn_register.</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>If you need special network configuration, such as a web proxy,</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>please enter that info here.</FONT></FONT></FONT> 
<P><FONT face=細明體><FONT color=#ffffff><FONT size=-1>0.&nbsp; enableProxyAuth&nbsp;&nbsp;&nbsp; No</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>1.&nbsp; httpProxy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; proxy.ncku.edu.tw:3128</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>2.&nbsp; proxyUser</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>3.&nbsp; proxyPassword</FONT></FONT></FONT> 
<P><FONT face=細明體><FONT size=-1><FONT color=#ffffff>Enter number of item to edit &lt;return to exit, q to quit without saving&gt;: </FONT><FONT color=#ffff00>&lt;==按 enter 離開</FONT></FONT></FONT></P></TD></TR></TBODY></TABLE><FONT color=#000000>在上面中，由於我有 proxy ，所以選擇 1 ，如果你沒有的話，就選 0 吧！然後，再執行一次 ：</FONT> <BR><FONT face=細明體><FONT color=#3333ff>rhn_register</FONT></FONT><FONT color=#000000> （請以 root 的身份喔）這次由於需要連線到 Red Hat 公司，所以時間很久，請稍待喔！</FONT></LI></UL></UL></UL>
<UL>
<UL>
<UL>
<CENTER><IMG height=345 src="102_files/up2date-01[1].jpg" width=687 NOSAVE></CENTER></UL></UL></UL>
<UL>
<UL>
<UL>
<CENTER><IMG height=352 src="102_files/up2date-02[1].jpg" width=690 NOSAVE></CENTER></UL></UL></UL>
<UL>
<UL>
<UL>
<CENTER><IMG height=328 src="102_files/up2date-03[1].jpg" width=565 NOSAVE></CENTER></UL></UL></UL>
<UL>
<UL>
<UL><FONT color=#000000>這裡請輸入你的使用名稱，如果已經註冊過，那麼這裡就要填寫正確，如果從未註冊過，那麼這裡就請填寫你要的使用者名稱與密碼。並且，請將你的使用者名稱與密碼『記下來』，以後可以直接使用，而不需要底下的步驟囉！</FONT> 
<CENTER><IMG height=373 src="http://linux.vbird.org/linux_security/old/up2date/up2date-04.jpg" width=670 NOSAVE></CENTER></UL></UL></UL>
<UL>
<UL>
<UL>
<CENTER><IMG height=381 src="102_files/up2date-05[1].jpg" width=645 NOSAVE></CENTER></UL></UL></UL>
<UL>
<UL>
<UL><FONT color=#000000>上面會列出你的軟硬體資訊，這個時候請注意看一下你的軟硬體設定是否正確！注意，如果到這一步結果發現有問題時，通常是找不到你的系統資訊，這時，請以 rpm --rebuilddb 來重建你的資料庫。</FONT> 
<CENTER><IMG height=105 src="102_files/up2date-06[1].jpg" width=410 NOSAVE></CENTER></UL></UL></UL>
<UL>
<UL>
<UL>
<CENTER><IMG height=368 src="102_files/up2date-07[1].jpg" width=669 NOSAVE></CENTER></UL></UL></UL>
<UL>
<UL>
<UL>
<CENTER><IMG height=256 src="102_files/up2date-08[1].jpg" width=687 NOSAVE></CENTER></UL></UL></UL>
<UL>
<UL>
<UL>
<CENTER><IMG height=100 src="102_files/up2date-09[1].jpg" width=410 NOSAVE></CENTER></UL></UL></UL>
<UL>
<UL>
<UL>
<CENTER><IMG height=334 src="102_files/up2date-10[1].jpg" width=637 NOSAVE></CENTER><FONT color=#000000>這樣就註冊完畢了，開始使用 up2date 吧！</FONT></UL></UL></UL>
<UL>
<UL>
<UL>
<LI><FONT color=#000000>啟動註冊碼：</FONT> <BR><FONT face=細明體><FONT color=#3333ff>/usr/bin/gpg --import /usr/share/rhn/RPM-GPG-KEY</FONT></FONT></LI></UL></UL></UL>
<UL>
<UL>
<LI><FONT color=#000099>開始使用 up2date 功能：</FONT> <BR><FONT color=#000000>其實，使用 man up2date 就可以知道很多的功能囉！不過，這裡列出幾個可能比較常用的：</FONT> 
<UL>
<LI><FONT color=#000000>up2date -l：列出可以安裝的套件；</FONT> 
<LI><FONT color=#000000>up2date --showall：列出你的版本的 Red Hat 有沒有可以安裝的套件；</FONT> 
<LI><FONT color=#000000>up2date -i package：其中package 指的是套件的名稱，你可以直接將這個套件捉下來並安裝喔；</FONT> 
<LI><FONT color=#000000>up2date -u：全部的套件升級！等於是升級你的 Red Hat 系統的意思。</FONT> </LI></UL></LI></UL></UL>
<UL>
<LI>使用感想： <BR><FONT color=#000000>其實我一直覺得 up2date 是很方便沒錯，但是對於我們這些使用 ADSL 或者是對國外連線很慢的系統來說，使用 up2date 可能是一件很痛苦的事情！！Why？這是因為 up2date 的功能是將你的網路直接連到美國 Red Hat 總公司，這可是跨洋的線路呢，你要下載的速度有多快呢？我們又不是在美國使用這一個功能.....所以，除非是在網路並沒有很繁忙的時候，否則，我們還是乖乖的去找一些臺灣已經有人幫忙捉下來的檔案，還是比較快一些.....</FONT></LI></UL>
<DT><FONT face=新細明體><FONT color=#3333ff><FONT size=-1>2002/01/01以來統計人數</FONT></FONT></FONT> <BR><IMG height=15 src="102_files/Count[21].gif" width=60 align=ABSCENTER NOSAVE> 
<HR width="100%">

<CENTER><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 NOSAVE></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 NOSAVE></A> <BR><FONT color=#000066><FONT size=-1>Designed by <A href="mailto:vbird@mail.vbird.idv.tw">VBird</A> during 2001-2004.&nbsp; Aerosol Lab.</FONT></FONT></CENTER></DT></BODY>