<HEAD><TITLE>鳥哥的 Linux 私房菜 -- 移除不要的服務</TITLE>
<META http-equiv=Content-Type content="text/html; charset=big5">
<META content="Mozilla/4.5 [zh-TW] (WinNT; I) [Netscape]" name=GENERATOR>
<META content="strart 101" name="Microsoft Theme">
<META content="tl, default" name="Microsoft Border">
<META content=VBird name=Author>
<STYLE>
      <!--
      body{background-image=url("95_files/VBirdLinux[1].jpg");background-attachment=fixed}
      -->
   </STYLE>
</head>
<BODY background="95_files/VBirdLinux[1].jpg" nosave>
<CENTER><B><FONT color=#3333ff><FONT size=+2><FONT face=標楷體>鳥哥的</FONT><FONT face="Times New Roman,Times"> Linux </FONT><FONT face=標楷體>與</FONT><FONT face="Times New Roman,Times"> ADSL </FONT><FONT face=標楷體>私房菜</FONT></FONT></FONT></B> <BR><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 NOSAVE></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 NOSAVE></A> <BR>
<HR width="100%">
</CENTER><FONT color=#3333ff><FONT size=+2><FONT face=標楷體>偵測 </FONT><FONT face="Times New Roman Baltic">Linux</FONT><FONT face=標楷體> 開啟的服務通道（</FONT><FONT face="Times New Roman Baltic">port</FONT><FONT face=標楷體>）</FONT></FONT></FONT> 
<DIV align=right><FONT face=新細明體><FONT color=#3333ff><FONT size=-1>最近更新日期：2002/01/28</FONT></FONT></FONT></DIV>
<HR width="100%">

<UL><FONT color=#000099>前言</FONT><FONT color=#000000>：</FONT> <BR><FONT color=#000000>常常看到有些人想要知道自己的 Linux 主機到底開放了多少的 port 呢？要如何來偵測？通常我們知道的 port 有下面這幾個：</FONT> 
<UL>
<LI><FONT color=#000000>ftp:21</FONT> 
<LI><FONT color=#000000>telnet:23</FONT> 
<LI><FONT color=#000000>smtp:25</FONT> 
<LI><FONT color=#000000>http:80</FONT> 
<LI><FONT color=#000000>pop-3:110</FONT> 
<LI><FONT color=#000000>netbios-ssn:139</FONT> 
<LI><FONT color=#000000>squid:3128</FONT> 
<LI><FONT color=#000000>mysql:3306</FONT> </LI></UL><FONT color=#000000>當然還不只這些哩，如何知道 port 被開啟與否呢？</FONT></UL>
<UL>
<LI><FONT color=#000099>偵測你開啟的服務有哪些？使用功能強大的 netstat 指令</FONT> <BR><FONT color=#000000>在做為主機的 Linux 系統中，服務項目是越少越好！這樣可以避免不必要的入侵管道喔！因此，這個時候請瞭解一下您的系統當中，有沒有哪些服務被開啟了呢？要瞭解自己的系統當中的服務項目，最簡便的方法就是使用 netstat 了！這個東西不但簡單（每一部 Linux 機器當中預設都會安裝的套件喔！），而且功能也是很不錯的，例如我們在<A href="http://linux.vbird.org/linux_security/old/04mrtg.php#online">偵測線上 WWW 使用者的人數</A>時，就很需要這個咚咚囉！好了，我們來看一下 netstat 的使用方法：</FONT> <BR>&nbsp; 
<TABLE cols=1 width="80%" bgColor=#000000>
<TBODY>
<TR>
<TD><FONT face=細明體><FONT size=-1><FONT color=#ffffff>[vbird @tsai vbird]# </FONT><FONT color=#ffff00>netstat</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Active Internet connections (w/o servers)</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Proto Recv-Q Send-Q Local Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Foreign Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State</FONT></FONT></FONT> <BR><FONT face=細明體><FONT size=-1><FONT color=#ffffff>t</FONT><FONT color=#ffff99>cp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 20 192.168.1.2:ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.1.11:1391&nbsp;&nbsp;&nbsp;&nbsp; ESTABLISHED</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Active UNIX domain sockets (w/o servers)</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Proto RefCnt Flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I-Node Path</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 10&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 768&nbsp;&nbsp;&nbsp; /dev/log</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 304058</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 303994</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 303972</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70794</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70743</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 27533</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 895</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 785</FONT></FONT></FONT></TD></TR></TBODY></TABLE><FONT color=#000000>如上所示，單純使用 netstat 的時候，僅『</FONT><FONT color=#3333ff>列出目前已經接通的服務項目與服務名稱</FONT><FONT color=#000000>』所以你可以看到，由於目前僅有一個 ssh 的連線建立成功，所以就只有顯示出一個 </FONT><FONT color=#3333ff>ESTABLISHED （連線中的意思）</FONT><FONT color=#000000>的項目。上面淺黃色的那一行，表示『</FONT><FONT color=#3333ff>有一個 ssh 的服務開啟通道連線中，是由遠端的 192.168.1.11 這個 IP 連接到 192.168.1.2 的主機上面的這個 IP ，而連線的通道是以 1391 這個通道連接進入 ssh 的服務中的！</FONT><FONT color=#000000>』。那如果我需要將所有的項目都列出來呢？</FONT> <BR>&nbsp; 
<TABLE cols=1 width="79%" bgColor=#000000>
<TBODY>
<TR>
<TD><FONT face=細明體><FONT size=-1><FONT color=#ffffff>[vbird @tsai vbird]# </FONT><FONT color=#ffff00>netstat -a</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>AActive Internet connections (servers and established)</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Proto Recv-Q Send-Q Local Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Foreign Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:pop3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:imap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:ftp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:smtp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 20 192.168.1.2:ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.1.11:1391&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ESTABLISHED</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:1238&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Active UNIX domain sockets (servers and established)</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Proto RefCnt Flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I-Node Path</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 10&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 768&nbsp;&nbsp;&nbsp; /dev/log</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 304058</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 303994</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 303972</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70794</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70743</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 27533</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 895</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 785</FONT></FONT></FONT></TD></TR></TBODY></TABLE><FONT color=#000000>如上所示，加入 -a 就是說將所有在機器上『</FONT><FONT color=#3333ff>監聽(LISTEM)</FONT><FONT color=#000000>』或者是『</FONT><FONT color=#3333ff>建立連線</FONT><FONT color=#000000>』的服務通通列出的意思，不過，服務的名稱已經使用 /etc/services 裡面的名稱了，而不是使用 port 的數字！如上所示，目前我主機上面的服務共開啟了</FONT> 
<UL>
<LI><FONT color=#000000>pop3</FONT> 
<LI><FONT color=#000000>imap</FONT> 
<LI><FONT color=#000000>ftp</FONT> 
<LI><FONT color=#000000>ssh</FONT> 
<LI><FONT color=#000000>smtp</FONT> </LI></UL><FONT color=#000000>等服務（</FONT><FONT color=#3333ff>就是 LISTEN 的那幾個咚咚囉</FONT><FONT color=#000000>！）至於已經建立的服務就只有 ssh 這一個囉！那如果我想要知道 port 呢？呵呵，就使用底下的指令吧！</FONT> <BR>&nbsp; 
<TABLE cols=1 width="80%" bgColor=#000000>
<TBODY>
<TR>
<TD><FONT face=細明體><FONT size=-1><FONT color=#ffffff>[vbird @tsai vbird]# </FONT><FONT color=#ffff00>netstat -an</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Active Internet connections (servers and established)</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Proto Recv-Q Send-Q Local Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Foreign Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:110&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:143&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 20 192.168.1.2:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.1.11:1391&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ESTABLISHED</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:1238&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Active UNIX domain sockets (servers and established)</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>Proto RefCnt Flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I-Node Path</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 10&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 768&nbsp;&nbsp;&nbsp; /dev/log</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 304058</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 303994</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 303972</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70794</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70743</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 27533</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 895</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 785</FONT></FONT></FONT></TD></TR></TBODY></TABLE><FONT color=#000000>如上所示，我接通的服務通道只有 22 這一個，而其他的你可以參照上面的指令輸出結果來對照，所以你就可以知道囉：pop3 為 110 而 imap 為 143 呵呵！就是這樣囉！因此，透過此一指令，就可以輕易的瞭解目前主機的運作狀況與服務狀態囉！當然囉， netstat 的用途不止於此，您可以使用 </FONT><FONT color=#3333ff>man netstat</FONT><FONT color=#000000> 來查閱一番喔！相信對你的主機會有更大的瞭解呦！</FONT></LI></UL>
<UL>
<LI><FONT color=#000099>偵測你開啟的通訊閘道（port）</FONT><FONT color=#000000>：</FONT><FONT color=#000099>使用 nmap 套件</FONT> 
<DT><FONT color=#000000>將一些不必要的套件移除之後，再來則是要來偵測一下你目前開啟的閘道有哪些？這時就需要使用到 nmap 這個軟體了，你可以按一下 <A href="http://linux.vbird.org/download/linux_security/nmap-2.54BETA25-1.i386.rpm">這裡</A> 下載。</FONT> 
<DT><FONT color=#000000>&nbsp;</FONT> 
<OL>
<LI><FONT color=#3333ff>安裝</FONT><FONT color=#000000>：就是使用 rpm 安裝呀！直接下達：</FONT><FONT face=細明體><FONT color=#3333ff>rpm -ivh nmap-2.54BETA25-1.i386.rpm</FONT></FONT><FONT color=#000000> 即可。</FONT> <BR>&nbsp; 
<LI><FONT color=#3333ff>偵測</FONT><FONT color=#000000>：下達 nmap your.host.IP ，例如我的主機 IP 為 192.168.1.2 則 </FONT><FONT face=細明體><FONT color=#3333ff>nmap 192.168.1.2</FONT></FONT><FONT color=#000000>。</FONT> 
<OL><FONT color=#000000>結果有點像這樣：</FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>Starting nmap V. 2.54BETA25 ( www.insecure.org/nmap/ )</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>Interesting ports on tsai.adsldns.org (192.168.1.2):</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>(The 1534 ports scanned but not shown below are in state: closed)</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Service</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>21/tcp&nbsp;&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ftp</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>23/tcp&nbsp;&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; telnet</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>25/tcp&nbsp;&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; smtp</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>80/tcp&nbsp;&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>109/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop-2</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>110/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop-3</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>139/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; netbios-ssn</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>143/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; imap2</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>3128/tcp&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; squid-http</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000066><FONT size=-1>3306/tcp&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mysql</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#000000><FONT size=-1>上面就是我們有開啟的服務 port 啦，WWW為 80 port 而 telnet 使用 23 port ，郵件的傳送則使用 25 與 110 port ！</FONT></FONT></FONT></OL>
<LI><FONT color=#3333ff>限制</FONT><FONT color=#000000>：這個軟體請千萬不要去偵測他人的網站，否則可能會被提出告訴喔！</FONT> <BR>&nbsp; 
<LI><FONT color=#3333ff>解除安裝</FONT><FONT color=#000000>：如果確定執行完畢了，瞭解你所開啟的服務之後，你可以直接將這套軟體移除之，以免不小心執行後，導致別人的抗議：</FONT><FONT face=細明體><FONT color=#000099>rpm -e nmap</FONT></FONT><FONT color=#000000> 即可。</FONT> </LI></OL></DT></LI></UL>
<UL>
<DT><FONT color=#000000>網路上一些玩家都建議大家在使用 Linux 的時候，以較安全的方式來開啟你的網站，當然，這是網管人員所必須要注意的事項！如果你對於網管很有興趣的話，就一定需要注意一下這些網路安全的課題！當然囉，建立防火牆也是蠻必須的！另外，也必須常常的更新你的 Linux 套件的最新版本的資訊喔！我想，過一陣子我可能會專門闢一區來說明 RedHat 6.1 的安全升級套件的說明資料。</FONT> </DT></UL>
<UL>
<DT><FONT color=#000000>需要注意的是，由於你剛剛這樣子下來，可能動到了系統的一些設定了，因此，對於你的 sendmail 可能會有若干的不良影響（以我為例，我完成的上面的動作之後，雖然 port 110 與 port 25 是正常的，但是寄信就是很慢很慢，這個時候，就得需要以 netconf 這個程式來重新產生 sendmail 的程式碼。）因此，建議完成的上面的動作之後，請到 <A href="http://linux.vbird.org/linux_security/linux/linux_25mailsendmail.html">mail server</A> 那一篇文章中，看一看如何使用 netconf 來重新設定與產生 sendmail.cf 檔案！</FONT> </DT></UL>
<DT><FONT face=新細明體><FONT color=#3333ff><FONT size=-1>2002/ 01/01以來統計人數</FONT></FONT></FONT> <BR><IMG height=15 src="95_files/Count[20].gif" width=60 align=ABSCENTER NOSAVE> 
<HR width="100%">

<CENTER><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 NOSAVE></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 NOSAVE></A> <BR><FONT color=#000066><FONT size=-1>Designed by <A href="mailto:vbird@mail.vbird.idv.tw">VBird</A> during 2001-2004.&nbsp; Aerosol Lab.</FONT></FONT></CENTER></DT></BODY>