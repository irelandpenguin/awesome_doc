<HEAD><TITLE>鸟哥的 Linux 私房菜 -- RPM 与 SRPM 套件管理员</TITLE>
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<META content=VBird name=Author>
<META content="Mozilla/4.5 [zh-TW] (WinNT; I) [Netscape]" name=GENERATOR><!-- saved from url=(0022)http://internet.e-mail -->
<STYLE>

   <!--

   body{background-image=url("34_files/VBirdLinux[1].jpg");background-ATTACHMENT=FIXED}

   -->

</STYLE>
</head>
<BODY background="34_files/VBirdLinux[3].jpg" nosave="">
<CENTER>
<CENTER><B><FONT color=#3333ff size=+2><FONT face=SimSun>鸟哥的</FONT><FONT face="Times New Roman,Times"> Linux </FONT><FONT face=SimSun>与</FONT><FONT face="Times New Roman,Times"> ADSL </FONT><FONT face=SimSun>私房菜</FONT></FONT></B> <BR><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 nosave=""></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 nosave=""></A> <BR>
<HR width="100%">
</CENTER><FONT color=#3333ff size=+2><A href="http://linux.vbird.org//linux_basic/0520rpm_and_srpm.php" target=_self><FONT face="Times New Roman,Times">RPM </FONT><FONT face=SimSun>与</FONT><FONT face="Times New Roman,Times"> SRPM </FONT><FONT face=SimSun>套件管理员</FONT></A></FONT></CENTER>
<DIV align=right><FONT face=SimSun color=#3333ff size=-1>最近更新日期：2004/04/20</FONT></DIV><FONT face=SimSun color=#3333ff size=-2>　</FONT> 
<TABLE cols=1 width="100%" bgColor=#ffcccc border=1>
<TBODY>
<TR>
<TD><FONT color=#000099 size=-1>在上一章当中，我们介绍了以 Tarball 的方式来安装我们的套件，同时也说明了 Source code 与执行档之间的关系。不过，如果每次安装套件都需要进行编译的动作，那么实在很没效率！这个时候，由 Red Hat 公司所开发出来的套件管理程序( Red Hat Package Manager, RPM )可就帮了大忙了！RPM 除了可以用来安装套件之外，还可以进行查询、升级、反安装、以及其它验证等等的功能，这些功能让我们在管理系统的套件上，更显的方便呢！此外，我们也可以利用 RPM 的原理来『自行创造自己的 RPM 档案』呢！</FONT> <BR><FONT color=#000099 size=-1>　</FONT> <BR><FONT color=#000099 size=-1>由于 RPM 实在是太好用了，目前主要的 Linux distributions 都是使用 RPM 来管理他们的套件，例如 Mandrake 与 Red Hat ，所以，您不能不知道 RPM 是什么东西？该如何利用他，以及熟悉相关的功能！赶紧来参详参详！</FONT></TD></TR></TBODY></TABLE><FONT color=#000099 size=-2>　</FONT> <BR><FONT color=#000099 size=+1><A href="#intro">前言</A>：</FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#intro_whatisrpm">什么是 RPM 与 SRPM</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#intro_i386586">什么是 i386, i586, i686, noarch</A> ？</FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#intro_advance">RPM 的优点</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#intro_solution">RPM 属性相依的克服方式</A></FONT> <BR><FONT color=#000099 size=+1><A href="#rpmmanager">RPM 套件管理程序</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#rpmmanager_dir">RPM 预设安装的路径</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#rpmmanager_install">RPM 安装</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#rpmmanager_update">RPM 升级与更新</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#rpmmanager_query">RPM 查询</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#rpmmanager_verify">RPM 验证与数位签章</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#rpmmanager_rebuild">RPM 反安装与重建数据库</A></FONT> <BR><FONT color=#000099 size=+1><A href="#srpmmanager">SRPM 的使用</A>：</FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#srpmmanager_rebuild">利用系统默认值安装 SRPM 档案</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#srpmmanager_dir">SRPM 使用的路径与需要的套件</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#srpmmanager_config">设定档的主要内容</A></FONT> <BR><FONT color=#000099><FONT size=+1>　　：</FONT><A href="#srpmmanager_command">SRPM 的编译指令</A></FONT> <BR><FONT color=#000099><FONT size=+1><A href="#myself">一个打包自己套件的范例</A></FONT>：</FONT> <BR><FONT color=#000099 size=+1><A href="#rpmortarball">要选择 RPM 还是 Tarball</A>？</FONT> <BR><FONT color=#000099 size=+1><A href="#important">重点回顾</A></FONT> <BR><FONT color=#000099 size=+1><A href="#reference">参考资源</A></FONT> <BR><FONT color=#000099 size=+1><A href="#FAQ">课后练习</A></FONT> <BR>
<HR width="100%">
<A name=intro></A><IMG height=34 alt="" src="33_files/penguin-m[1].gif" width=25 align=middle nosave=""><FONT color=#000099 size=+1>前言</FONT> 
<BLOCKQUOTE>在前一章我们提到以原始码的方式来安装套件，也就是利用厂商释出的 Tarball 来进行套件与程序的安装。不过，您应该很容易发现，那就是每次安装套件都需要设定操作系统、设定编译参数、实际的编译、最后还要依据个人喜好的方式来安装套件到定位。这过程是真的很麻烦的，而且对于不熟整个系统的朋友来说，还真是累人啊！ <BR>　 <BR>那有没有想过，如果我的 Linux 系统与厂商的系统一模一样，那么在厂商的系统上面编译出来的执行档，自然也就可以在我的系统上面跑！也就是说，厂商先在他们的系统上面编译好了我们使用者所需要的套件，然后将这个编译好的可执行的套件直接释出给使用者来安装，如此一来，由于我们本来就使用厂商的 Linux distribution ，所以当然系统是一样的，那么使用厂商提供的编译过的可执行档就没有问题啦！说的比较白话一些，那就是利用类似 Windows 的安装方式，由程序开发者直接在已知的系统上面编译好，再将该程序直接给使用者来安装，如此而已。 <BR>　 <BR>那么如果在安装的时候还可以加上一些与这些程序相关的信息，将他建立成为数据库，那不就可以进行安装、反安装、升级与验证等等的相关功能( 类似 Windows 底下的『新增移除程序』 )？！确实如此，在 Linux 上面至少就有两种常见的这方面的套件管理员，分别是 RPM 与 Debian 的 dpkg ，其中又以 RPM 更常见。所以底下我们就来介绍一下 RPM 这个咚咚！ <BR>　 <BR>
<HR width="100%">
<A name=intro_whatisrpm></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>什么是 RPM 与 SRPM</FONT> 
<BLOCKQUOTE>RPM 全名是『<FONT color=#000066> RedHat Package Manager </FONT>』简称则为 RPM 啦！顾名思义，当初这个套件管理的程序是由 Red Hat 这家公司发展出来的，但其实在很多的其它套件也有相类似的套件管理程序。不过由于 RPM 使用上很方便，所以就成了目前最热门的套件管理程序啦！ <BR>　 <BR>那么什么是 RPM 呢？说的简单一点， <FONT color=#000066>RPM 是以一种数据库记录的方式来将你所需要的套件安装到你的 Linux 主机的一套管理程序</FONT>。他最大的特点就是将您要安装的套件先编译过( 如果需要的话 )并且打包好了，透过包装好的套件里头预设的数据库记录，记录这个套件要安装的时候必须要的相依属性模块( 就是你的 Linux 主机需要先存在的几个必须的套件 )，当安装在你的 Linux 主机时， RPM 会先依照套件里头的纪录数据查询 Linux 主机的相依属性套件是否满足，若满足则予以安装，若不满足则不予安装。那么安装的时候就将该套件的信息整个写入 RPM 的数据库中，以便未来的查询、验证与反安装！这样一来的优点是： 
<OL>
<LI><FONT color=#000066>由于已经编译完成并且打包完毕，所以安装上很方便( 不需要再重新编译 )；</FONT> 
<LI><FONT color=#000066>由于套件的信息都已经记录在 Linux 主机的数据库上，很方便查询、升级与反安装；</FONT> </LI></OL>但是这也造成很大的困扰，由于 RPM 程序是已经包装好的数据，也就是说，里面的数据已经都『编译完成』了！所以，<FONT color=#000066>安装的时候一定需要当初安装时的主机环境才能安装</FONT>，也就是说，当初建立这个套件的安装环境必须也要在你的主机上面出现才行！例如 rp-pppoe 这个 ADSL 拨接套件，他必须要在 ppp 这个套件存在的环境下才能进行安装！如果你的主机并没有 ppp 这个套件，那么很抱歉，除非您先安装 ppp 否则 rp-pppoe 就是不让你安装的( 当然您可以强制安装，但是通常都会有点问题发生就是了！ )。所以，<FONT color=#000066>通常不同的 distribution 所释出的 RPM 档案，并不能用在其它的 distributions 里面</FONT>，举例来说， Red Hat 释出的 RPM 档案，通常无法直接在 Mandrake 上面进行安装的，更有甚者，不同版本之间也无法互通，例如 Mandrake 9.0 的 RPM 档案就无法直接套用在 8.2 上面！因此，这样可以发现他的缺点是： 
<OL>
<LI><FONT color=#000066>安装的环境必须与打包时的环境需求一致或相当；</FONT> 
<LI><FONT color=#000066>需要满足套件的相依属性需求；</FONT> 
<LI><FONT color=#000066>反安装时需要特别小心，最底层的套件不可先移除，否则可能造成整个系统的问题！</FONT> </LI></OL>那怎么办？呵呵！还好，还有 SRPM 这个东西！ <FONT color=#000066>SRPM 是什么呢？顾名思义，他是 Source RPM 的意思</FONT>，也就是<FONT color=#000066>这个 RPM 档案里面含有原始码( Source Code )哩</FONT>！特别注意的是，这个 <FONT color=#000066>SRPM 所提供的套件内容『并没有经过编译』</FONT>，他提供的是原始码喔！通常 <FONT color=#000066>SRPM 的附n名是以 ***.src.rpm 这种格式来命名的</FONT>。不过，既然 SRPM 提供的是原始码，那么为什么我们不使用 Tarball 直接来安装就好了？！这是因为 SRPM 虽然内容是原始码，但是他仍然含有该套件所需要的相依性套件说明、以及所有 RPM 档案所提供的数据，同时，他与 RPM 不同的是，他也提供了参数设定档( 就是 configure 与 makefile 啦！ )。所以，如果我们下载的是 SRPM ，那么要安装该套件时，RPM 套件管理员将会<FONT color=#000066>(1)先将该套件以 RPM 管理的方式编译，(2)然后将编译完成的 RPM 档案安装到 Linux 系统当中</FONT>。与 RPM 档案相比， SRPM 多了一个重新编译的动作，而且<FONT color=#000066> SRPM 编译完成会产生 RPM 档案</FONT>。 <BR>　 <BR>怪了，怎么 SRPM 这么麻烦龋』挂重新编译一次，那么我们直接使用 RPM 来安装不就好了！？<FONT color=#000066>通常一个套件在释出的时候，都会同时释出该套件的 RPM 与 SRPM 。我们现在知道 RPM 档案必须要在相同的 Linux 环境下才能够安装，而 SRPM 既然是原始码的格式，自然我们就可以透过修改 SRPM 内的参数设定档，然后重新编译产生能适合我们 Linux 环境的 RPM 档案，如此一来，不就可以将该套件安装到我们的系统当中，而不必与原作者打包的 Linux 环境相同了</FONT>？这就是 SRPM 的用处了！</BLOCKQUOTE>
<HR width="100%">
<A name=intro_i386586></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>什么是 i386, i586, i686, noarch</FONT> 
<BLOCKQUOTE>好啦！现在我们已经知道 RPM 与 SRPM 的格式了，分别为： <BR>　 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffff00><B>xxxxxxxxx.rpm</B> 　</FONT><FONT color=#ccffff>&lt;==RPM 的格式，已经经过编译且包装完成的 rpm 档案；</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00><B>xxxxx.src.rpm</B> 　</FONT><FONT color=#ffccff>&lt;==SRPM的格式，包含未编译的原始码信息。</FONT></FONT></TD></TR></TBODY></TABLE>　 <BR>那么我们怎么知道这个套件的版本、适用的平台、打包的次数呢？呵呵！只要透过档名就可以知道了！例如 <FONT face=SimSun><FONT color=#000066>rp-pppoe-3.1-5.i386.rpm </FONT><FONT color=#000000>这的档案的意义为：</FONT></FONT> <BR>　 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><B><FONT face=SimSun color=#ffff00 size=-1>rp-pppoe　-　　3.1　　　　-　　　5　　.　　 i386　　　 .rpm</FONT></B> <BR><FONT face=SimSun color=#ffccff size=-1>&nbsp;套件名称&nbsp; 　套件的版本信息　&nbsp; 释出的次数　&nbsp; 适合的硬件平台　 附文件名&nbsp;</FONT></TD></TR></TBODY></TABLE>　 <BR>除了后面适合的硬件平台与附文件名外，主要是以『-』来隔开各个部分，这样子可以很清楚的发现该套件的名称、版本信息、打包次数与操作的硬件平台！好了，来谈一谈每个不同的地方吧： 
<UL>
<LI><FONT color=#000099>套件名称</FONT>： <BR>当然就是每一个套件的名称了！上面的范例就是 rp-pppoe 。 <BR>　 
<LI><FONT color=#000099>版本信息</FONT>： <BR>每一次更新版本就需要有一个版本的信息，否则如何知道这一版是新是旧？这里通常又分为主版本跟次版本，以上面为例，主版本为 3 ，在主版本的架构下更动部分原始码内容，而释出一个新的版本，就是次版本啦！以上面为例，就是 1 ！ <BR>　 
<LI><FONT color=#000099>释出版本次数</FONT>： <BR>也就是<FONT color=#000066>编译的次数</FONT>啦！那么为何需要重复的编译呢？这是由于同一版的套件中，可能由于有某些 bug 或者是安全上的顾虑，所以必须要重新设定当初打包时候的设定参数，设定完成之后重新编译并打包成 RPM 档案！因此就有不同的打包数出现了！(<I><FONT color=#000066> 注：这个时候原始码其实还是 3.1 那个版本，只是下达编译时的参数不同而已！ </FONT></I>) <BR>　 
<LI><FONT color=#000099>操作硬件平台</FONT>： <BR>这是个很好玩的地方，由于 RPM 可以适用在不同的操作平台上，但是由于不同的平台设定的参数还是有所差异性！并且，我们可以针对比较高阶的 CPU 来进行最佳化参数的设定，所以就有所谓的 i386, i586, i686 与 noarch 等的文件名称出现了！ 
<UL>　 
<TABLE cols=2 cellPadding=3 width="80%" border=0>
<TBODY>
<TR>
<TD vAlign=top width=50><FONT color=#000099>i386</FONT></TD>
<TD>几乎适用于所有的 x86 平台，不论是旧的 pentum 或者是新的 pentum-IV 与 K7 系列的 CPU等等，都可以正常的工作！那个 i 指的是 Intel 兼容的 CPU 的意思，至于 386 不用说，就是 CPU 的等级啦！</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000099>i586</FONT></TD>
<TD>就是 586 等级的计算机，那是哪些呢？包括 pentum 第一代 MMX CPU， AMD 的 K5, K6 系列 CPU ( socket 7 插脚 ) 等等的 CPU 都算是这个等级；</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000099>i686</FONT></TD>
<TD>在 pentun II 以后的 Intel 系列 CPU ，及 K7 以后等级的 CPU 都属于这个 686 等级！</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000099>no</FONT><FONT color=#000066>arch</FONT></TD>
<TD>就是没有任何硬件等级上的限制。</TD></TR></TBODY></TABLE>&nbsp;</UL>需要额外说明的是，<FONT color=#000066> i386 的档案可以在任何的机器上面安装</FONT>，不论是 586 或者是 686 的机器，但是 <FONT color=#000066>i686 则不一定可以使用于 386 或者是 586 的硬件上面，这是因为 i686 的 RPM 档案在编译的时候，主要是针对 686 硬件等级的 CPU 来进行最佳化编译，而 386/586 等级的硬件可能由于无法支持该最佳化参数，所以无法使用呢</FONT>！另外，在 686 的机器上使用 i686 的档案会比使用 i386 的档案，效能可能比较好一些！无论如何，使用 i386 应该就是比较没有问题的啦！另外，由于不同的 distirbution 会有不同的环境与函式库，所以在 i386 之后也有可能会额外再加上该套件的简写！</LI></UL></BLOCKQUOTE>
<HR width="100%">
<A name=intro_advance></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>RPM 的优点</FONT> 
<BLOCKQUOTE>RPM 有以下的优点： 
<UL>
<LI><FONT color=#000066>RPM 档案本身为已经编译过的 binary 档案，可以让 client 端的使用者免除重新编译的困扰；</FONT> 
<LI><FONT color=#000066>RPM 档案在被安装之前，RPM 会先检查系统的硬盘容量、操作系统版本等，可避免档案被安装错误；</FONT> 
<LI><FONT color=#000066>RPM 档案本身提供套件版本信息、相依属性套件名称、套件用途说明、套件所含档案等信息，便于了解套件；</FONT> 
<LI><FONT color=#000066>RPM 管理的方式使用数据库记录 RPM 档案的相关参数，便于升级、移除、查询与验证。</FONT> </LI></UL>为什么 RPM 在使用上很方便呢？我们前面提过， RPM 这个套件管理员所处理的套件，是由套件提供者在特定的 Linux 作业平台上面将该套件编译完成，并且打包好，那使用者只要拿到这个打包好的套件，然后将里头的档案放置到应该要摆放的目录，不就完成安装？！对啦！就是这样！但是有没有想过，我们在前一章 <A href="http://linux.vbird.org//linux_basic/0520source_code_and_tarball.php">原始码与 Tarball</A> 里面提过的，有些套件是有相关性的，例如要安装网络卡驱动程序，就得要有 kernel source 与 gcc 及 make 等套件。那么我们的 RPM 套件是否一定可以安装完成呢？！如果该套件安装之后，却找不到他相关的前驱套件，那不是挺麻烦的吗？因为安装好的套件也无法使用啊！ <BR>　 <BR>为了解决这种具有相关性套件之间的问题，就是所谓的套件相依属性，RPM 就在提供套件打包的档案时，同时加入一些讯息登录的功能，这些讯息包括套件的版本、打包套件者、相依属性的套件、套件的功能说明、该套件的所有档案与目录纪录、等等，然后在 Linux 系统上面亦建立一个 RPM 套件数据库( database )，如此一来，当您要安装某个以 RPM 型态提供的套件时，在安装的过程中， RPM 会去检验一下数据库里面是否已经存在相关的套件了，如果数据库显示不存在，那么这个 RPM 档案『预设』就不能安装( <I><FONT color=#000066>会显示一些错误讯息</FONT></I> )。呵呵！没有错，这个就是 RPM 类型的档案最为人所诟病的『<B><FONT color=#000066>套件的属性相依</FONT></B>』问题啦！</BLOCKQUOTE>
<HR width="100%">
<A name=intro_solution></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>RPM 属性相依的克服方式</FONT> 
<BLOCKQUOTE>虽然 RPM 有套件属性相依的问题，但是 RPM 的优点实在是比缺点要好的多，所以很多使用者还是偏好使用 RPM 来管理自己的套件，在这样的情况下，如何解决 RPM 的属性相依问题呢？最简单的方式就是在安装 RPM 档案的时候，发生套件相依的问题时，手动去下载前驱套件，先安装好这些套件，然后再安装最终想要安装的套件即可。但是，如此一来很花费使用者的精神与时间，挺麻烦的啦！有没有比较快速的方法呢？ <BR>　 <BR>呵呵！有的，由于 RPM 类型的档案里面含有属性相依的讯息存在，如果我们可以透过分析这些讯息，再让程序自行去寻找未安装的前驱套件，并事先加以安装，如此一来不就解决了属性相依的困扰了吗？！没错！是这样！这就是目前所谓的 <A href="http://linux.vbird.org//linux_server/0450apt.php">urpmi/apt/yum</A> 等服务的由来啦！这些服务都是透过分析 RPM 档案的相依信息，然后自行取得相依属性套件，自行完成安装的动作，呵呵！相当的方便呢！这些信息我们会在 <A href="http://linux.vbird.org//linux_server/">服务器架设篇</A> 里面进行介绍，在这个章节当中，我们主要还是以单纯的 RPM 为主喔！</BLOCKQUOTE></BLOCKQUOTE>
<HR width="100%">
<A name=rpmmanager></A><IMG height=34 alt="" src="33_files/penguin-m[1].gif" width=25 align=middle nosave=""><FONT color=#000099 size=+1>RPM 套件管理程序</FONT> 
<UL><FONT color=#000000>RPM 的使用其实不难，只要使用 rpm 这个指令即可！鸟哥最喜欢的就是 rpm 指令的查询功能了，可以让我很轻易的就知道某个系统有没有安装鸟哥要的套件呢！此外，我们最好还是得要知道一下，到底 RPM 类型的档案他们是将套件的相关档案放置在哪里呢？还有，我们说的那个 RPM 的数据库又是放置在哪里呢？</FONT> <BR><FONT color=#000000>　</FONT> <BR>
<HR width="100%">
<A name=rpmmanager_dir></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>RPM 预设安装的路径</FONT> 
<UL><FONT color=#000000>　</FONT> <BR>一般来说，RPM 类型的档案在安装的时候，会先去读取档案内记载的设定参数内容，然后将该数据用来比对 Linux 系统的环境( <I><FONT color=#000066>例如属性相依的套件</FONT></I> )，例如目前 <A href="http://linux.vbird.org//linux_server/0310telnetssh.php#ssh">SSH</A> 这个远程联机软件( <I><FONT color=#000066>请参考服务器篇</FONT></I> )使用的是 OpenSSL 的加密机制，所以，要安装 SSH 的时候，就得要先安装好 OpenSSL 才行啊，如果没有安装 OpenSSL 的话， SSH 就不让您安装了！这些都是 RPM 环境的要求，如果环境相符就予以安装，如果不符就会显示出不符合的内容所在！<FONT color=#000066>等到安装完毕之后， rpm 就会将套件的信息写入：<B>/var/lib/rpm</B> 这个目录中去！</FONT>所以，往后您在进行查询的时候或者是预计要升级的时候，相关的信息就会由 <B><FONT color=#000066>/var/lib/rpm</FONT></B> 这个目录的内容数据来提供！ <BR>　 <BR>一般来说，由于 RPM 有数据库来纪录套件相关的信息，所以 RPM 类型的套件所拥有的档案都放置在系统预设放置的目录底下，亦即如同我们在 <A href="http://linux.vbird.org//linux_basic/0210filepermission.php#Linux_directory">档案属性与目录配置</A> 一文当中提到的： 
<UL>　 
<TABLE cols=2 cellPadding=3 width=500 border=0>
<TBODY>
<TR>
<TD width=120><FONT face=SimSun color=#000066>/etc</FONT></TD>
<TD><FONT face=SimSun color=#000066>一些设定文件放置的目录，例如 /etc/crontab</FONT></TD></TR>
<TR>
<TD><FONT face=SimSun color=#000066>/usr/bin</FONT></TD>
<TD><FONT face=SimSun color=#000066>一些可执行档案</FONT></TD></TR>
<TR>
<TD><FONT face=SimSun color=#000066>/usr/lib</FONT></TD>
<TD><FONT face=SimSun color=#000066>一些程序使用的动态函式库</FONT></TD></TR>
<TR>
<TD><FONT face=SimSun color=#000066>/usr/share/doc</FONT></TD>
<TD><FONT face=SimSun color=#000066>一些基本的软件使用手册与说明文件</FONT></TD></TR>
<TR>
<TD><FONT face=SimSun color=#000066>/usr/share/man</FONT></TD>
<TD><FONT face=SimSun color=#000066>一些 man page 档案</FONT></TD></TR></TBODY></TABLE>&nbsp;</UL>好了，底下我们就来针对每个 RPM 的相关指令来进行说明！</UL></UL>
<BLOCKQUOTE>
<HR width="100%">
<A name=rpmmanager_install></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>RPM 安装( install )</FONT></BLOCKQUOTE>
<UL>
<UL>安装就是 install 嘛！所以，使用 rpm 来安装就很简单啦！假设我要安装一个档名为 rp-pppoe-3.1-5.i386.rpm 的档案，那么我可以这样( <I><FONT color=#000066>记得某些套件可能需要以系统管理员的身份来安装</FONT></I> )： <BR>　 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>rpm -i rp-pppoe-3.1-5.i386.rpm</FONT></B></FONT></TD></TR></TBODY></TABLE>　 <BR>不过，这样的参数其实无法显示安装的进度，所以，通常我们会这样下达安装指令： <BR>　 
<TABLE cols=1 width=520 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>rpm -ivh rp-pppoe-3.1-5.i386.rpm</FONT></B></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Preparing...&nbsp;&nbsp;&nbsp;&nbsp; ####################################### [100%]</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp; 1:rp-pppoe&nbsp;&nbsp;&nbsp; ####################################### [100%]</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># -i ：install 的意思</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># -v ：察看更细部的安装信息画面</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># -h ：以安装信息列显示安装进度，例如上面的 # 字符号！</FONT> <BR><FONT face=SimSun color=#cccccc size=-1>　</FONT> <BR><FONT face=SimSun color=#cccccc size=-1># 如果要安装两个以上的套件时，可以这样：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>rpm -ivh a.i386.rpm b.i386.rpm *.rpm</FONT></B></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 后面可以接多个套件！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>　</FONT> <BR><FONT face=SimSun color=#cccccc size=-1># 也可以直接由网络上面安装，例如：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>rpm -ivh http://website.name/path/pkgname.rpm</FONT></B></FONT></TD></TR></TBODY></TABLE>　 <BR>另外，如果我们在安装的过程当中发现问题，或者已经知道会发生的问题，而还是『执意』要安装这个套件时，可以使用如下的参数『强制』安装上去： 
<UL>　 
<TABLE cellSpacing=3 cols=2 cellPadding=3 width="80%" border=0>
<TBODY>
<TR>
<TD vAlign=top width=130><FONT face=SimSun color=#000066>--nodeps</FONT></TD>
<TD><FONT face=SimSun><FONT color=#000066>使用时机</FONT><FONT color=#000000>：如果您在安装某个套件时，老是发现 rpm 告诉你『</FONT><FONT color=#000066>有属性相依的套件尚未安装</FONT><FONT color=#000000>』，而您又想要直接强制安装这个套件时，可以加上 --nodeps 告知 RPM 不要去检查套件的相依性。</FONT></FONT> <BR><FONT face=SimSun><FONT color=#000066>危险性</FONT><FONT color=#000000>：套件会有相依性的原因是因为彼此会使用到对方的机制或功能，如果强制安装而不考虑套件的属性相依，则可能会造成该套件的无法正常使用！</FONT></FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun color=#000066>--nomd5</FONT></TD>
<TD><FONT face=SimSun><FONT color=#000066>使用时间</FONT><FONT color=#000000>：不想检查 RPM 档案所含的 MD5 信息时。</FONT></FONT> <BR><FONT face=SimSun><FONT color=#000066>说明</FONT><FONT color=#000000>：还记得我们在前一章有提到的 MD5 这个指纹辨识吧？！没错，这里指的就是不要检查 RPM 套件的 MD5 信息。但除非您很清楚这个套件的来源，否则不建议使用这个参数。</FONT></FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun color=#000066>--noscripts</FONT></TD>
<TD><FONT face=SimSun><FONT color=#000066>使用时机</FONT><FONT color=#000000>：不想让该套件自行启用或者自行执行某些系统指令。</FONT></FONT> <BR><FONT face=SimSun><FONT color=#000066>说明</FONT><FONT color=#000000>：RPM 的优点除了可以将档案放置到定位之外，还可以自动执行一些前置作业的指令，例如数据库的初始化。如果您不想要让 RPM 帮您自动执行这一类型的指令，就加上他吧！</FONT></FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun color=#000066>--replacefiles</FONT></TD>
<TD><FONT face=SimSun><FONT color=#000066>使用时机</FONT><FONT color=#000000>：如果在安装的过程当中出现了『</FONT><FONT color=#000066>某个档案已经被安装在您的系统上面</FONT><FONT color=#000000>』的信息，又或许出现版本不合的讯息( confilcting files )时，可以使用这个参数来直接覆盖档案。</FONT></FONT> <BR><FONT face=SimSun><FONT color=#000066>危险性</FONT><FONT color=#000000>：覆盖的动作是无法复原的！所以，您必须要很清楚的知道被覆盖的档案是真的不重要喔！否则会欲哭无泪！</FONT></FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun color=#000066>--replacepkgs</FONT></TD>
<TD><FONT face=SimSun><FONT color=#000066>使用时机</FONT><FONT color=#000000>：重新安装某个已经安装过的套件！</FONT></FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun color=#000066>--force</FONT></TD>
<TD><FONT face=SimSun color=#000000>这个参数其实就是 --replacefiles 与 --replacepkgs 的综合体！</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun color=#000066>--test</FONT></TD>
<TD><FONT face=SimSun><FONT color=#000066>使用时机</FONT><FONT color=#000000>：想要测试一下该套件是否可以被安装到使用者的 Linux 环境当中。范例为：</FONT></FONT> <BR><FONT face=SimSun color=#000066>rpm -ivh pkgname.i386.rpm --test</FONT></TD></TR></TBODY></TABLE>&nbsp;</UL>一般来说，安装的指令大约就是这些了。通常鸟哥建议直接使用 -ivh 就好了，如果安装的过程中发现问题，一个一个去将问题找出来，尽量不要使用『<FONT color=#000066>暴力安装法</FONT>』，因为可能会发生很多不可预期的问题呢！除非您很清楚的知道使用上面的参数后，安装的结果是您预期的！ <BR>&nbsp;</UL>
<HR width="100%">
<A name=rpmmanager_update></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>RPM 升级与更新</FONT> 
<UL>　 <BR><FONT face=SimSun><FONT color=#000000>使用 RPM 来升级真是太简单了！就以 -Uvh 或 -Fvh 来升级即可( </FONT><I><FONT color=#000066>注：vh 的功能仍是在于显示细部信息与安装进度而已</FONT></I><FONT color=#000000> )！不过，这两种升级方式是不太一样的：</FONT></FONT> 
<UL><FONT face=SimSun color=#000066>　</FONT> 
<TABLE cols=2 cellPadding=3 width="80%" border=0>
<TBODY>
<TR>
<TD vAlign=top width=50><FONT face=SimSun color=#000066>-Uvh</FONT></TD>
<TD><FONT face=SimSun color=#000000>后面接的套件即使没有安装过，则系统将予以直接安装；若后面接的套件有安装过旧版，则系统自动更新至新版；</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun color=#000066>-Fvh</FONT></TD>
<TD><FONT face=SimSun>如果后面接的套件并未安装到您的 Linux 系统上，则该套件不会被安装；亦即只有安装至您 Linux 系统内的套件会被『升级』！</FONT></TD></TR></TBODY></TABLE><FONT face=SimSun color=#000066>　</FONT></UL><FONT face=SimSun><FONT color=#000000>由上面的说明来看，如果您想要大量的升级系统旧版本的套件时( </FONT><I><FONT color=#000066>例如刚安装完操作系统，而想要更新套件至最新</FONT></I><FONT color=#000000> )，使用 -Fvh 则是比较好的作法。但是需要注意的是，如果您使用的是 Fvh ，偏偏您的机器上尚无这一个套件，那么很抱歉，该套件并不会被安装在您的 Linux 主机上面，所以请重新以 ivh 来安装吧！</FONT></FONT> <BR>　 <BR>通常有的朋友在进行整个操作系统的旧版套件修补时，喜欢这么进行： <BR>　 
<OL>
<LI><FONT face=SimSun color=#000066>先到各发展商的 errata 网站或者是国内的 FTP 映像站捉下来最新的 RPM 档案；</FONT> 
<LI><FONT face=SimSun color=#000066>使用 -Fvh 来将您的系统内曾安装过的套件进行修补与升级！( <I>真是方便呀！</I>)</FONT> </LI></OL>　 <BR>当然，升级也是可以利用 <FONT face=SimSun>--nodeps/--force</FONT> 等等的参数啦！</UL></UL>
<BLOCKQUOTE>
<HR width="100%">
<A name=rpmmanager_query></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>RPM 查询</FONT></BLOCKQUOTE>
<UL>
<UL>RPM 在查询的时候，其实查询的地方是在 <B><FONT color=#000066>/var/lib/rpm</FONT></B> 这个目录下的数据库档案啦！另外， RPM 也可以查询档案内的信息喔！那如何去查询呢？我们底下以简单的范例来说明： 
<UL>　 
<TABLE cellSpacing=3 cols=2 width="80%" border=0>
<TBODY>
<TR>
<TD vAlign=top width=130><FONT face=SimSun>-q&nbsp; 套件</FONT></TD>
<TD><FONT face=SimSun>单纯的查询该套件的版本与是否存在而已，例如：</FONT> <BR><FONT face=SimSun color=#000066>rpm -q logrotate</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun>-ql 套件</FONT></TD>
<TD><FONT face=SimSun>列出该套件的所有相关目录与档案喔！例如：</FONT> <BR><FONT face=SimSun color=#000066>rpm -ql logrotate</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun>-qi 套件</FONT></TD>
<TD><FONT face=SimSun>列出该套件的 information (信息)，里面的信息可多着呢，包括了套件名称、版本、开发商、SRPM文件名称、打包次数、简单说明信息、套件打包者、安装日期等等！如果想要详细的知道该套件的数据，用这个参数来了解一下。例如：</FONT> <BR><FONT face=SimSun color=#000066>rpm -qi logrotate</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun>-qf 档案</FONT></TD>
<TD><FONT face=SimSun>这个参数后面接的可是『档案』龋〔幌袂懊娑际墙犹准喔！这个功能在查询系统的某个档案属于哪一个套件所有的。举例来说，如果想要知道 /etc/logrotate.conf 是那个套件所提供的，可以这样：</FONT> <BR><FONT face=SimSun color=#000066>rpm -qf /etc/logrotate.conf</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun>-qc 套件</FONT></TD>
<TD><FONT face=SimSun>查询该套件的设定文件放置的完整目录名称，例如：</FONT> <BR><FONT face=SimSun color=#000066>rpm -qc logrotate</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun>-qd 套件</FONT></TD>
<TD><FONT face=SimSun>查询该套件的文件说明数据文件放置的完整路径名称，例如：</FONT> <BR><FONT face=SimSun color=#000066>rpm -qd logrotate</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun>-qR 套件</FONT></TD>
<TD><FONT face=SimSun>列出该套件需要预先安装的档案，亦即有属性相依套件的档案！例如：</FONT> <BR><FONT face=SimSun color=#000066>rpm -qR logrotate</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun>-qa</FONT></TD>
<TD><FONT face=SimSun>后面什么都不必加入，直接输入 rpm -qa 即可得知目前 Linux 系统上面共以 RPM 的方式安装了多少的套件！</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun>-qp[licdR] 档案</FONT></TD>
<TD><FONT face=SimSun>上面提到的都与系统的 /var/lib/rpm 内的数据库有关，而这里提到的则是与 RPM 档案本身有关。举例来说，如果我下载了一个档名为 pkgname.i386.rpm 的档案，我想要知道他里面主要的讯息，则：</FONT> <BR><FONT face=SimSun color=#000066>rpm -qpi pkgname.i386.rpm</FONT> <BR><FONT face=SimSun>想要知道与他有关的套件，则：</FONT> <BR><FONT face=SimSun color=#000066>rpm -qpR pkgname.i386.rpm</FONT></TD></TR></TBODY></TABLE>&nbsp;</UL>常见的查询就是这些了！ <BR>　 
<TABLE cols=1 width="80%" border=1>
<TBODY>
<TR>
<TD>例题： <BR>我想要知道我的系统当中，以 c 开头的套件有几个，如何实做？ 
<BLOCKQUOTE><FONT face=SimSun color=#000066>rpm -qa | grep ^c | wc -l</FONT></BLOCKQUOTE><FONT face=SimSun color=#000000>我的 WWW 服务器为 Apache ，他使用的 RPM 档名为 httpd 。现在，我想要知道这个套件的所有设定档放置在何处，可以怎么作？</FONT> 
<BLOCKQUOTE><FONT face=SimSun color=#000066>rpm -qc httpd</FONT></BLOCKQUOTE><FONT face=SimSun color=#000000>承上题，如果查出来的设定档案已经被我改过，但是我忘记了曾经修改过哪些地方，所以想要直接重新安装一次该套件，该如何作？</FONT> 
<BLOCKQUOTE><FONT face=SimSun color=#000066>假设该套件在网络上的网址为：</FONT> <BR><FONT face=SimSun color=#000066>http://web.site.name/path/httpd-x.x.xx.i386.rpm</FONT> <BR><FONT face=SimSun color=#000066>则我可以这样做：</FONT> <BR><FONT face=SimSun color=#000066>rpm -ivh http://web.site.name/path/httpd-x.x.xx.i386.rpm --replacepkgs</FONT></BLOCKQUOTE><FONT face=SimSun color=#000000>如果我误砍了某个重要档案，例如 /etc/crontab，偏偏不晓得他属于哪一个套件，该怎么办？！</FONT> 
<BLOCKQUOTE><FONT face=SimSun color=#000066>虽然已经没有这个档案了，不过没有关系，因为 RPM 有纪录在 /var/lib/rpm 当中的数据库啊！所以直接下达：</FONT> <BR><FONT face=SimSun color=#000066>rpm -qf /etc/crontab</FONT> <BR><FONT face=SimSun color=#000066>就可以知道是那个套件！重新安装一次该套件即可！</FONT></BLOCKQUOTE></TD></TR></TBODY></TABLE>&nbsp;</UL>
<HR width="100%">
<A name=rpmmanager_verify></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>RPM 验证与数位签章</FONT></UL>
<BLOCKQUOTE>
<BLOCKQUOTE>验证的功能主要在于提供系统管理员一个有用的管理机制！作用的方式是『<B><FONT color=#000066>使用 /var/lib/rpm 底下的数据库内容来比对目前 Linux 系统的环境下的所有套件档案</FONT></B>』也就是说，当您有数据不小心遗失，或者是因为您误杀了某个套件的档案，或者是不小心不知道修改到某一个套件的档案内容，就用这个简单的方法来验证一下原本的档案系统吧！好让您了解这一阵子到底是修改到哪些档案数据了！验证的方式很简单： 
<BLOCKQUOTE>　 
<TABLE cellSpacing=3 cols=2 width="80%" border=0>
<TBODY>
<TR>
<TD vAlign=top width=100><FONT face=SimSun>-V&nbsp; 套件</FONT></TD>
<TD><FONT face=SimSun>验证一下这个套件的所有档案是否有被更动过，只有被更动过的档案才会被列出来。例如：</FONT> <BR><FONT face=SimSun color=#000066>rpm -V logrotate</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun>-Va</FONT></TD>
<TD><FONT face=SimSun>列出目前系统当中所有被更动过的档案。例如：</FONT> <BR><FONT face=SimSun color=#000066>rpm -Va</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun>-Vp 套件</FONT></TD>
<TD><FONT face=SimSun>列出该套件上面可能已经被更动过的档案，例如：</FONT> <BR><FONT face=SimSun color=#000066>rpm -Vp pkgname.i386.rpm</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun>-Vf 档案</FONT></TD>
<TD><FONT face=SimSun>查阅一下某个档案是否被更动过，例如：</FONT> <BR><FONT face=SimSun color=#000066>rpm -Vf /etc/logrotate.conf</FONT></TD></TR></TBODY></TABLE>&nbsp;</BLOCKQUOTE>好了，那么我怎么知道到底我的档案被更动过的内容是什么？呵呵！简单的说明一下吧！例如，我们检查一下 logrotate 这个套件： <BR>　 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#cccccc size=-1># 先看一下 logrotate 有几个档案？</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>rpm -ql logrotate</FONT></B></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>/etc/cron.daily/logrotate</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>/etc/logrotate.conf</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>/etc/logrotate.d</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>/usr/sbin/logrotate</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>/usr/share/doc/logrotate-3.6.8</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>/usr/share/doc/logrotate-3.6.8/CHANGES</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>/usr/share/man/man8/logrotate.8.gz</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>/var/lib/logrotate.status</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 呵呵！共有 8 个档案喔！</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun color=#cccccc size=-1># 再来看一下有几个档案被动过了？！</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>rpm -V logrotate</FONT></B></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>..5....T c /etc/logrotate.conf</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 怪怪！前面的几个咚咚是什么呢？！底下说明喔！</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>S ：file Size differs</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>　　档案的容量大小是否被改变</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>M ：Mode differs (includes permissions and file type)</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>　　档案的类型或档案的属性，如是否可执行等参数已被改变</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>5 ：MD5 sum differs</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>　　MD5 这一种加密防骇的属性已被改变</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>D ：Device major/minor number mis-match</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>　　装置名称已被改变</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>L ：readLink(2) path mis-match</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>　　Link 属性已被改变</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>U ：User ownership differs</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>　　档案的所属人已被改变</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>G ：Group ownership differs</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>　　档案的所属群组已被改变</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>T ：mTime differs</FONT> <BR><FONT face=SimSun color=#ffccff size=-1>　　档案的建立时间已被改变</FONT></TD></TR></TBODY></TABLE>　 <BR>所以，如果当一个档案所有的信息都被更动过，那么他的显示就会是： <BR>　 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><B><FONT face=SimSun color=#ffff00 size=-1>SM5DLUGT c filename</FONT></B></TD></TR></TBODY></TABLE>　 <BR>至于那个 c 代表的是『 Config file 』的意思，也就是档案的类型，档案类型有底下这几类： 
<UL>
<LI><FONT face=SimSun color=#000066>c ：设定档(config file)</FONT> 
<LI><FONT face=SimSun color=#000066>d ：文件数据文件(documentation)</FONT> 
<LI><FONT face=SimSun color=#000066>g ：鬼档案～通常是该档案不被某个套件所包含，较少发生！(ghost file)</FONT> 
<LI><FONT face=SimSun color=#000066>l ：授权档案(license file)</FONT> 
<LI><FONT face=SimSun color=#000066>r ：自述文件(read me)</FONT> </LI></UL>经过验证的功能，您就可以知道那个档案被更动过。那么如果该档案的变更是『预期中的』，那么就没有什么大问题，但是如果该档案是『非预期的』，那么是否被入侵了呢？呵呵！得注意注意！ <BR>　 <BR>再来，由于数字签证的盛行，我们 Linux 的 RPM 也可以利用数字签证来判断待安装的套件档案是否有问题喔！一般我们使用的是 <FONT color=#000066>GPG 的金钥( public key )。</FONT>应用的方法很简单，首先，当我们想要使用某个团体释出的套件时，就需要将他们释出的 GPG 金钥先安装在自己的 Linux 系统上。然后，当安装该团体释出的套件时，就会检查两者的 key 是否相同，如果相同就直接安装，如果不同就会在屏幕上面显示讯息告知您并未安装该团体的 GPG 金钥！ <BR>　 <BR>安装金钥的方法很简单，例如 Red Hat 本身就有金钥在系统当中，安装如下： <BR>　 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>rpm --import /usr/share/rhn/RPM-GPG-KEY</FONT></B></FONT></TD></TR></TBODY></TABLE>　 <BR>那么如何查得这个金钥的相关信息呢？使用的方法很简单： <BR>　 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>rpm -qa | grep gpg</FONT></B></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>gpg-pubkey-e30di49b-392ksif1</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>gpg-pubkey-dkdf93ke-35698248</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>rpm -qi gpg-pubkey-e30di49b-392ksif1</FONT></B></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : gpg-pubkey&nbsp;&nbsp; Relocations: (not relocateable)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Version&nbsp;&nbsp;&nbsp;&nbsp; : e30di49b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Vendor: (none)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Release&nbsp;&nbsp;&nbsp;&nbsp; : 392ksif1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Build Date: Mon 29 Sep 2003 07:29:13 PM CST</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Install Date: Mon 29 Sep 2003 07:29:13 PM CST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Build Host: localhost</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Group&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : Public Keys&nbsp;&nbsp; Source RPM: (none)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; License: pubkey</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Signature&nbsp;&nbsp; : (none)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Summary&nbsp;&nbsp;&nbsp;&nbsp; : gpg(Matthias Saou (Thias) &lt;matthias.saou@est.une.marmotte.net&gt;)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Description :</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>-----BEGIN PGP PUBLIC KEY BLOCK-----</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Version: rpm-4.2 (beecrypt-2.2.0)</FONT><FONT face=SimSun color=#ffffff size=-1></FONT> 
<P><FONT face=SimSun color=#ffffff size=-1>mQGiBDlgvfERBADevsErSu+DAnE90dFPnpEX20elyZAmuRExGbcUJWSoJynohtGCa9fW6JY8</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>zm/Dm2dC8f1sSNQ2w7CFG7XRBfyQcL4AqrNKbOMeCl66Tgj+NURUHsnVyU3ASXROxVQ4/yJ6</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>9PVFomj0sealdEyDXDQoXhvgyI26qe3rriKBefCbRwCg+TdHq5I8B/9X7QLnWg7sZk7iI7sD</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>/27S9r4PS+FU9N26BvdgOvGeW6+1O/oqAU6HB+EFeGw0+uNbLjxPy1A9R5+M/FBZBMeyTO0S</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>83RVrnNfp5qzfAn8uo4EWg8eb1w==</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>=Sm+P</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>-----END PGP PUBLIC KEY BLOCK-----</FONT></P></TD></TR></TBODY></TABLE>　 <BR>这样就能看到相关的信息！ ^_^</BLOCKQUOTE></BLOCKQUOTE>
<UL>
<HR width="100%">
<A name=rpmmanager_rebuild></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>RPM 反安装与重建数据库</FONT></UL>
<BLOCKQUOTE>
<BLOCKQUOTE>反安装就是将套件解除安装啦！要注意的是，『解安装的过程一定要由最上层往下解除』，以 rp-pppoe 为例，这一个套件主要是依据 ppp 这个套件来安装的，所以当您要解除 ppp 的时候，就必须要先解除 rp-pppoe 才行！否则就会发生结构上的问题啦！这个可以由建筑物来说明，如果你要拆除五、六楼，那么当然要由六楼拆起，否则拆了第五楼，那么上面的楼层难道会悬空？ <BR>　 <BR>那么重建数据库呢？由于我们会一直在修改一些档案内容，例如 /etc/xinetd.d 里头的参数档案，加上可能自系统操作的过程中新增、移除等等的动作，导致系统的数据库有点乱，这个时候可以使用 <FONT face=SimSun color=#000066>--rebuilddb</FONT> 来重建一下 rpm 的数据库！这两个方法的参数如下： <BR>　 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>rpm -e logrotate</FONT></B><FONT color=#ffffff>&nbsp; </FONT><FONT color=#ffccff>&lt;==解安装 logrotate 套件</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>rpm --rebuilddb&nbsp;</FONT></B><FONT color=#ffffff>&nbsp; </FONT><FONT color=#ffccff>&lt;==重建数据库</FONT></FONT></TD></TR></TBODY></TABLE></BLOCKQUOTE></BLOCKQUOTE>
<HR width="100%">
<A name=srpmmanager></A><IMG height=34 alt="" src="33_files/penguin-m[1].gif" width=25 align=middle nosave=""><FONT color=#000099 size=+1>SRPM 的使用</FONT> 
<BLOCKQUOTE>谈完了 RPM 类型的套件之后，再来我们谈一谈包含了 Source code 的 SRPM 该如何使用呢？！假如今天我们由网络上面下载了一个 SRPM 的档案，该如何安装他？又，如果我想要修改这个 SRPM 里面原始码的相关设定值，又该如何订正与重新编译呢？！此外，最需要注意的是，新版的 rpm 已经将 RPM 与 SRPM 的指令分开了，SRPM 使用的是 rpmbuild 这个指令，而不是 rpm 喔！如果您是 Red Hat 7.3 以前的用户，那么请使用 rpm 来替代 rpmbuild 啦！</BLOCKQUOTE>
<UL>
<HR width="100%">
<A name=srpmmanager_rebuild></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>利用系统默认值安装 SRPM 档案</FONT></UL>
<BLOCKQUOTE>
<BLOCKQUOTE>假设我下载了一个 SRPM 的档案，又不想要修订这个档案内的原始码与相关的设定值，那么我可以直接编译并安装吗？当然可以！利用 rpmbuild 配合参数即可。参数主要有底下两个： 
<BLOCKQUOTE>&nbsp; 
<TABLE cellSpacing=3 cols=2 width="80%" border=0>
<TBODY>
<TR>
<TD vAlign=top width=100><FONT face=SimSun color=#000066>--rebuild</FONT></TD>
<TD><FONT face=SimSun color=#000000>这个参数会将后面的 SRPM 进行『编译』与『打包』的动作，最后会产生 RPM 的档案，但是产生的 RPM 档案并没有安装到系统上。当您使用 --rebuild 的时候，最后通常会发现一行字体：</FONT> <BR><B><FONT face=SimSun color=#000066>Wrote: /usr/src/RPM/RPMS/i386/pkgname.i386.rpm</FONT></B> <BR><FONT face=SimSun color=#000000>这个就是编译完成的 RPM 档案！那么这个档案就可以用来安装啦！安装的时候请加绝对路径来安装即可！</FONT></TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun color=#000066>--recompile</FONT></TD>
<TD><FONT face=SimSun color=#000000>这个动作会直接的『编译』『打包』并且『安装』！请注意， rebuild 仅『编译并打包』而已，而 recompile 不但进行编译跟打包，还同时进行『安装』了！</FONT></TD></TR></TBODY></TABLE></BLOCKQUOTE>一般来说，如果编译的动作顺利的话，那么编译过程所产生的中间暂存盘都会被自动删除，如果发生任何错误，则该中间档案会被保留在系统上，等待使用者的除错动作！那么，该如何除错呢？！如果想要自行除错，就得要知道利用 SRPM 的时候，系统会动用到哪些重要的目录了！底下我们就来谈一谈当处理 SRPM 时，系统会使用到的目录。</BLOCKQUOTE></BLOCKQUOTE>
<UL>
<HR width="100%">
<A name=srpmmanager_dir></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>SRPM 使用的路径与需要的套件</FONT> 
<UL><FONT color=#000099>　</FONT> <BR>SRPM 既然含有 source code ，那么其中必定有设定档，所以首先我们必需要知道，这个 SRPM 在进行编译的时候，会使用到哪些目录呢？这样一来才能够来修改嘛！你可以到你的 /usr/src 这个目录里面去查看一下，通常每个 distribution 提供的目录都不太相同，以 Mandrake 9.0 为例，他是以 /usr/src/RPM 为工作目录， Red Hat 是以 /usr/src/redhat 为工作目录， Openlinux 则是以 /usr/src/openlinux 为工作目录！无论如何，反正就是在 /usr/src 这个目录下就对了！好了到 /usr/src/redhat 里头去看一看呦： 
<UL>　 
<TABLE cellSpacing=3 cols=2 width="80%" border=0>
<TBODY>
<TR>
<TD vAlign=top width=200><FONT face=SimSun color=#000099>/usr/src/redhat/SPEC</FONT></TD>
<TD>这个目录当中放置的是该套件的设定档，例如这个套件的信息参数、设定项目等等都放置在这里；</TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun color=#000099>/usr/src/redhat/SOURCE</FONT></TD>
<TD>这个目录当中放置的是该套件的原始档（*.tar.gz的档案）以及 config 这个设定档；</TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun color=#000099>/usr/src/redhat/BUILD</FONT></TD>
<TD>在编译的过程中，有些暂存的数据都会放置在这个目录当中；</TD></TR>
<TR>
<TD vAlign=top><FONT face=SimSun color=#000099>/usr/src/redhat/RPMS</FONT></TD>
<TD>经过编译之后，并且顺利的编译成功之后，将打包完成的档案放置在这个目录当中。里头有包含了 i386, i586, i686, noarch.... 等等的次目录。</TD></TR></TBODY></TABLE>&nbsp;</UL></UL>
<UL>此外，在编译的过程当中，可能会发生不明的错误，或者是设定的错误，这个时候就会在 /tmp 底下产生一个相对应的错误档，您可以根据该错误档进行除错的工作呢！等到所有的问题都解决之后，也编译成功了，那么刚刚解压缩之后的档案，就是在 /usr/src/redhat/SPEC, SOURCE, BUILD 等等的档案都会被杀掉，而只剩下放置在 /usr/src/redhat/RPMS 底下的档案了！ <BR><FONT color=#000099>　</FONT> <BR>由于 SRPM 需要重新编译，而编译的过程当中，我们至少需要有 make 与其相关的程序，及 gcc, c, c++ 等其它的编译用的程序语言来进行编译，所以，如果您在安装的过程当中没有选取软件开发工具之类的套件，呵呵！得重新拿出你的光盘，然后再安装喔！哈哈！只是得要克服一大堆的属性相依的问题就是了～嗯！还是建议您再次的看一下<A href="http://linux.vbird.org//linux_basic/0150installredhat.php">如何安装</A>吧！</UL></UL>
<BLOCKQUOTE>
<HR width="100%">
<A name=srpmmanager_config></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>设定档的主要内容</FONT> 
<BLOCKQUOTE>刚刚我们在上面提过了，SRPM还可以更改一些设定的内容，那么要如何修改这些设定的内容呢？我们以简单的 rp-pppoe 这个套件来说明好了，你可以连上 Internet 上面的 rp-pppoe 官方网站下载 SRPM ，或者由以下的方式来下载这个套件(请注意底下的档案是 2004/04 最新的档案数据，有可能在您看到本文时，这个套件已经更新了，所以请直接上底下的网址来下载吧！<A href="http://www.roaringpenguin.com/pppoe/" target=_blank>http://www.roaringpenguin.com/pppoe/</A>)。至于基本的过程如下： <BR>　 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#cccccc size=-1>1. 下载 SRPM 软件：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>wget \</FONT></B></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>&gt;</FONT><FONT color=#ffff00> <B>http://www.roaringpenguin.com/products/rp-pppoe/rp-pppoe-3.5-1.src.rpm</B></FONT></FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　</FONT> <BR><FONT face=SimSun color=#cccccc size=-1>2. 将 SRPM 解开在/usr/src/redhat 底下的目录当中</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>rpm Ci rp-pppoe-3.5-1.src.rpm</FONT></B></FONT> <BR>　 <BR><FONT face=SimSun color=#cccccc size=-1>3. 观察一下有哪些原始码呢？</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>cd /usr/src/redhat/SOURCES</FONT></B></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test SOURCE]#</FONT><B><FONT color=#ffff00> ls Cl</FONT></B></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>-rw-rw-r--&nbsp;&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 189321 Jul&nbsp; 8 22:38 rp-pppoe-3.5.tar.gz</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 呵呵！上面显示我们的原始码就是这个档案啦！</FONT></TD></TR></TBODY></TABLE>　 <BR>好了，来看看我们的设定参数档，亦即是在 /usr/src/redhat/SPECS 内的 *.spec 档案！ <BR>　 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#cccccc size=-1>观察一下预设的设定档案内容：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>cd /usr/src/redhat/SPECS</FONT></B></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test SPECS]# </FONT><B><FONT color=#ffff00>vi rp-pppoe.spec</FONT></B></FONT> <BR><FONT face=SimSun size=-1>　　</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 没错！这个就是SRPM的预设设定内容档案，进去修改一下，里面的数据有点像这样：</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Summary: PPP Over Ethernet (xDSL support)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Name: rp-pppoe</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Version: 3.5</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>%if %(%{expand:test %{_vendor} != mandrake ; echo $?})</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Release: 1mdk</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>%else</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Release: 1</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>%endif</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Copyright: GPL</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Group: System Environment/Daemons</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Source: http://www.roaringpenguin.com/pppoe/rp-pppoe-3.5.tar.gz</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Url: http://www.roaringpenguin.com/pppoe/</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Packager: David F. Skoll &lt;dfs@roaringpenguin.com&gt;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>BuildRoot: /tmp/pppoe-build</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Vendor: Roaring Penguin Software Inc.</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Requires: ppp &gt;= 2.3.7</FONT> 
<P><FONT face=SimSun color=#ffffff size=-1># LIC: GPL</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>%description</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>PPPoE (Point-to-Point Protocol over Ethernet) is a protocol used by</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>many ADSL Internet Service Providers. Roaring Penguin has a free</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>client for Linux systems to connect to PPPoE service providers.</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>The client is a user-mode program and does not require any kernel</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>modifications. It is fully compliant with RFC 2516, the official PPPoE</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>specification.</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>%prep</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>%setup</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>cd src</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>./configure --mandir=%{_mandir}</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>%build</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>cd src</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>make</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>cd ../gui</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>make</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>%install</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>cd src</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>make install RPM_INSTALL_ROOT=$RPM_BUILD_ROOT</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>cd ../gui</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>make install RPM_INSTALL_ROOT=$RPM_BUILD_ROOT</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>%clean</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>rm -rf $RPM_BUILD_ROOT</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>%files</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>%defattr(-,root,root)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>%doc doc/CHANGES doc/HOW-TO-CONNECT doc/LICENSE doc/KERNEL-MODE-PPPOE README SERVPOET</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>%config(noreplace) /etc/ppp/pppoe.conf</FONT><FONT color=#ffccff></FONT> </P>
<P><FONT face=SimSun color=#ffccff size=-1>注：中间还有很多信息，被我省略掉了！知道了就好喔！</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>%changelog</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>* Thu Jul 21 2001 Shigechika AIKAWA &lt;shige@cin.nihon-u.ac.jp&gt;</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>- merged rp-pppeo.spec and rp-pppoe-gui.spec</FONT></P></TD></TR></TBODY></TABLE>　 <BR>注意到的是rp-pppoe.sepc这个档案，这是主要的将SRPM编译成RPM的设定文件，他的基本规则可以这样看： 
<OL>
<LI><FONT color=#000066>整个档案的开头以Summary为开始，这部份的设定都是最基础的说明内容；</FONT> 
<LI><FONT color=#000066>然后每个不同的段落之间，都以%来做为开头，例如%prep与%install等；</FONT> </LI></OL>我们来谈一谈几个常见的SRPM设定段落： 
<UL>
<LI><FONT color=#000066>系统整体信息方面：</FONT> 
<UL>　 
<TABLE cellSpacing=3 cols=2 width="80%" border=0>
<TBODY>
<TR>
<TD vAlign=top width=100><FONT color=#000066>Summary</FONT></TD>
<TD>主要的套件说明，例如上表中，我们说明了他是ppp的拨接用途啦！</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000066>Name</FONT></TD>
<TD>这个就是套件的名称；</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000066>Version</FONT></TD>
<TD>这个是套件的版本信息；</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000066>Release</FONT></TD>
<TD>这个是该版本打包的次数说明，在Mandrake里面，会自动的帮你设定打包的次数喔！就是1mdk那个咚咚；</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000066>Copyright</FONT></TD>
<TD>这个套件的授权模式，我们是使用GPL啦！</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000066>Group</FONT></TD>
<TD>这个套件的发展团体名称；</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000066>Source</FONT></TD>
<TD>这个套件的来源，如果是网络上下载的套件，通常一定会有这个信息来告诉大家这个原始档的来源！</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000066>Url</FONT></TD>
<TD>这个原始码的主要官方网站； Packager：这个套件是经由谁来打包的呢？</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000066>Vender</FONT></TD>
<TD>发展的厂商哪；</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000066>ExclusiveArch</FONT></TD>
<TD>这个是说明这个套件的适合安装的硬件，通常预设为i386，当然，你也可以调整为i586啦等等的！</TD></TR>
<TR>
<TD vAlign=top><FONT color=#000066>Requires</FONT></TD>
<TD>如果你这个套件还需要其它的套件的支持，那么这里就必需写上来，则当你制作成RPM之后，系统就会自动的去检查啦！这就是『相依属性』的主要来源！</TD></TR></TBODY></TABLE>　 <BR>上面几个资料通常都必需要写啦！但是如果你的软件没有相依属性的关系时，那么就可以不需要那个Requires！</UL>　 
<LI><FONT color=#000066>%description</FONT> <BR>将您的套件做一个简短的说明！这个也是必需要的。</LI></UL>
<UL>
<LI><FONT color=#000066>%prep</FONT> <BR>这部份的设定在于『尚未进行设定或安装之前，你要编译完成的RPM帮你事先做的事情』，就是prepare的简写！那么他的工作事项主要有： <BR>　 
<OL>
<LI><FONT color=#000066>寻找套件所需要的目录是否已经存在？确认用的！</FONT> 
<LI><FONT color=#000066>事先建立您的套件所需要的目录，或者事先需要进行的任务；</FONT> 
<LI><FONT color=#000066>如果待安装的Linux系统内已经有安装的时候可能会被覆盖掉的档案时，那么就必需要进行备份(backup)的工作了！</FONT> </LI></OL>　 <BR>大致的工作就是这些啦！</LI></UL>
<UL>
<LI><FONT color=#000066>%setup</FONT> <BR>这个段落就是在建立我们在Tarball当中说明的那个Makefile档案啦！所以呢，当然就是执行./config之类的设定档案！那么如果你要自己新增自己的参数，就可以在这个地方加入你的设定值！如果你的软件本身没有这方面的需要，里面就不需要编写内容！</LI></UL>
<UL>
<LI><FONT color=#000066>%build</FONT> <BR>build就是建立啊！所以当然，这个段落就是在谈怎么make编译成为可执行的程序！</LI></UL>
<UL>
<LI><FONT color=#000066>%install</FONT> <BR>编译完成(build)之后，就是要安装啦！安装就是写在这里，也就是类似Tarball里面的make install的意思！</LI></UL>
<UL>
<LI><FONT color=#000066>%files</FONT> <BR>这个套件安装的档案都需要写到这里来，当然包括了『目录』喔！所以连同目录请一起写到这个段落当中！以备查验呢！^_^</LI></UL>
<UL>
<LI><FONT color=#000066>%changelog</FONT> <BR>这个主要则是在记录这个套件曾经的更新纪录！</LI></UL>好了，那么如果您有自订的信息想要加入的话，就选择你要加入的那个段落，将他修改一下吧！例如，如果你在设定Makefile的时候，希望能够多一些额外的参数设定，那么就找到 %setup 那个段落，将他修改成您所需要的样子，就可以！</BLOCKQUOTE>
<HR width="100%">
<A name=srpmmanager_command></A><IMG height=23 src="70_files/penguin-s[2].gif" width=17 align=middle nosave=""><FONT color=#000099>SRPM 的编译指令</FONT> 
<BLOCKQUOTE>再来呢？嗯！没错，修改完成了，自然就是要将他编译成可以安装的RPM档案啦！这个时候我们就可以直接在/usr/src/redhat/SPECS底下下达： <BR>　 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test SPECS]# </FONT><FONT color=#ffff00><B>rpmbuild -bb rp-pppoe.spec</B>&nbsp; </FONT><FONT color=#ffccff>&lt;==编译成RPM档案</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test SPECS]# </FONT><FONT color=#ffff00><B>rpmbuild -ba rp-pppoe.spec</B>&nbsp; </FONT><FONT color=#ffccff>&lt;==打包成SRPM档案</FONT></FONT></TD></TR></TBODY></TABLE>　 <BR>这个时候系统就会这样做： 
<OL>
<LI><FONT color=#000066>先进入到BUILD这个目录中，在Mandrake 9.0当中就是/usr/src/RPM/BUILD，在Red Hat底下就是/usr/src/redhat/BUILD这个目录；</FONT> 
<LI><FONT color=#000066>依照*.spec档案内的Name与Version设定定义出工作的目录名称，以我们上面的例子为例，那么系统就会在BUILD目录中先删除rp-pppoe-3.5的目录，再重新建立一个rp-pppoe-3.5的目录，并进入该目录；</FONT> 
<LI><FONT color=#000066>在新建的目录里面，针对SOURCES目录下的来源档案，也就是*.spec里面的Source设定的那个档案，以tar进行解压缩，以我们这个例子来说，则会在/usr/src/redhat/BUILD/rp-pppoe-3.5当中，将 /usr/src/redhat/SOURCES/rp-pppoe-3.5.tar.gz进行解压缩啦！</FONT> 
<LI><FONT color=#000066>然后就开始%setup的工作；</FONT> 
<LI><FONT color=#000066>再来开始%build及%install的设定与编译！</FONT> 
<LI><FONT color=#000066>最后将完成打包的档案给他放置到该放置的地方去，如果你的规定的硬件是在i386的系统，那么最后编译成功的*.i386.rpm档案就会被放置在/usr/src/RPM/RPMS/i386里面！如果是i586那么自然就是 /usr/src/redhat/RPMS/i586目录下！</FONT> </LI></OL>整个步骤大概就是这样子！最后的结果数据会放置在RPMS那个目录底下就对啦！</BLOCKQUOTE></BLOCKQUOTE>
<HR width="100%">
<A name=myself></A><IMG height=34 alt="" src="33_files/penguin-m[1].gif" width=25 align=middle nosave=""><FONT color=#000099 size=+1>一个打包自己套件的范例</FONT> 
<BLOCKQUOTE>这个就有趣了！我们自己来编辑一下自己制作的RPM怎么样？会很难吗？完全不会！这里简单的以一个小例子来说明喔！请注意，这个真的只是一个小例子，所以不要觉得奇怪喔！其中，比较需要注意的，由于在上面的步骤说明中，我们知道在将SRPM编译成为RPM的时候，会以tar这支程式来将档案解开，因此，<B><FONT color=#000066>我们在进行来源档案的建立时，就必需要将他打包成为一个tar.gz的tarball的档案才行</FONT></B>！</BLOCKQUOTE>
<BLOCKQUOTE>假设我们编辑了一支script，内容是这样： <BR>　 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>cd /usr/src/redhat/SOURCES</FONT></B></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test SOURCES]# </FONT><B><FONT color=#ffff00>vi showvbird.sh</FONT></B></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>#!/bin/bash</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1># This file is just used to demo the RPM packaging.</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1># the only thing is showing the hostname.</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>HOST=`/bin/hostname`</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>/bin/echo $HOST</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test SOURCES]# </FONT><B><FONT color=#ffff00>chmod 755 showvbird.sh</FONT></B></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test SOURCES]# </FONT><B><FONT color=#ffff00>tar Czcvf showvbird.tar.gz showvbird.sh</FONT></B></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 注意了，我们必需要将他打包才行！</FONT></TD></TR></TBODY></TABLE>　 <BR>上面的动作中，我们编辑了一个shell script档案，档名为showvbird.sh，并且将他打包成为具有gzip压缩的tarball档案，也就是showvbird.tar.gz这样的档案才行！请注意，这个showvbird.tar.gz档案『必需』放置在SOURCES目录之下！</BLOCKQUOTE>
<BLOCKQUOTE>再来则是要编辑那个很重要的*.spec档案！你可以这样简单的编写一下： <BR>　 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><B><FONT color=#ffff00>cd /usr/src/redhat/SPECS</FONT></B></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test SPECS]# </FONT><B><FONT color=#ffff00>vi showvbird.spec</FONT></B></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>Summary:&nbsp;&nbsp; This is a demo RPM package.</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>Name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; showvbird</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>Version:&nbsp;&nbsp; 1.0</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>Release:&nbsp;&nbsp; 1</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>Copyright: GPL</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>Group:&nbsp;&nbsp;&nbsp;&nbsp; VBird's Home</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffff00>Source:&nbsp;&nbsp;&nbsp; showvbird.tar.gz&nbsp;&nbsp;</FONT><FONT color=#ffccff> &lt;==这个就是刚刚建立起来的Tarball档案！</FONT></FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>Url:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://linux.vbird.org</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>Packager:&nbsp; VBird</FONT><FONT color=#ffff00></FONT> 
<P><FONT face=SimSun color=#ffff00 size=-1>%description</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>This package is just a demo RPM.</FONT><FONT color=#ffff00></FONT> </P>
<P><FONT face=SimSun color=#ffff00 size=-1>%prep</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>%setup Cc</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>%install</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>install -m 755 showvbird.sh /usr/local/bin/showvbird.sh</FONT><FONT color=#ffff00></FONT> </P>
<P><FONT face=SimSun color=#ffff00 size=-1>%files</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>/usr/local/bin/showvbird.sh</FONT></P></TD></TR></TBODY></TABLE>　 <BR>好了！开始给他编译并打包成为RPM档案啦！ <BR>　 
<TABLE cols=1 width=500 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root @test SPECS]# </FONT><B><FONT color=#ffff00>rpmbuild -bb showvbird.spec</FONT></B></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>….(略)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Wrote: /usr/src/redhat/RPMS/i586/showvbird-1.0-1.i586.rpm</FONT></TD></TR></TBODY></TABLE>　 <BR>最后这个被打包成功的档案就被放置在/usr/src/redhat/RPMS/i586/showvbird-1.0-1.i586.rpm！然后给他安装一下： <BR>　 
<TABLE cols=1 width=620 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test SPECS]# </FONT><B><FONT color=#ffff00>rpm Civh /usr/src/RPM/RPMS/i586/showvbird-1.0-1.i586.rpm</FONT></B></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Preparing...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ########################################### [100%]</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>&nbsp;&nbsp; 1:showvbird&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ########################################### [100%]</FONT> 
<P><FONT face=SimSun size=-1><FONT color=#ffffff>[root @test SPECS]# </FONT><FONT color=#ffff00>rpm Cqi showvbird</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : showvbird&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Relocations: (not relocateable)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Version&nbsp;&nbsp;&nbsp;&nbsp; : 1.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Vendor: (none)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Release&nbsp;&nbsp;&nbsp;&nbsp; : 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Build Date: Wed 06 Nov 2002 11:27:17 PM CST</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Install date: Wed 06 Nov 2002 11:27:42 PM CST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Build Host: test.linux.org</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Group&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : VBird's Home&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Source RPM: showvbird-1.0-1.src.rpm</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 143&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; License: GPL</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Packager&nbsp;&nbsp;&nbsp; : VBird</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>URL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : http://linux.vbird.org</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Summary&nbsp;&nbsp;&nbsp;&nbsp; : This is a demo RPM package.</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Description :</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>This package is just a demo RPM.</FONT> </P>
<P><FONT face=SimSun size=-1><FONT color=#ffffff>[root @test SPECS]#<B> </B></FONT><B><FONT color=#ffff00>showvbird.sh</FONT></B></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>test.linux.org</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root @test SPECS]# </FONT><B><FONT color=#ffff00>rpm Cql showvbird</FONT></B></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>/usr/local/bin/showvbird.sh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#ffccff> &lt;==嘿嘿！已经记录起来了！自己的软件耶！</FONT></FONT></P></TD></TR></TBODY></TABLE>　 <BR>用很简单的方式，就可以将自己的软件或者程序给他修改与设定妥当！很不错吧！以后您就可以自行设定你的RPM！当然，也可以手动修改您的SRPM的来源档内容！</BLOCKQUOTE>
<HR width="100%">
<A name=rpmortarball></A><IMG height=34 alt="" src="33_files/penguin-m[1].gif" width=25 align=middle nosave=""><FONT color=#000099 size=+1>要选择 RPM 还是 Tarball？</FONT> 
<BLOCKQUOTE><B><FONT color=#000066>优先选择 RPM：</FONT></B> <BR>这一直是个有趣的问题：<FONT color=#000066>『<B>如果我要升级的话，或者是全新安装一个新的套件，那么该选择 RPM 还是 Tarball 来安装呢？</B>』</FONT>！基本上，如果有 RPM 可以提供给您的 distribution 来安装，并且没有严重的相依属性的问题时，呵呵！选择 RPM 来安装会是一个比较好的解决方案， Why ？这是由于刚刚上面就提到的 <A href="#intro_advance">RPM 的好处</A> 啦！可以具有<B><FONT color=#000066>档案与数据均有纪录的优点</FONT><FONT color=#000099>，</FONT></B>这就是上面提到的 <B><FONT color=#000066>/var/lib/rpm</FONT></B> 这个目录里面的数据库，这个记录可以让你在管理上更为便利，包括上面提到的 RPM 的升级、安装、验证与移除等等。尤其是在查询上面！可以让你在管理你的系统上面更为便利。但是 RPM 也不是没有缺点的，包括最为大家所抱怨连连的『<FONT color=#000066>属性相依</FONT>』的问题，每一个不同版本之间，就必须要以不同的 RPM 档案来安装！此外，如果要升级『<FONT color=#000066>某一个套件</FONT>』而已时，通常还需要连带其它的套件也必须要一起升级才行，否则会有问题！此外，当一个套件经过了『<B><FONT color=#000066>大幅度的修改</FONT></B>』之后，通常旧的 RPM 与新的 RPM 之间已经几乎无法『<B><FONT color=#000066>完全兼容</FONT></B>』时，呵呵！那么升级或者是移除的手续可是会累坏人的！例如最近朋友们常常问到的 Apache 1.3.xx 与 2.0.xx 的版本升级问题！由于架构上面差异性太大，加上版本属性相依问题，所以很难得到一个完满的解决方案，这个时候 RPM 就不那么合适了。( <FONT color=#000066><I>除非您要一个一个的将 Apache 移除，连同其相依的套件，然后再将 Apache 一个一个的安装，包括新套件的相依套件！ ^_^ .....我是不会这么做的啦</I>！</FONT> )</BLOCKQUOTE>
<BLOCKQUOTE><B><FONT color=#000066>简易方法：</FONT></B> <BR>如果 RPM 档案并不是这么容易取得的话，这个时候 Tarball 的方式就特别适合您的安装了！这是因为 Tarball 可以自行设定编译时的参数，此外，也可以自行设定『<B><FONT color=#000066>安装路径</FONT></B>』，相当的适合于想要安装『<B><FONT color=#000066>多个不同版本的同一个套件</FONT></B>』的情况( <I><FONT color=#000066>说穿了就是测试机器</FONT></I> )！这是怎么说呢？！由于 RPM 必须要配合系统里面其它的相依属性的套件，所以基本上，他的安装路径( <I><FONT color=#000066>就是每个档案的放置路径</FONT></I> )理论上是必须要放在固定的目录的，就是不能随意的改变他的安装路径。因此，当有两个不同版本的相同套件想要测试的时候，大概一定就得将原先的版本移除之后，才能安装使用新的版本！( <FONT color=#000066><I>此外，由于相依的套件几乎都已经包含在 tarball 当中了，所以安装上面其实并不难啦</I>！</FONT>)</BLOCKQUOTE>
<BLOCKQUOTE>相对于 RPM 的制式格式， tarball 可就灵活多了！你可以自行编译套件并且将他安装在不同的路径，只要在启动的时候选择正确的版本，那么不同版本的套件可以同时的存在于一个系统当中，而且可以透过选择启动的档案来启动不同的版本。当然！<FONT color=#000066>你也可以让 tarball 的安装与 RPM 的安装同时存在于一个系统当中，但是需要特别留意的是，你在启动该套件的时候，千万记得你的启动路径！免得启动到了错误的版本了</FONT>！呵呵！( <I><FONT color=#000066>这也是一个系统存在不同多个版本的套件容易发生的错误！希望大家都能够了解这个问题呢！</FONT></I> )</BLOCKQUOTE>
<BLOCKQUOTE>所以说，为了避免这种路径上的错误困扰，基本上，我们都希望 Tarball 的安装路径可以设定在 Linux 原本就规划要给大家安装的路径『<B><FONT color=#000066> /usr/local </FONT></B>』这个路径下！这样可以省去相当多寻找档案的时间！而且在管理上面也会比较容易！呵呵！</BLOCKQUOTE>
<BLOCKQUOTE>不过， Tarball 最麻烦的地方有几点： 
<UL>
<LI><B><FONT color=#000099>反安装：</FONT></B> <BR>Tarball 最麻烦的地方就在于他的『<FONT color=#000066>解安装</FONT>』了！相当的讨厌！如果是简单的直接将所有的套件安装在一个目录下的话，例如 /usr/local/mrtg 时，那么解安装还算简单，就是将该路径杀掉就 OK 啦！但是如果是类似 sendmail 这一种呢？他的路径都是已经放置死的( 需要在 /etc/sendmail.cf、/etc/mail 底下 )那么追踪反安装的路径就很烦人；</LI></UL>
<UL>
<LI><B><FONT color=#000099>在线查询：</FONT></B> <BR>如果您的安装路径是在 /usr/local 底下的话，那么执行档会被放置到 /usr/local/bin ，或者是 /usr/local/sbin 底下，参数档会放在 /usr/local/etc 底下，在线查询档案会放在 /usr/local/man 底下，所以在设定上面还有查询上面还算简单( 路径设定一下即可！ )，不过，如果你是将套件安装在单独的路径下呢？例如 /usr/local/mrtg 底下，那么执行档变成了 /usr/local/mrtg/bin 底下，最麻烦的地方就是 man page ( 在线查询 )放置的地点会变成在 /usr/local/mrtg/man 底下了！糟糕！那么预设的 man page 路径就找不到该说明文件！<FONT color=#000066><B>这个时候就必须要手动的将该路径加入 /etc/man.conf 这个档案中</B>！</FONT>而且执行文件放置的路径也没有指定，可以经由 (1)Link 的方式或者 (2)设定 PATH 环境变量的方式将该路径加进去啦！确实是比较麻烦的啦！</LI></UL>所以说，RPM 与 Tarball 各有其优缺点，不过，如果有 RPM 的话，那么优先权还是在于 RPM 安装上面，毕竟管理上比较便利，但是如果套件的架构差异性太大，或者是无法解决相依属性的问题，那么与其花大把的时间与精力在解决属性相依的问题上，还不如直接以 tarball 来安装，轻松又惬意！</BLOCKQUOTE>
<HR width="100%">
<A name=important></A><IMG height=34 alt="" src="33_files/penguin-m[1].gif" width=25 align=middle nosave=""><FONT color=#000099 size=+1>重点回顾</FONT> 
<UL>
<LI><FONT color=#000066>RPM 的全名是 Red Hat Package Manager，原本是由 Red Hat 公司所发展的，流传甚广；</FONT> 
<LI><FONT color=#000066>RPM 类型的套件中，所含有的套件是经过编译后的 binary file ，所以可以直接安装在使用者端( Client )的系统上，不过，也由于如此，所以 RPM 对于安装者的环境要求相当严格；</FONT> 
<LI><FONT color=#000066>RPM 除了将套件安装至使用者的系统上之外，还会将该套件的版本、名称、档案与目录配置、系统需求等等均记录于数据库( /var/lib/rpm )当中，方便未来的查询与升级、移除；</FONT> 
<LI><FONT color=#000066>RPM 可针对不同的硬件等级来加以编译，制作出来的档案可于附档名( i386, i586, i686 )来分辨；</FONT> 
<LI><FONT color=#000066>RPM 最大的问题为套件之间的相依性问题；</FONT> 
<LI><FONT color=#000066>SRPM 为 Source RPM ，内含的档案为 Source code 而非为 binary file ，所以安装 SRPM 时还需要经过 compile ，不过，SRPM 最大的优点就是可以让使用者自行修改设定参数( makefile/configure 的参数 )，以符合使用者自己的 Linux 环境；</FONT> </LI></UL>
<HR width="100%">
<A name=reference></A><IMG height=34 alt="" src="33_files/penguin-m[1].gif" width=25 align=middle nosave=""><FONT color=#000099 size=+1>参考资源</FONT> 
<BLOCKQUOTE>刚刚最前面说过了，套件升级最主要的考虑就是『安全性』啦！所以请随时注意安全性方面的问题！目前国内的主要安全网站为：『<A href="http://www.cert.org.tw/cindex.htm" target=_blank>台湾网络危机处理小组</A>』这个组织，请随时注意上面发布的新闻！另外，如果跟鸟哥一样使用的是 Red Hat 的 distrubution 的话，那么 Red Hat 的 Errata 网页则不可不光临！好啦！底下列出几个 RPM 相关的网页与 Red Hat 的 Errata 网页提供大家参考！ 
<UL>
<LI>RPM 包装档案管理程序：<A href="http://www.study-area.org/tips/rpm.htm" target=_blank>http://www.study-area.org/tips/rpm.htm</A> 
<LI>中文 RPM HOW-TO：<A href="http://www.linux.org.tw/CLDP/RPM-HOWTO.html" target=_blank>http://www.linux.org.tw/CLDP/RPM-HOWTO.html</A> 
<LI>RPM 的使用：<A href="http://linux.tnc.edu.tw/techdoc/rpm-howto.htm" target=_blank>http://linux.tnc.edu.tw/techdoc/rpm-howto.htm</A> 
<LI>大家来作 RPM ：<A href="http://freebsd.ntu.edu.tw/bsd/4/3/2/29.html" target=_blank>http://freebsd.ntu.edu.tw/bsd/4/3/2/29.html</A> 
<LI>一本 RPM 的原文书：<A href="http://linux.tnc.edu.tw/techdoc/maximum-rpm/rpmbook/" target=_blank>http://linux.tnc.edu.tw/techdoc/maximum-rpm/rpmbook/</A> 
<LI>Red Hat 的 Errata 网页：<A href="http://www.redhat.com/apps/support/errata/" target=_blank>http://www.redhat.com/apps/support/errata/</A> </LI></UL></BLOCKQUOTE>
<HR width="100%">
<A name=FAQ></A><IMG height=34 alt="" src="33_files/penguin-m[1].gif" width=25 align=middle nosave=""><FONT color=#000099 size=+1>课后练习</FONT> 
<UL>
<LI>简单说明 RPM 与 SRPM 的异同？ 
<LI>查询系统上的 RPM 套件数据时，系统由何处取得该套件的讯息？(/var/lib/rpm/*) 
<LI>假设我想要安装一个套件，例如 pkgname.i386.rpm ，但却老是发生无法安装的问题，请问我可以加入哪些参数来强制安装他？ 
<LI>承上题，您认为强制安装之后，该套件是否可以正常执行？为什么？ 
<LI>有些人使用 OpenLinux 3.1 Server 安装在自己的 P-166 MMX ，却发现无法安装，在查询了该原版光盘的内容，发现里面的文件名称为 ***.i686.rpm 。请问，无法安装的可能原因为何？ 
<LI>请问我使用 rpm -Fvh *.rpm 及 rpm -Uvh *.rpm 来升级时，，两者有何不同？ </LI></UL>
<CENTER><FONT color=#3333ff size=+1><A href="http://linux.vbird.org//linux_basic/0520rpm_and_srpm.php" target=_self><FONT face="Times New Roman,Times">RPM </FONT><FONT face=SimSun>与</FONT><FONT face="Times New Roman,Times"> SRPM </FONT><FONT face=SimSun>套件管理员</FONT></A></FONT></CENTER>
<HR width="100%">
<FONT face=SimSun color=#000066 size=-1>2002/08/21：第一次完成</FONT> <BR><FONT face=SimSun color=#000066 size=-1>2003/02/11：重新编排与加入 FAQ</FONT> <BR><FONT face=SimSun color=#000066 size=-1>2004/04/11：已经完成了 <A href="http://linux.vbird.org//linux_basic/0520source_code_and_tarball.php">Source code 与 Tarball </A>，开始进行 RPM 与 SRPM 的介绍！(需要耗时多日啊！因为又要进兵营去了！)</FONT> <BR><FONT face=SimSun color=#000066 size=-1>2004/04/20：终于给他熬出来啦！又是过了两个休假期间～啊！给我退伍令、其余免谈！</FONT> <BR>
<HR width="100%">
<FONT face=SimSun color=#3333ff size=-1>2002/12/04 以来统计人数</FONT> <BR><IMG height=15 src="34_files/Count[6].gif" width=60 align=middle nosave="">
<HR width="100%">
 
<CENTER><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 nosave=""></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 nosave=""></A> <BR><FONT color=#000066 size=-1>Designed by <A href="mailto:vbird@tsai.adsldns.org">VBird</A> during 2001-2004.&nbsp; Aerosol Lab.</FONT></CENTER></BODY>