<HEAD><TITLE>鳥哥的 Linux 私房菜 -- Code Red 偵測法</TITLE>
<META http-equiv=Content-Type content="text/html; charset=big5">
<META content="Mozilla/4.5 [zh-TW] (WinNT; I) [Netscape]" name=GENERATOR>
<META content="strart 101" name="Microsoft Theme">
<META content="tl, default" name="Microsoft Border">
<META content=VBird name=Author>
<STYLE>
      <!--
      body{background-image=url("100_files/VBirdLinux[1].jpg");background-attachment=fixed}
      -->
   </STYLE>
</head>
<BODY style="CURSOR: auto" background="100_files/VBirdLinux[1].jpg" nosave>
<CENTER><B><FONT color=#3333ff><FONT size=+2><FONT face=標楷體>鳥哥的</FONT><FONT face="Times New Roman,Times"> Linux </FONT><FONT face=標楷體>與</FONT><FONT face="Times New Roman,Times"> ADSL </FONT><FONT face=標楷體>私房菜</FONT></FONT></FONT></B> <BR><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 NOSAVE></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 NOSAVE></A> <BR>
<HR width="100%">
</CENTER><FONT face=標楷體><FONT color=#3333ff><FONT size=+2>偵測紅色警戒文件</FONT></FONT></FONT> 
<DIV align=right><FONT face=新細明體><FONT color=#3333ff><FONT size=-1>最近更新日期：2001/09/17</FONT></FONT></FONT></DIV>
<HR width="100%">
<BR><FONT size=+1><FONT color=#3333ff>針對目前很兇狠的 CodeRed（紅色警戒病蟲）在 RedHat 下的偵測方法</FONT>：</FONT> 
<UL><FONT face="Times New Roman Baltic"><FONT color=#000099>前言：</FONT></FONT> <BR><FONT face="Times New Roman Baltic"><FONT color=#000000>這隻病蟲對於 Linux 並不會有危害，但是對於微軟的視窗（尤其是 windows2000 伺服器）則攻擊得很凶，雖然有消息指出可能是大陸方面的傑作，但是已經造成這麼大的問題了，我們應該好好來防制一下囉！</FONT></FONT></UL>
<UL><FONT face="Times New Roman Baltic"><FONT color=#000099>入侵方向與分析原理：</FONT></FONT> <BR><FONT face="Times New Roman Baltic"><FONT color=#000000>其實這隻病蟲主要是針對微軟在 WWW server 的漏洞進行破壞的行為，我們知道 WWW Server 的 port （可想成是通訊通道）是 80 （請參考 <A href="http://linux.vbird.org/linux_server/redhat6.1/linux_26wwwapache.php">WWW Server </A>那一篇文章吧），而</FONT><FONT color=#3333ff>紅色警戒就是藉由 80 port 來登入伺服器的 WWW 服務</FONT><FONT color=#000000>，然後再進行破壞行為。那由於 Linux 的主機若有開放 port 80 作為 WWW 伺服器的話，就會有登錄檔呀！那如果紅色警戒這隻病蟲嘗試來登入你的 Linux 系統時，由於他是經由 port 80，所以就會在你的網頁伺服器的登錄檔中留下記錄，通常如果你是照鳥哥的方法來編譯的你的 WWW Apache Server 時，則你的 WWW 網頁登錄檔應該是在 /usr/local/apache/logs/access_log 這個檔案，這個檔案的內容有點像這樣：</FONT></FONT> <BR>&nbsp; 
<TABLE cols=1 width="90%" bgColor=#000000>
<TBODY>
<TR>
<TD><FONT face=細明體><FONT color=#ffffff><FONT size=-1>61.224.44.98 - - [17/Sep/2001:15:43:28 +0800] "GET /~vbird/linux_live/index.php HTTP/1.0" 200 893</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>211.74.244.91 - - [17/Sep/2001:15:43:28 +0800] "GET /~vbird/linux_live/index.php HTTP/1.1" 200 905</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>211.74.210.189 - - [17/Sep/2001:15:43:29 +0800] "GET /~vbird/linux_live/index.php HTTP/1.1" 200 905</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>140.116.44.172 - - [17/Sep/2001:15:43:33 +0800] "GET /~vbird/linux_live/index.php HTTP/1.1" 200 977</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>61.217.51.146 - - [17/Sep/2001:15:43:53 +0800] "GET /favicon.ico HTTP/1.1" 404 294</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffff00><FONT size=-1>140.116.227.80 - - [17/Sep/2001:15:43:56 +0800] "GET /default.ida?XXXXXXXXXXXXXX</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffff00><FONT size=-1>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffff00><FONT size=-1>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffff00><FONT size=-1>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX%u9090%u6858%ucbd3%u7801%u9090</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffff00><FONT size=-1>%u6858%ucbd3%u7801%u9090%u6858%ucbd3%u7801%u9090%u9090%u8190%u00c3%u0003%u8b00%u</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffff00><FONT size=-1>531b%u53ff%u0078%u0000%u00=a&nbsp; HTTP/1.0" 404 282</FONT></FONT></FONT> <BR><FONT face=細明體><FONT color=#ffffff><FONT size=-1>211.74.244.91 - - [17/Sep/2001:15:43:59 +0800] "GET /~vbird/linux_live/index.php HTTP/1.1" 200 827</FONT></FONT></FONT></TD></TR></TBODY></TABLE><FONT color=#000000>像上面這個例子中，第一行中，61.224.44.98 指的是使用你 WWW 伺服器的主機名稱，後面接的是登入的日期，然後 GET 後面接的是 WWW 伺服器傳送的檔案，而在</FONT><FONT color=#3333ff>黃色的部分則是當 CodeRed 嘗試登入你的 WWW 伺服器時，由於系統不是 Windows2000 所以會顯示的錯誤訊息</FONT><FONT color=#000000>！因此，我們只要分析登錄檔（access_log）就可以知道哪一個 IP 已經中毒了！（就是看前面的 IP 囉）</FONT></UL>
<UL><FONT face="Times New Roman Baltic"><FONT color=#000099>病蟲的危害性質</FONT><FONT color=#000000>：</FONT></FONT> <BR><FONT face="Times New Roman Baltic"><FONT color=#000000>在已經公布的資料中， Code Red 的危害程度與性質你可以到下面的網頁中查詢道：</FONT></FONT> 
<UL>
<LI><FONT face="Times New Roman Baltic"><FONT color=#000000><A href="http://w5.dj.net.tw/~ggreat/hot/Codered2.htm" target=_blank>金帥（ZLock）防毒中心</A>；</FONT></FONT> 
<LI><FONT face="Times New Roman Baltic"><FONT color=#000000><A href="http://www.trend.com.tw/EncyclopediaV2/vinfo/virusencyclo/default5.asp?VName=CODERED.A" target=_blank>趨勢（Trend）</A>；</FONT></FONT> 
<LI><FONT face="Times New Roman Baltic"><FONT color=#000000><A href="http://netlab.kh.edu.tw/board/view_top.asp?messageid=3120" target=_blank>技術通報</A>；</FONT></FONT> </LI></UL></UL>
<UL><FONT face="Times New Roman Baltic"><FONT color=#000099>實例</FONT><FONT color=#000000>：</FONT></FONT> 
<UL>
<LI><FONT face="Times New Roman Baltic"><FONT color=#000000><A href="http://linux.vbird.org/linux_security/old/01codered_1.txt">在 Linux 下面的第一個例子（參考仁德醫專 周定賢老師 的寫法）</A>：</FONT></FONT> <BR><FONT face="Times New Roman Baltic"><FONT color=#000000>這個例子可以每天將你的主機中，將嘗試侵入你主機的電腦 IP 列出來，並且每 5 分鐘更新一次！</FONT></FONT></LI></UL></UL>
<DT>
<HR width="100%">

<CENTER><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 NOSAVE></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 NOSAVE></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 NOSAVE></A> <BR><FONT color=#000066><FONT size=-1>Designed by <A href="mailto:vbird@mail.vbird.idv.tw">VBird</A> during 2001-2004.&nbsp; Aerosol Lab.</FONT></FONT></CENTER></DT></BODY>