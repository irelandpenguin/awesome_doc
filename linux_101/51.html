<HEAD><TITLE>鸟哥的 Linux 私房菜 -- 限制 Linux 对外的埠口 port limit</TITLE>
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<META content=VBird name=Author>
<META content="Mozilla/4.5 [zh-TW] (WinNT; I) [Netscape]" name=GENERATOR>
<META content=" Linux ν忾_放的 port ，只要是不需要，就o他P掉！" name=Description><!-- saved from url=(0022)http://internet.e-mail -->
<STYLE>
   <!--
   body{background-image=url("51_files/VBirdLinux[1].jpg");background-ATTACHMENT=FIXED}
   -->
</STYLE>
</head>
<BODY background="51_files/VBirdLinux[5].jpg" nosave="">
<CENTER>
<CENTER><B><FONT color=#3333ff size=+2><FONT face=SimSun>鸟哥的</FONT><FONT face="Times New Roman,Times"> Linux </FONT><FONT face=SimSun>与</FONT><FONT face="Times New Roman,Times"> ADSL </FONT><FONT face=SimSun>私房菜</FONT></FONT></B> <BR><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 nosave=""></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 nosave=""></A> <BR>
<HR width="100%">
</CENTER><FONT color=#3333ff size=+2><A href="http://linux.vbird.org/linux_server/0210port_limit.php" target=_self><FONT face=SimSun>限制</FONT><FONT face="Times New Roman,Times"> Linux </FONT><FONT face=SimSun>对外联机的埠口</FONT></A></FONT></CENTER>
<DIV align=right><FONT face=SimSun color=#3333ff size=-1>最近更新日期：2003/09/19</FONT></DIV><FONT color=#000099 size=-2>　</FONT> 
<TABLE cols=1 width="100%" bgColor=#ffcccc border=1>
<TBODY>
<TR>
<TD><FONT color=#000099 size=-1>为什么我们的主机会响应网络上面的一些要求封包呢？例如我们设定了一部 WWW 主机后，当有来自 Internet 的 WWW 要求时，我们的主机就会予以响应，这是因为我们的主机有启用了 WWW 的监听埠口 (port) 啊！这里就要特别留意了，当我们启用了一个 daemon 时，就可能会造成主机的 Port 在进行 Listen 的动作，此时该 daemon 就是已经对网络上面提供服务了！万一这个 daemon 有漏洞，因为他提供 Internet 的服务，所以就容易被 Internet 上面的 cracker 所入侵了！所以说，仔细的检查自己系统上面的 port 到底开了多少个，并且予以严格的管理，才能够降低被入侵的可能性啊！</FONT></TD></TR></TBODY></TABLE><FONT color=#000099 size=-2>　</FONT> <BR><FONT color=#000099><FONT size=+1><A href="#What_is_ports">什么是埠口( port )</A></FONT>：</FONT> <BR><FONT color=#000099>　　：<A href="#What_is_ports_number">总共有多少埠口？哪些是保留的 port ？</A></FONT> <BR><FONT color=#000099>　　：<A href="#What_is_ports_three">Server/Client 联机建立的 TCP 三向交握</A></FONT> <BR><FONT color=#000099>　　：<A href="#What_is_ports_secure">安不安全</A></FONT> <BR><FONT color=#000099><FONT size=+1><A href="#How_to_look_port">如何观察埠口</A></FONT>：</FONT> <BR><FONT color=#000099>　　：<A href="#How_to_look_port_netstat">使用 netstat</A></FONT> <BR><FONT color=#000099>　　：<A href="#How_to_look_port_nmap">使用 nmap</A></FONT> <BR><FONT color=#000099><FONT size=+1><A href="#How_To_Close">如何关闭或启动一个埠口</A></FONT>：</FONT> <BR><FONT color=#000099><FONT size=+1><A href="#open_at_open">设定开机时启动服务的方法</A></FONT>：</FONT> <BR><FONT color=#000099><FONT size=+1>安全性： </FONT><A href="#last_safe">关闭所有对外开放的 port</A></FONT> <BR><FONT color=#000099 size=+1><A href="#ex">课后练习</A></FONT>： <BR>
<HR width="100%">
<A name=What_is_ports></A><FONT color=#000099><FONT size=+1>什么是埠口( port )</FONT>：</FONT> 
<UL>在开始这个章节之前，我们先来聊一聊什么是埠口 ( port ) 呢？常常在网络上听说『<FONT color=#000066>我的主机开了多少的 port ，会不会被入侵呀！</FONT>？』或者是说『<FONT color=#000066>开那个 port 会比较安全？又，我的服务应该对应什么 port 呀</FONT>！？』呵呵！很神奇吧！怎么一部主机上面有这么多的奇怪的 port 呢？这个 port 有什么作用呢？！事实上，一部主机的 port 可分为『<FONT color=#000066>监听, LISTEN</FONT>』与『<FONT color=#000066>随机取用的 high port』</FONT> ： <BR>　 
<UL>
<LI>所谓的 LISTEN 就是您的主机有启动某些服务，那么这个服务就会在 Linux 系统上面启用一个 port 以监听来自 Internet 的要求！例如以 FTP 的服务来说好了，如果您的主机有启用 FTP 这个服务的话，那么主机就会启用 port 21 喔！而且 port 21 是一直启用的，直到 FTP 这个服务关闭为止！ <BR>　 
<LI>那么万一我的主机是要对外主动的联机呢？举例来说好了，我的 Linux 要对外面的 WWW 主机要求数据 ( WWW 主机预设的 port number 为 80 ) ，那么我的 Linux 总是需要启用一个 port 来对外联机吧？！不然数据封包怎么传递？那么启用的 port number 是多少呢？呵呵！Linux 主机会『<FONT color=#000066>随机</FONT>』取用一个没有被使用的<FONT color=#000066>大于 1024 以上</FONT>的 port 来进行这次的联机行为。 </LI></UL>　 <BR>所以，您应该知道 Server/Client 之间的数据传送其实是 port 与 port 之间的递送喔！那就是我们在网络基础里面谈到的 socket pair 当中的一环。那么数据透过这些 port 来进行传送的时候，会不会跑错地方啊？！还记得我们在<A href="http://linux.vbird.org/linux_server/0110network_basic.php">网络基础</A>里头提到的 <A href="http://linux.vbird.org/linux_server/0110network_basic.php#IP">TCP/IP</A> 资料吧？对啦！ <A href="http://linux.vbird.org/linux_server/0110network_basic.php#packet_tcp">TCP</A> 封包在传送的时候，在 TCP 封包的表头 (header) 不是会填有来源与目的之 IP 及 port 吗？在这里您可以这样想，由于每种网络的服务功能都不相同，因此有必要将不同的封包送给不同的服务来处理，所以，当您的主机同时开启了 FTP 与 WWW 服务的时候，那么别人送来的数据封包，就会依照 TCP 表头上面的 port 号码来给 FTP 这个服务或者是 WWW 这个服务来处理，当然就不会搞乱！ ( <I><FONT color=#000066>注：嘿嘿！有些很少接触到网络的朋友，常常会问说：『咦！为什么您的计算机同时有 FTP、WWW、E-Mail 这么多服务，但是人家传数据过来，您的计算机怎么知道如何判断？计算机真的都不会误判吗？！』现在知道为什么了吗？！对啦！就是因为 port 不同嘛！您可以这样想啦，有一天，您要去银行存钱，那个银行就可以想成是『主机』，然后，银行当然不可能只有一种业务，里头就有相当多的窗口，那么您一进大门的时候，在门口的服务人员就会问您说：『嗨！您好呀！您要做些什么事？』您跟他说：『我要存钱呀！』，服务员接着就会告诉您：『喝！那么请前往三号窗口！那边的人员会帮您服务！』这个时候您总该不会往其它的窗口跑吧？！ ^_^""这些窗口就可以想成是『 port 』！所以啦！每一种服务都有特定的 port 在监听！您无须担心计算机会误判的问题呦！ </FONT></I>) <BR>　 <BR>
<HR width="100%">
<A name=What_is_ports_number></A><FONT color=#000099>总共有多少埠口？哪些是保留的 port ？</FONT> <BR>　 <BR>我想，您或许会很好奇，咦！那么通常一般的主机会有多少个 port 呢？！正常来说，<FONT color=#000066>所有的 port 是由 1 ~ 65535 这么多个啦</FONT>！好啦，那么在这些 port 上面有没有保留给系统使用的呢！？是有的！一般而言，<FONT color=#000066>只有 root 才可以启用 1 ~ 1023 以内的 port </FONT>，这些 port 就是特殊的埠口，是保留给系统来使用的！<FONT color=#000066>至于大于 1024 以上的 port 除了给系统随机取用来作为联机的需求之外，也可以用来作为服务的 LISTEN 之用。</FONT>举例来说，如果您觉得 0~1023 的 port 需要以 root 的身份来启动，这样如果该 port 的程序被入侵了，那么入侵者将拥有 root 的权限，这实在很危险～所以，这个时候您可以以一般身份账号并使用大于 1024 以上的 port 来启用某些服务呢！例如 FTP 的 port 预设为 21 ，您也可以将 FTP 以 10021 的 port number 来启动，并且使用一般身份的账号来启用这个 FTP 的服务，会比较安全一点。不过，这样一来会造成 client 端的困扰，因为一般 FTP Client 软件都是预设以连接到主机的 port 21 来进行联机的，现在您的主机 FTP 改成 10021 了，除非您的 Client 知道这个设定值，否则 Client 软件就无法联机成功了。 <BR>　 <BR>好了，那么您应该又会说，这些保留的 port ( 或称为 well know )有什么特殊的功能呢？！这些 well know 的埠口其实是目前一些 Internet 上面常见的 Services 所惯用的埠口咯，为了保留给这些埠口给特殊的服务使用，以避免不小心被使用者或者是 Client 端软件给占用了，所以就需要订定这样的保留功能。此外，因为这些 port 是目前 Internet 上面所惯用的，所以一些程序开发者在进行软件的开发时，就能够针对这些 well know 的埠口直接来开发，大家也比较容易使用服务器的功能啊！ <BR>　 <BR>至于这些 well know 的埠口与他所对应的服务 (services) 其实已经在我们的 Linux 系统当中存在一个对照表了，那就是 /etc/services 这个档案！我们在 <A href="http://linux.vbird.org/linux_server/0140networkcommand.php">Linux 常用网络指令</A>里面提到的 <A href="http://linux.vbird.org/linux_server/0140networkcommand.php#netstat">netstat</A> 的功能时，有没有加上 -n 这个参数是有影响的！当不加 -n 这个参数时，直接下达『 <FONT face=SimSun color=#000066>netstat -tl </FONT>』竟然可以告诉我目前正在 LISTEN 的服务名称！嘿嘿！这就是 /etc/services 的功能啦！此外， /etc/services 也是某些服务在启动的时候，设定 port number 的重要依据，例如 <A href="http://linux.vbird.org/linux_server/0400wuftp.php">Wu-FTP</A> 的埠口就是由这个档案来控管的。来看一看 /etc/services 的几个主要内容吧！ <BR>　 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>vi /etc/services</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>ftp-data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 20/tcp</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>ftp-data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 20/udp</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>ftp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 21/tcp</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>ftp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 21/udp</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 22/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # SSH Remote Login Protocol</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 22/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # SSH Remote Login Protocol</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>telnet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 23/tcp</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>telnet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 23/udp</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>smtp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 25/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mail</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>smtp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 25/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mail</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 53/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nameserver&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # name-domain server</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 53/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nameserver</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>bootps&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 67/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # BOOTP server</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>bootps&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 67/udp</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>bootpc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 68/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # BOOTP client</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>bootpc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 68/udp</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>http&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 80/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; www www-http&nbsp;&nbsp;&nbsp; # WorldWideWeb HTTP</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>http&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 80/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; www www-http&nbsp;&nbsp;&nbsp; # HyperText Transfer Protocol</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>hostname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 101/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hostnames&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # usually from sri-nic</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>hostname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 101/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hostnames&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # usually from sri-nic</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>pop2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 109/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop-2&nbsp;&nbsp; postoffice&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # POP version 2</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>pop2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 109/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop-2</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>pop3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 110/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop-3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # POP version 3</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>pop3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 110/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop-3</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>sunrpc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 111/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; portmapper&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # RPC 4.0 portmapper TCP</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>sunrpc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 111/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; portmapper&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # RPC 4.0 portmapper UDP</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>auth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 113/tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; authentication tap ident</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>auth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 113/udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; authentication tap ident</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>sftp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 115/tcp</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>sftp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 115/udp</FONT></TD></TR></TBODY></TABLE>　 <BR>
<HR width="100%">
<A name=What_is_ports_three></A><FONT color=#000099>Server/Client 联机建立的 TCP 三向交握</FONT> <BR>　 <BR>除此之外，还记得我们在 <A href="http://linux.vbird.org/linux_server/0110network_basic.php">网络基础</A> 那一篇当中稍微提到，如果需要进行网络联机的时候，那个重要的三向交握( Three-Way Handshake )就不能不理解一下： <BR>　 
<UL>
<LI><FONT color=#000066>每一个 TCP 联机都必须由一端(通常为 client )发起请求，这个 port 通常是随机选择大于 1024 以上的 port 号来进行！其 TCP 封包会将(且只将) SYN (主动联机)旗标设定起来！这是整个联机的第一个封包；</FONT> 
<LI><FONT color=#000066>如果另一端(通常为 Server ) 接受这个请求的话 ( 当然，特殊的服务需要以特殊的 port 来进行，例如 FTP 的 port 21 )，则会向请求端送回整个联机的第二个封包！其上除了 SYN 旗标之外同时还将 ACK (确认)旗标也设定起来，并同时在本机端建立资源以待联机之需；</FONT> 
<LI><FONT color=#000066>然后，请求端获得服务端第一个响应封包之后，必须再响应对方一个确认封包，此时封包只带 ACK 旗标(事实上o后继联机中的所有封包都必须带有 ACK 旗标)r</FONT> 
<LI><FONT color=#000066>只有当服务端收到请求端的确认( ACK )封包(也就是整个联机的第三个封包)之后o两端的联机才能正式建立。这就是所谓的 TCP 联机的『三段式交握( Three-Way Handshake )』的原理。</FONT> <BR>　 <BR><IMG height=215 src="49_files/handshak[1].jpg" width=149 nosave=""> <BR>&nbsp;</LI></UL>经过三向交握之后，呵呵！您的 client 端的 port 通常是高于 1024 的随机取得的 port ，至于主机端则视当时的服务是开启哪一个 port 而定，例如 WWW 选择 80 而 FTP 则以 21 为正常的联机通道！三向交握是相当重要的一个认识喔！因为未来在防火墙的设定上面，这个机制的认知是必须的！ <BR>　 <BR>
<HR width="100%">
<A name=What_is_ports_secure></A><FONT color=#000099>安全不安全？</FONT> <BR>　 <BR>那么了解了这些 port 之后，再来您应该还会问到一个问题呀！那就是『<FONT color=#000066>我怎么知道哪一个 port 比较安全？</FONT>』这里可能要先请您了解一下所谓的『 <FONT color=#000066>port</FONT> 』与『 <FONT color=#000066>服务</FONT> 』对于『 <FONT color=#000066>安全</FONT> 』的相关性！真正影响网络安全的并不是 port 这个东西，而是将 port 启动的那个服务才是重点！举个例子来说好了，您应该偶而会听到『<FONT color=#000066>Wu-ftpd 这个服务不安全，建议大家改用 proftp</FONT> 』对吧！请注意呦！那个 Wu-ftpd 与 proftp ( 这两个都是套件的名称 )都是使用 port 21 这个埠口！嘿嘿！但是 proftp 就是比 wu-ftp 稍微安全一点！晓得了吗？没错！对于安全真正有危害的是『<FONT color=#000066>某些不安全的服务</FONT>』而不是『<FONT color=#000066>开了哪些 port </FONT>』才是！基本上，没有必要的话，一些您想不到或者用不到的 port 都把他关掉了吧！毕竟没有开口总比开了口再来防堵要安全的多吧！！ ^_^""！而且服务套件的版本也需要持续的进行更新喔！</UL>
<HR width="100%">
<A name=How_to_look_port></A><FONT color=#000099><FONT size=+1>如何观察埠口</FONT>：</FONT> 
<UL>好了，我们现在知道这个 port 是什么鬼东西了，再来就是要去『<FONT color=#000066>看他到底在干啥</FONT>？』对吧！没错！再来就是要来了解一下，我们的主机到底是开了多少的 port 呢？如同我们前面说的，您得要先了解一下，我们的『服务』跟『 port 』对应的档案是哪一个？再提醒一次呦！是『<FONT color=#000066> /etc/services</FONT> 』 啦！好了，那么常见的 port 对应的服务有哪些呢？大概有这些啦！ <BR>　 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffff size=-1>服务名称　　　port 号　　　常见套件名称　　　　　　　建议</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>==================================================================================</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>ftp　　　　　 21　　　　　 Wu-ftp, proftp　　　　　　不要开放他！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>telnet　　　　23　　　　　 telnet　　　　　　　　　　不要开放他！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>smtp　　　　　25　　　　　 sendmail, postfix　　　　 除非必要，不然不要启动！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>http　　　　　80　　　　　 apache　　　　　　　　　　除非必要，不然不要启动！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>pop3　　　　 110　　　　　 imap 　　　　　　　　　　 除非是 mail 主机，不然不要开放</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>netbios-ssn　139　　　　　 SAMBA　　　　　　　　　　 除非必要，不然不要启动！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>squid　　　 3128　　　　　 squid　　　　　　　　　　 除非必要，不然不要启动！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>mysql　　　 3306　　　　　 MySQL　　　　　　　　　　 除非必要，不然不要启动！</FONT></TD></TR></TBODY></TABLE>　 <BR><FONT color=#000000>当然还不只这些哩，更详细的信息您应该到您的 Linux 主机之下的 /etc/services 这个档案去看仔细！好了，那么接下来就是要来察看我们主机的 port ！如何察看呢？底下我们介绍两个最常使用的观测指令：</FONT> <BR><FONT color=#000000>　</FONT> 
<UL>
<LI><FONT face=SimSun color=#000066>netstst ： 在本机上面以自己的程序监测自己的 port ，无危险；</FONT> 
<LI><FONT face=SimSun color=#000066>nmap&nbsp;&nbsp;&nbsp; ： 在本机上面，以特殊的侦测程序侦测自己，可能会有违法之虞。</FONT> </LI></UL><FONT color=#000000>　</FONT> <BR><FONT color=#000000>见他的大头王！怎么使用 nmap 会违法？呵呵！别担心，由于 nmap 的功能太强大了，所以很多 cracker ( 怪客，网络上面的闲人 ) 会直接以他来侦测别人的主机，这个时候就可能造成违法啦！只要您使用 nmap 的时候不要去侦测别人的计算机主机，那么就不会有问题啦！ ^_^"" 底下我们分别来说一说这两个宝贝吧！</FONT> <BR><FONT color=#000000>　</FONT> <BR>
<HR width="100%">
<A name=How_to_look_port_netstat></A><FONT color=#000099><FONT face=SimSun>使用 netstat</FONT> 指令：</FONT> <BR><FONT color=#000000>　</FONT> <BR><FONT color=#000000>如前所述，在做为主机的 Linux 系统中，</FONT><FONT color=#000066>服务项目是越少越好</FONT><FONT color=#000000>！这样可以避免不必要的入侵管道喔！因此，这个时候请了解一下您的系统当中，有没有哪些服务被开启了呢？要了解自己的系统当中的服务项目，最简便的方法就是使用 <A href="http://linux.vbird.org/linux_server/0140networkcommand.php#netstat">netstat</A> 了！这个东西不但简单 ( 每一部 Linux 机器当中预设都会安装的套件喔！ ) ，而且功能也是很不错的。这个指令的使用方法在 <A href="http://linux.vbird.org/linux_server/0140networkcommand.php#netstat">Linux 常用网络功能</A>指令介绍当中提过了，底下我们仅提供如何使用这个工具的方法！</FONT> <BR>　 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>netstat</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Active Internet connections (w/o servers)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Proto Recv-Q Send-Q Local Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Foreign Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>t</FONT><FONT color=#ffff99>cp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 20 192.168.1.2:ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.1.11:1391&nbsp;&nbsp;&nbsp;&nbsp; ESTABLISHED</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Active UNIX domain sockets (w/o servers)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Proto RefCnt Flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I-Node Path</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 10&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 768&nbsp;&nbsp;&nbsp; /dev/log</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 304058</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 303994</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 303972</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70794</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70743</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 27533</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 895</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 785</FONT></TD></TR></TBODY></TABLE>　 <BR><FONT color=#000000>如上所示，单纯使用 netstat 的时候，仅『</FONT><FONT color=#000066>列出目前已经接通的服务项目与服务名称</FONT><FONT color=#000000>』所以您可以看到，由于目前仅有一个 ssh 的联机建立成功，所以就只有显示出一个 </FONT><FONT color=#000066>ESTABLISHED ( 联机中的意思 ) </FONT><FONT color=#000000>的项目。上面第三行以 tcp 开头的那一行，表示『</FONT><FONT color=#000066>有一个 ssh 的服务开启通道联机中，是由远程 client 的 192.168.1.11 这个 IP 连接到 192.168.1.2 的主机上面的这个 IP ，而 Client 端联机的通道是以 1391 这个通道连接进入 ssh 的服务中的！</FONT><FONT color=#000000>』。这里这个 ssh 所显示的服务名称就是在 /etc/services 里面记载的！那如果我需要将所有的项目都列出来呢？例如说：有哪些 port 目前正在监听呢？！</FONT> <BR>　 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>netstat -a</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>AActive Internet connections (servers and established)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Proto Recv-Q Send-Q Local Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Foreign Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:pop3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:imap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:ftp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:smtp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 20 192.168.1.2:ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.1.11:1391&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ESTABLISHED</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:1238&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Active UNIX domain sockets (servers and established)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Proto RefCnt Flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I-Node Path</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 10&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 768&nbsp;&nbsp;&nbsp; /dev/log</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 304058</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 303994</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 303972</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70794</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70743</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 27533</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 895</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 785</FONT></TD></TR></TBODY></TABLE>　 <BR><FONT color=#000000>如上所示，加入 -a ( all )就是说将所有在机器上所有的 port 的状态列出的意思，不过，服务的名称已经使用 </FONT><FONT color=#000066>/etc/services</FONT><FONT color=#000000> 里面的名称了，而不是使用 port 的数字！如上所示，目前我主机上面的服务共开启了：『 pop3、imap、ftp、ssh、smtp 』等服务 (</FONT><FONT color=#000066>就是在 tcp 封包里头的具有 LISTEN 的那几个咚咚</FONT><FONT color=#000000>！) 至于已经建立的服务就只有 ssh 这一个！那如果我想要知道 port 的号码呢？呵呵，就使用底下的指令吧！</FONT> <BR>　 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>netstat -an</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Active Internet connections (servers and established)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Proto Recv-Q Send-Q Local Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Foreign Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:110&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:143&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 20 192.168.1.2:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.1.11:1391&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ESTABLISHED</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>udp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:1238&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Active UNIX domain sockets (servers and established)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Proto RefCnt Flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I-Node Path</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 10&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 768&nbsp;&nbsp;&nbsp; /dev/log</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 304058</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 303994</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 303972</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70794</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 70743</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 27533</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 895</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 785</FONT></TD></TR></TBODY></TABLE>　 <BR><FONT color=#000000>如上所示，我接通的服务通道只有 22 这一个，而其它的您可以参照上面的指令输出结果来对照，所以您就可以知道：pop3 为 110 而 imap 为 143 呵呵！就是这样！因此，透过此一指令，就可以轻易的了解目前主机的运作状况与服务状态！当然， netstat 的用途不止于此，您可以使用 </FONT><FONT color=#000066>man <A href="http://linux.vbird.org/linux_server/0140networkcommand.php#netstat">netstat</A></FONT><FONT color=#000000> 来查阅一番喔！相信对您的主机会有更大的了解呦！</FONT> <BR>　 <BR><FONT color=#000000>相信有不少的朋友都会有这个困扰，就是</FONT><FONT color=#000066>要怎样删除已经建立的联机呢？</FONT><FONT color=#000000>因为总有些不速之客会连到您的主机来进行一些破坏的工作！或者是您根本不想让对方联机过来！呵呵！还记得 <A href="http://linux.vbird.org/linux_basic/0440processcontrol.php">鸟哥的 Linux 私房菜--基础学习篇内的资源管理</A> 里面提到的几个常用的指令吧！？那就是找出那个联机程序的 PID ，然后给他 <A href="http://linux.vbird.org/linux_basic/0440processcontrol.php#kill">kill</A> 掉就是了！简单呀！不过，大问题是『</FONT><FONT color=#000066>我要怎样找出联机的 PID 呀！</FONT><FONT color=#000000>？』呵呵！由于 PID 的管理与整体的系统资源有关，这个时候，虽然可以使用 netstat 来观察 PID ，不过</FONT><FONT color=#000066>只有 root 可以观察到联机状态的 PID 号码</FONT><FONT color=#000000>呦！( 注：还记得资源管理提及的 PID 概念吗？就是说，在 Linux 系统之内，每个『程序』系统都会给予一个号码来管理！这个就是 PID ！)</FONT> <BR>　 
<TABLE cols=1 width=700 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> netstat -ap</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Active Internet connections (servers and established)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Proto Recv-Q Send-Q Local Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Foreign Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PID/Program name</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 *:ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32149/sshd</FONT> <BR><I><FONT face=SimSun color=#ffffcc size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 284 140.116.141.19:ssh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.1.11:1391&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ESTABLISHED 24751/sshd</FONT></I> <BR><FONT face=SimSun color=#ffffff size=-1>Active UNIX domain sockets (servers and established)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Proto RefCnt Flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I-Node PID/Program name&nbsp;&nbsp;&nbsp; Path</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 944&nbsp;&nbsp;&nbsp; 509/syslogd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /dev/log</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3035915 16648/xinetd</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 739227 5951/pppoe</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 739189 5949/pppd</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1070&nbsp;&nbsp; 628/crond</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 953&nbsp;&nbsp;&nbsp; 514/klogd</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STREAM&nbsp;&nbsp;&nbsp;&nbsp; CONNECTED&nbsp;&nbsp;&nbsp;&nbsp; 690&nbsp;&nbsp;&nbsp; 1/init [3]</FONT></TD></TR></TBODY></TABLE>　 <BR><FONT color=#000000>看到上面那个斜体字的联机建立的网络状态了吗？嘿嘿！最后面一栏就是显示那个 PID/Program name ，那个 PID ( 上面是 24751 )也就是我们要来砍掉的啦！这个时候，如果要将该联机砍掉时，就直接以 <A href="http://linux.vbird.org/linux_basic/0440processcontrol.php#kill">kill</A> 来做吧！</FONT> <BR>　 
<TABLE cols=1 width=700 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]#</FONT><FONT color=#ffff00> kill -9 24751</FONT></FONT></TD></TR></TBODY></TABLE>　 <BR><FONT color=#000000>这样就能将该联机给他『踢出去』您的主机啦！！ ^_^""</FONT> <BR>　 <BR>
<HR width="100%">
<A name=How_to_look_port_nmap></A><FONT color=#000099>使用 nmap 套件：注意安全！</FONT> <BR><FONT color=#000099>　</FONT> 
<DT><FONT color=#000000>在本机上面观察 port 最好是使用 netstat 啦！因为他安全又可靠！但是，由于可能有某些 port 会寻找不到，或者不晓得那些 port 是干嘛用的，尤其是 /etc/services 里头没有提到的几个 port 对应的服务！这个时候怎么办？！没关系，不要紧，我们这个时候可以使用那个很流行的『黑客指令』，就是 nmap 这个东西啦！nmap 的套件说明之名称为：『</FONT><FONT color=#000066>Network exploration tool and security scanner</FONT><FONT color=#000000>』，顾名思义，这个东西是被系统管理员用来管理系统安全性查核的工具！他的具体描述当中也提到了， nmap 可以经由内部自行定义的几个 port 对应的指纹数据，来查出该 port 的服务为何，所以我们也可以藉此了解我们主机的 port 到底是干嘛用的！如果您是安装 Linux 是 Red Hat 版本的话，那么这个 nmap 套件应该已经安装妥当了，万一没有这个套件的话，也可以来到底下的网站下载：</FONT> 
<DT><FONT color=#000000>　</FONT> 
<UL>
<LI><FONT color=#000000><A href="http://linux.vbird.org/download/#nmap" target=_blank>http://linux.vbird.org/download/#nmap</A></FONT> </LI></UL>　 
<TABLE cols=1 width=550 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>nmap &lt;扫瞄类型&gt; &lt;扫瞄参数&gt; &lt;Hosts 地址与范围&gt;</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>参数说明：</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>&lt;扫瞄类型&gt;：主要的扫瞄类型有底下几种：</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　-sT：扫瞄 TCP 封包已建立的联机 connect() ！</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　-sS：扫瞄 TCP 封包带有 SYN 卷标的数据</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　-sP：以 ping 的方式进行扫瞄</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　-sU：以 UDP 的封包格式进行扫瞄</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　-sO：以 IP 的协议 ( protocol ) 进行主机的扫瞄</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>&lt;扫瞄参数&gt;：主要的扫瞄参数有几种：</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　-PT：使用 TCP 里头的 ping 的方式来进行扫瞄，可以获知目前有几部</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　　　 计算机存活(较常用)</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　-PI：使用实际的 ping (带有 ICMP 封包的) 来进行扫瞄</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　-p ：这个是 port range ，例如 1024-, 80-1023, 30000-60000 等等的使用方式</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>&lt;Hosts 地址与范围&gt;：这个有趣多了，有几种类似的类型</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　192.168.0.100&nbsp; ：直接写入 HOST IP 而已，仅检查一部；</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　192.168.0.0/24 ：为 C Class 的型态，</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　192.168.*.*　　：嘿嘿！则变为 B Class 的型态了！扫瞄的范围变广了！</FONT> <BR><FONT face=SimSun color=#ffffcc size=-1>　　192.168.0.0-50,60-100,103,200 ：这种是变形的主机范围啦！很好用吧！</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>范例：</FONT> 
<P><FONT face=SimSun color=#ffffcc size=-1>例题一：扫瞄单一部计算机！</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>nmap localhost　　</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 没有加上任何参数，由 nmap 的预设参数来进行扫瞄</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Starting nmap V. 2.54BETA22 ( www.insecure.org/nmap/ )</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Interesting ports on vbird.adsldns.org (127.0.0.1):</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>(The 1539 ports scanned but not shown below are in state: closed)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Service</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>21/tcp&nbsp;&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ftp</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>22/tcp&nbsp;&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ssh</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>23/tcp&nbsp;&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; telnet</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Nmap run completed -- 1 IP address (1 host up) scanned in 1 second</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 由上面可以看出我的系统目前共有 21, 22, 23 这三个 port 开放！而且</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 各 port 对应的服务也被查出来了！</FONT> </P>
<P><FONT face=SimSun color=#ffffcc size=-1>例题二：扫瞄单一部计算机的较少数 port 号码！</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>nmap -p 1024-65535 localhost</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 仅扫瞄较少数的 port 啦！</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Starting nmap V. 2.54BETA22 ( www.insecure.org/nmap/ )</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Interesting ports on pc510.ev.ncku.edu.tw (127.0.0.1):</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>(The 64511 ports scanned but not shown below are in state: closed)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Service</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>3306/tcp&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mysql</FONT><FONT color=#ff6666> &lt;==只有这个 port 被找出来！</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Nmap run completed -- 1 IP address (1 host up) scanned in 11 seconds</FONT> </P>
<P><FONT face=SimSun color=#ffffcc size=-1>例题三：直接以 Ping 的方式扫瞄数个计算机！</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root @test /root]# </FONT><FONT color=#ffff00>nmap -PT 192.168.1.171-177&nbsp;</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 看到了吧！扫瞄一个区段的活着的计算机！</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>Starting nmap V. 2.54BETA22 ( www.insecure.org/nmap/ )</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Interesting ports on linux172 (192.168.1.172):</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>(The 1536 ports scanned but not shown below are in state: closed)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Service</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>110/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop-3</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>135/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; loc-srv</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>139/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; netbios-ssn</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>445/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; microsoft-ds</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>1025/tcp&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; listen</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>1110/tcp&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nfsd-status</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>Interesting ports on linux174 (192.168.1.174):</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>(The 1537 ports scanned but not shown below are in state: closed)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Service</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>110/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop-3</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>135/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; loc-srv</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>139/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; netbios-ssn</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>445/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; microsoft-ds</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>1025/tcp&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; listen</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>Interesting ports on linux176 (192.168.1.176):</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>(The 1537 ports scanned but not shown below are in state: closed)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Service</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>110/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop-3</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>135/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; loc-srv</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>139/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; netbios-ssn</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>445/tcp&nbsp;&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; microsoft-ds</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>1025/tcp&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; listen</FONT> </P>
<P><FONT face=SimSun color=#ffffff size=-1>Nmap run completed -- 7 IP addresses (3 hosts up) scanned in 1 second</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>瞧！我要侦测的只有七部计算机，所以这七部计算机只会响应给我！而其中只有三部有启动，所以当然就只会有三段响应啦！这个方式蛮适合一次扫瞄您的子网域内的所有计算机呢！ ^_^"</FONT></P></TD></TR></TBODY></TABLE>
<DT><FONT color=#000000>　</FONT> 
<DT><FONT color=#000000>请特别留意，这个 nmap 的功能相当的强大，也是因为如此，所以很多刚在练习的黑客会使用这个软件来进行侦测别人的计算机，这个时候请您特别留意，目前很多的人已经都有『特别的方式』来进行登录的工作！例如以 <A href="http://linux.vbird.org/linux_server/0250simple_firewall.php#TCP_Wrappers">TCP_Wrappers ( /etc/hosts.allow, /etc/hosts.deny ) </A>的功能来记录曾经侦测过该 port 的主机 IP！这个软件用来『</FONT><FONT color=#000066>侦测自己机器的安全性</FONT><FONT color=#000000>』是很不错的一个工具，但是如果用来侦测别人的主机，可是可能会『吃上官司』的！特别留意！！</FONT> </DT></UL>
<DT>
<HR width="100%">
<A name=How_To_Close></A><FONT color=#000099><FONT size=+1>如何关闭或启动一个埠口</FONT>：</FONT> 
<UL>既然已经知道了有多少个 port 被启动或关闭，那么接着下来当然就是要将一些不安全的服务给他关闭！呵呵！那么该如何关闭呢？请注意：『<FONT color=#000066>开或关一个 port 的方式是：开启或关闭一个服务即可！</FONT>』例如您要关闭 port 21 这个较为危险的 ftp 的埠口，那么就是将 wu-ftp 或者是 proftp 关掉就对啦！关掉他自然就连同 port 也关掉！ ^_^"" 所以说，当您侦测完了 port 之后，接着下来就是找出该 port 的对应的服务，将该服务给关掉，就会把 port 关啦！嗯！我们来试试看关掉一个 25 port 好了！由于 25 port 是由 sendmail 来进行 smtp 的启动的，那么我们就先来启动他： <BR>　 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>/etc/rc.d/init.d/sendmail start</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>Starting sendmail:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [&nbsp; </FONT><FONT color=#ffff99>OK</FONT><FONT color=#ffffff>&nbsp; ]</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>netstat -an|more</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Active Internet connections (servers and established)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Proto Recv-Q Send-Q Local Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Foreign Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 0.0.0.0:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT> <BR><I><FONT face=SimSun color=#ffffcc size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 127.0.0.1:25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</FONT></I> <BR><FONT face=SimSun color=#ffffff size=-1>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 192.168.1.2:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.1.11:3175&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ESTABLISHED</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Active UNIX domain sockets (servers and established)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Proto RefCnt Flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I-Node Path</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 944&nbsp;&nbsp;&nbsp; /dev/log</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3161529</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3160038</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 739227</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 739189</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1070</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 953</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STREAM&nbsp;&nbsp;&nbsp;&nbsp; CONNECTED&nbsp;&nbsp;&nbsp;&nbsp; 690</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1># 看！那个 127.0.0.1:25 出现了！！</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>　</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>/etc/rc.d/init.d/sendmail stop</FONT></FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>Shutting down sendmail:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [&nbsp; </FONT><FONT color=#ffff99>OK</FONT><FONT color=#ffffff>&nbsp; ]</FONT></FONT></TD></TR></TBODY></TABLE>　 <BR>那如果要关闭的话，就停止 sendmail 呀！直接以上面的方式关闭呀！这样就好！这样您再以 netstat -an 看一下，呵呵！ port 25 就被关掉喔！很简单吧！当然，您也可以藉由 netstat -anp 找到 PID 之后，以 kill 指令来关闭也是可以的！ <BR>　 <BR>OK！那么启动服务的 scripts 路径在哪里？如果您还记得『 <A href="http://linux.vbird.org/linux_basic/0560daemons.php">鸟哥的 Linux 私房菜 -- 基础学习篇内的认识服务</A> 』那一篇文章的时候，那么应该就会记得我们目前的几个 port 启动的路径预设都放置在： <BR>　 
<UL>
<LI><FONT face=SimSun color=#000066>/etc/rc.d/init.d</FONT> 
<LI><FONT face=SimSun color=#000066>/etc/xinetd.d</FONT> </LI></UL>　 <BR>这两个路径底下，那个 /etc/rc.d/init.d 是以 RPM 来安装套件的时候，一定会存在的目录，这个目录记录了所有的服务的启动之 scripts ，这也就是刚刚为何我会以 <FONT face=SimSun>/etc/rc.d/init.d/sendmail start</FONT> 来启动我的 sendmail 服务的原因！至于那个 /etc/xinetd.d 目录下的档案，就是挂在 xinetd 这个 <FONT color=#000066>super daemon</FONT> 服务底下的服务套件啦！最常见的有 FTP, Telnet, POP3, IMAP 等等，都是由 xinetd 统一统筹来进行整理！所以，当您要启动 telnet 时，就直接到 /etc/xinetd.d 里面去，然后将 telnet 这个档案的 disable = yes 改成 disable = no ，然后『<FONT color=#000066>重新启动 xinetd 这个服务！</FONT>』没错！我没有写错！就是 xinetd ！因为我刚刚提过啦，由于 telnet 是由 xinetd 统一统筹的，所以要启动 telnet 自然就是将 xinetd 重新启动即可！ <BR>　 
<UL>
<LI><FONT face=SimSun color=#000066>/etc/rc.d/init.d/xinetd restart</FONT> </LI></UL>　 <BR>如何！不难吧！简单的很！好了，那么除了直接以文件名称来启动关闭之外，有没有其它较为简易的方式来启动的啦！？当然有！就是使用 <A href="http://linux.vbird.org/linux_basic/0550setup.php#service">service </A>这个指令说！例如要重新启动 xinetd ，可以这么写：(<I><FONT color=#000066>注： service 这个指令并非所有的 Linux distribution 都存在，仅有 Red Hat 及 Mandrake 上面才会发现这个指令喔！</FONT></I>) <BR>　 
<UL>
<LI><FONT face=SimSun color=#000066>service xinetd restart</FONT> </LI></UL></UL>
<HR width="100%">
<A name=open_at_open></A><FONT color=#000099 size=+1>设定开机时启动服务的方法：</FONT> 
<UL>上一小节提到的都是立刻生效的服务启动或关闭的方法，那么有没有方法可以在开机启动的时候就设定不要启动呢？您还记得在 <A href="http://linux.vbird.org/linux_basic/0510osloader.php">基础学习篇--Linux 开机关机程序</A> 那一篇文章吗？开机的程序在经历了： <BR>　 
<OL>
<LI><FONT face=SimSun color=#000066>BIOS</FONT> 
<LI><FONT face=SimSun color=#000066>MBR</FONT> 
<LI><FONT face=SimSun color=#000066>Linux Loader</FONT> 
<LI><FONT face=SimSun color=#000066>Kernel, init ( 取得 run-level ),</FONT> 
<LI><FONT face=SimSun color=#000066>/etc/rc.d/,</FONT> 
<LI><FONT face=SimSun color=#000066>/etc/modules.conf,</FONT> 
<LI><FONT face=SimSun color=#000066>/etc/rc.d/rc[0-6].d,</FONT> 
<LI><FONT face=SimSun color=#000066>/etc/rc.d/rc.local</FONT> </LI></OL>　 <BR>等等程序后，就是开机完毕啦！那个系统就成功的启动啦！而其中启动服务的项目在哪里呢？呵呵！就是在第七步骤，以我为例，通常我都是以文字界面 登入我的系统，文字界面的 run-level 为 3 ，所以这个时候我就可以在 /etc/rc.d/rc3.d 里头找到我的服务的启动项目啦！就是 S 开头的档案！这些相关的概念如果忘记的话，请在前往 <A href="http://linux.vbird.org/linux_basic/0510osloader.php">基础学习篇--开机关机程序</A> 那一章节去读一读去！那么如果不要启动一些服务的话，很简单呀！就是将该服务的对应档案( 指 S 开头的档案 )删除就可以啦！ ^_^"" <BR>　 <BR>但是我要自己一个档案一个档案去删除他吗？！呵呵！当然不需要啦！ Red Hat 与　Mandrake 等较流行的 Linux distribution 很细心的写了几支程序来帮您搞定他！那就是： <BR>　 
<UL>
<LI><A href="http://linux.vbird.org/linux_basic/0550setup.php#ntsysv">ntsysv：Red Hat</A> 
<LI><A href="http://linux.vbird.org/linux_basic/0550setup.php#setup">setup: Red Hat</A> 
<LI><A href="http://linux.vbird.org/linux_basic/0550setup.php#chkconfig">chkconfig：Red Hat, Mandrake</A> </LI></UL>　 <BR>这三支程序的使用方式我已经在基础学习篇介绍过了，这里就不再唆！请前往基础学习篇--<A href="http://linux.vbird.org/linux_basic/0550setup.php">好用的系统工具</A> 里头看看吧！ <BR>　 <BR>那么是否要将所有 Linux 预设的服务都关闭呢？呵呵！请注意呦！『<FONT color=#000066>不是将所有的服务都关掉就是安全的</FONT>！』因为系统还有很多的项目是『<FONT color=#000066>一定要启动的</FONT>！』否则将会反而变的不安全呢！底下列出来一些完全没有对外开放 port 的，但却是系统必需要的服务项目，这些项目请『务必』不要关闭了！ <BR>　 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffff size=-1>服务名称　　　　　　服务内容说明</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>===============================================================================</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>atd　　　　　　　　在 <A href="http://linux.vbird.org/linux_basic/0430cron.php">例行性命令</A> 里头提到的，单一次预约命令执行的服务，务必启动！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>cron　　　　　　　　在 <A href="http://linux.vbird.org/linux_basic/0430cron.php">例行性命令</A> 里头提到的，循环执行的命令，务必启动！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>iptables　　　　　　这个是防火墙软件，无论如何，先启动他吧！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>keytables　　　　　设定键盘的上面的字母的格式！当然需要读入了！不然如何控制！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>network　　　　　　您总该不会不想要有网络吧？！所以这个也请启动！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>random　　　　　　　快速的将系统的状态在随机的时间内存到映象文件当中，对于系统</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>　　　　　　　　　　相当重要！因为在开机之后，系统会迅速的回复到关机之前的状态！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>syslog　　　　　　　在 <A href="http://linux.vbird.org/linux_basic/0570syslog.php">系统登录文件</A> 里面提过很多次了！相当重要的服务！务必启动！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>xinetd　　　　　　　对啦！另一个服务管理员 super daemon！也是必须要启动的项目之一！</FONT> <BR><FONT face=SimSun color=#ffff00 size=-1>xfs　　　　　　　　如果您是使用 run-level 为 5 的图形接口，那么这个也必须要启动啦</FONT></TD></TR></TBODY></TABLE>　 <BR>没错！不要怀疑！只要这些就可以啦！这几个服务是必须要启动的！至于其它服务则都先不用启动！例如 sendmail 啦！其它林林总总的数据，都先摆着！我们会在后续的章节当中提到如何启动这些服务的啦！</UL>
<HR width="100%">
<A name=last_safe></A><FONT color=#000099><FONT size=+1>安全性： </FONT>关闭所有对外开放的 port</FONT> 
<UL><FONT color=#000000>在您安装了 Linux 之后呢，相信有很多的朋友会开始想要作一些很炫的服务，例如 WWW 或者是 mail 亦或是 FTP 的服务，但是，这些服务都有潜在性的危险喔，很多的黑客就是利用您开启的这些服务来进行网站的破坏！基本上，比较麻烦的是『特洛伊木马』这一类的后门程序，以您的网站做为中继站去攻击黑客想要攻击的目标。所以，灌完了 Linux 之后，先将一些不必要的程序或服务移除吧！以保障您的网络安全！其中，更重要的则是将所有的对外的 port 都先关起来！有需要的才开启！好了，利用我们刚刚提到的几个方法将您的对外的 port 都关起来吧！</FONT> <BR>　 
<TABLE cols=1 width=600 bgColor=#000000 border=1>
<TBODY>
<TR>
<TD><FONT face=SimSun color=#ffffcc size=-1>1. 使用 ntsysv 设定开机时启动的服务项目：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>ntsysv</FONT></FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>只要选择底下几个服务即可(注意！我是以 Red Hat 的文字接口为基础的)</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>atd, cron, iptables, keytables, network, random, syslog, xinetd</FONT> <BR><FONT face=SimSun color=#ff6666 size=-1>如果是 Mandrake 的话，就得要使用 chkconfig 了！</FONT> 
<P><FONT face=SimSun color=#ffffcc size=-1>2. 重新开机让设定生效：</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>reboot</FONT></FONT> </P>
<P><FONT face=SimSun color=#ffffcc size=-1>3. 观察目前的 port 开启多少个？</FONT> <BR><FONT face=SimSun size=-1><FONT color=#ffffff>[root@test root]# </FONT><FONT color=#ffff00>netstat -an | more</FONT></FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Active Internet connections (servers and established)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Proto Recv-Q Send-Q Local Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Foreign Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Active UNIX domain sockets (servers and established)</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>Proto RefCnt Flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I-Node Path</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 944&nbsp;&nbsp;&nbsp; /dev/log</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3162963</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 739227</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 739189</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1070</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 953</FONT> <BR><FONT face=SimSun color=#ffffff size=-1>unix&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [ ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STREAM&nbsp;&nbsp;&nbsp;&nbsp; CONNECTED&nbsp;&nbsp;&nbsp;&nbsp; 690</FONT></P></TD></TR></TBODY></TABLE>　 <BR><FONT color=#000000>这样一来，所有的对外窗口将暂时的全部关闭了！好了，准备要来玩架站！一个一个的启动我们的 port 吧！ ^_^</FONT></UL>
<HR width="100%">
<A name=ex></A><FONT color=#000099 size=+1>课后练习：</FONT> 
<UL>
<LI>如何观察您 Linux 主机上面已经有多少 port 被打开了？ 
<LI>如何观察程序？ 
<LI>请问 LISTEN 的 port 与 daemon 的关系为何？ 
<LI>请解释三向交握的原理与封包传输的方向。 
<LI>请问 stand alone 与 super daemon 各是什么？ 
<LI>请问您的 Linux 主机 (不论是那个 distributions ) 有关 daemon 启动与关闭的 scripts 与档案放置在那个目录下？ 
<LI>请将您的 linux 主机对外的联机端口口全部关闭！ <BR><A href="http://linux.vbird.org/linux_server/1000results.php#0210port_limit">前往参考用解答</A></LI></UL>
<CENTER><FONT color=#3333ff size=+1><A href="http://linux.vbird.org/linux_server/0210port_limit.php" target=_self><FONT face=SimSun>限制</FONT><FONT face="Times New Roman,Times"> Linux </FONT><FONT face=SimSun>对外联机的埠口</FONT></A></FONT></CENTER>
<HR width="100%">
<FONT face=SimSun color=#000066 size=-1>2002/08/02：首次完成释出</FONT> <BR><FONT face=SimSun color=#000066 size=-1>2003/08/21：重新编辑，并且加入课后练习。</FONT> <BR><FONT face=SimSun color=#000066 size=-1>2003/09/19：加入参考用解答了。</FONT> <BR>
<HR width="100%">
<FONT face=SimSun color=#3333ff size=-1>2002/08/02 以来统计人数</FONT> <BR><IMG height=15 src="51_files/Count[7].gif" width=60 align=middle nosave="">
<HR width="100%">
 
<CENTER><A href="http://linux.vbird.org/" target=_top><IMG height=25 src="61_files/VBirdTitle2[10].jpg" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_basic"><IMG height=25 src="39_files/icon_system[3].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_server"><IMG height=25 src="55_files/icon_server[13].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/linux_security"><IMG height=25 src="71_files/icon_security[10].jpg" width=90 border=0 nosave=""></A> <A href="http://phorum.vbird.org/" target=_blank><IMG height=25 src="60_files/icon_forums[10].gif" width=90 border=0 nosave=""></A> <A href="http://linux.vbird.org/adsl"><IMG height=25 src="50_files/icon_adsl[13].gif" width=90 border=0 nosave=""></A> <BR><FONT color=#000066 size=-1>Designed by <A href="mailto:vbird@tsai.adsldns.org">VBird</A> during 2001-2004.&nbsp; Aerosol Lab.</FONT></CENTER></DT></BODY>